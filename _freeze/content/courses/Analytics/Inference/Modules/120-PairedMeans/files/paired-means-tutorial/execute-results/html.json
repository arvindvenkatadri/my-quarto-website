{
  "hash": "ee13c72fceb6744b73865bd0af5b539b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Tutorial on Inference for Two Paired Means\"\nauthor: \"Arvind Venkatadri\"\ndate: 22/Nov/2022\ndate-modified: \"2025-07-17\"\n---\n\n## {{< iconify noto-v1 package >}} Setting up R Packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(mosaic)\n\nlibrary(resampledata)\n```\n:::\n\n\n## {{< iconify pajamas issue-type-test-case >}} Case Study-1: IceCream!!\n\nWhat is there to not like about icecreams!! Here is a dataset that has\ndata on Sugar and Calories between Vanilla and Chocolate icecreams,\nacross several brands of icecreams. Is this a sample of paired data? Let\nus check:\n\n### {{< iconify carbon chart-3d >}} Inspecting and Charting Data\n\n\n::: {.cell layout-nrow=\"2\"}\n\n```{.r .cell-code}\ndata(\"IceCream\")\nIceCream\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Brand\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"VanillaCalories\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"VanillaFat\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"VanillaSugar\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"ChocolateCalories\"],\"name\":[5],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"ChocolateFat\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"ChocolateSugar\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Baskin Robbins\",\"2\":\"260\",\"3\":\"16.0\",\"4\":\"26.0\",\"5\":\"260\",\"6\":\"14.0\",\"7\":\"31.0\"},{\"1\":\"Ben & Jerry's\",\"2\":\"240\",\"3\":\"16.0\",\"4\":\"19.0\",\"5\":\"260\",\"6\":\"16.0\",\"7\":\"22.0\"},{\"1\":\"Blue Bunny\",\"2\":\"140\",\"3\":\"7.0\",\"4\":\"12.0\",\"5\":\"130\",\"6\":\"7.0\",\"7\":\"14.0\"},{\"1\":\"Breyers\",\"2\":\"140\",\"3\":\"7.0\",\"4\":\"13.0\",\"5\":\"140\",\"6\":\"8.0\",\"7\":\"16.0\"},{\"1\":\"Brigham's\",\"2\":\"190\",\"3\":\"12.0\",\"4\":\"17.0\",\"5\":\"200\",\"6\":\"12.0\",\"7\":\"18.0\"},{\"1\":\"Bulla\",\"2\":\"234\",\"3\":\"13.5\",\"4\":\"21.8\",\"5\":\"266\",\"6\":\"15.0\",\"7\":\"22.6\"},{\"1\":\"Carvel\",\"2\":\"240\",\"3\":\"14.0\",\"4\":\"21.0\",\"5\":\"250\",\"6\":\"13.0\",\"7\":\"25.0\"},{\"1\":\"Cass-Clay\",\"2\":\"130\",\"3\":\"7.0\",\"4\":\"11.0\",\"5\":\"150\",\"6\":\"7.0\",\"7\":\"16.0\"},{\"1\":\"Chapman's\",\"2\":\"120\",\"3\":\"6.0\",\"4\":\"11.0\",\"5\":\"120\",\"6\":\"5.0\",\"7\":\"12.0\"},{\"1\":\"Cold Stone\",\"2\":\"270\",\"3\":\"15.5\",\"4\":\"23.0\",\"5\":\"264\",\"6\":\"16.2\",\"7\":\"23.6\"},{\"1\":\"Culver's\",\"2\":\"222\",\"3\":\"13.0\",\"4\":\"19.0\",\"5\":\"205\",\"6\":\"10.0\",\"7\":\"20.0\"},{\"1\":\"Dairy Queen\",\"2\":\"140\",\"3\":\"4.5\",\"4\":\"19.0\",\"5\":\"150\",\"6\":\"5.0\",\"7\":\"17.0\"},{\"1\":\"Dove\",\"2\":\"240\",\"3\":\"15.0\",\"4\":\"20.0\",\"5\":\"290\",\"6\":\"17.0\",\"7\":\"27.0\"},{\"1\":\"Dreamery\",\"2\":\"260\",\"3\":\"15.0\",\"4\":\"24.0\",\"5\":\"280\",\"6\":\"12.0\",\"7\":\"33.0\"},{\"1\":\"Edy's Grand\",\"2\":\"140\",\"3\":\"8.0\",\"4\":\"13.0\",\"5\":\"150\",\"6\":\"8.0\",\"7\":\"15.0\"},{\"1\":\"Emack & Bolio's\",\"2\":\"160\",\"3\":\"9.0\",\"4\":\"12.0\",\"5\":\"170\",\"6\":\"9.0\",\"7\":\"13.0\"},{\"1\":\"Good Humor\",\"2\":\"120\",\"3\":\"6.0\",\"4\":\"12.0\",\"5\":\"120\",\"6\":\"6.0\",\"7\":\"14.0\"},{\"1\":\"Graeter's\",\"2\":\"260\",\"3\":\"16.0\",\"4\":\"24.0\",\"5\":\"260\",\"6\":\"16.0\",\"7\":\"24.0\"},{\"1\":\"Green and Black\",\"2\":\"194\",\"3\":\"11.6\",\"4\":\"18.0\",\"5\":\"227\",\"6\":\"12.8\",\"7\":\"22.7\"},{\"1\":\"Green's\",\"2\":\"150\",\"3\":\"8.0\",\"4\":\"17.0\",\"5\":\"140\",\"6\":\"8.0\",\"7\":\"15.0\"},{\"1\":\"Haagen Dazs\",\"2\":\"270\",\"3\":\"18.0\",\"4\":\"21.0\",\"5\":\"270\",\"6\":\"18.0\",\"7\":\"21.0\"},{\"1\":\"Hershey's\",\"2\":\"140\",\"3\":\"9.0\",\"4\":\"14.0\",\"5\":\"140\",\"6\":\"8.0\",\"7\":\"13.0\"},{\"1\":\"Hill Station\",\"2\":\"226\",\"3\":\"15.6\",\"4\":\"16.8\",\"5\":\"235\",\"6\":\"14.3\",\"7\":\"21.2\"},{\"1\":\"Kemp's\",\"2\":\"130\",\"3\":\"7.0\",\"4\":\"13.0\",\"5\":\"140\",\"6\":\"6.0\",\"7\":\"17.0\"},{\"1\":\"Klein's\",\"2\":\"130\",\"3\":\"8.0\",\"4\":\"15.0\",\"5\":\"140\",\"6\":\"8.0\",\"7\":\"14.0\"},{\"1\":\"Oberweis Dairy\",\"2\":\"307\",\"3\":\"21.0\",\"4\":\"23.0\",\"5\":\"320\",\"6\":\"21.0\",\"7\":\"19.0\"},{\"1\":\"Our Family\",\"2\":\"130\",\"3\":\"7.0\",\"4\":\"11.0\",\"5\":\"130\",\"6\":\"6.0\",\"7\":\"15.0\"},{\"1\":\"Perry's\",\"2\":\"140\",\"3\":\"8.0\",\"4\":\"15.0\",\"5\":\"140\",\"6\":\"7.0\",\"7\":\"15.0\"},{\"1\":\"Ronnybrook Farm\",\"2\":\"240\",\"3\":\"16.0\",\"4\":\"20.0\",\"5\":\"260\",\"6\":\"19.0\",\"7\":\"21.0\"},{\"1\":\"Ruggles\",\"2\":\"150\",\"3\":\"8.0\",\"4\":\"12.0\",\"5\":\"150\",\"6\":\"8.0\",\"7\":\"16.0\"},{\"1\":\"Sara Lee\",\"2\":\"242\",\"3\":\"15.5\",\"4\":\"21.5\",\"5\":\"234\",\"6\":\"14.4\",\"7\":\"20.9\"},{\"1\":\"Schwan's\",\"2\":\"140\",\"3\":\"7.0\",\"4\":\"12.0\",\"5\":\"140\",\"6\":\"7.0\",\"7\":\"12.0\"},{\"1\":\"Sheer Bliss\",\"2\":\"300\",\"3\":\"19.0\",\"4\":\"27.0\",\"5\":\"320\",\"6\":\"19.0\",\"7\":\"29.0\"},{\"1\":\"Smith's\",\"2\":\"150\",\"3\":\"8.0\",\"4\":\"13.0\",\"5\":\"150\",\"6\":\"8.0\",\"7\":\"13.0\"},{\"1\":\"Stonyfield Farm\",\"2\":\"240\",\"3\":\"16.0\",\"4\":\"20.0\",\"5\":\"250\",\"6\":\"17.0\",\"7\":\"20.0\"},{\"1\":\"Tillamook\",\"2\":\"160\",\"3\":\"9.0\",\"4\":\"10.0\",\"5\":\"170\",\"6\":\"9.0\",\"7\":\"13.0\"},{\"1\":\"Turkey Hill\",\"2\":\"140\",\"3\":\"8.0\",\"4\":\"16.0\",\"5\":\"150\",\"6\":\"8.0\",\"7\":\"19.0\"},{\"1\":\"Value Choice\",\"2\":\"130\",\"3\":\"6.0\",\"4\":\"12.0\",\"5\":\"130\",\"6\":\"6.0\",\"7\":\"15.0\"},{\"1\":\"Whitey's\",\"2\":\"250\",\"3\":\"14.0\",\"4\":\"23.0\",\"5\":\"250\",\"6\":\"13.0\",\"7\":\"25.0\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\ninspect(IceCream)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\ncategorical variables:  \n   name  class levels  n missing                                  distribution\n1 Brand factor     39 39       0 Baskin Robbins (2.6%) ...                    \n\nquantitative variables:  \n               name   class   min    Q1 median    Q3 max      mean        sd  n\n1   VanillaCalories integer 120.0 140.0    160 240.0 307 191.41026 58.644207 39\n2        VanillaFat numeric   4.5   7.5      9  15.5  21  11.28718  4.431655 39\n3      VanillaSugar numeric  10.0  12.5     17  21.0  27  17.13077  4.841333 39\n4 ChocolateCalories integer 120.0 140.0    170 260.0 320 198.74359 63.063342 39\n5      ChocolateFat numeric   5.0   7.5      9  14.7  21  11.12051  4.597378 39\n6    ChocolateSugar numeric  12.0  15.0     18  22.3  33  18.97436  5.402812 39\n  missing\n1       0\n2       0\n3       0\n4       0\n5       0\n6       0\n```\n\n\n:::\n:::\n\n\nHmm...the data are about *calories*, *fat*, and *sugar* between two\nflavours of icecream sold by **each** brand. There are 39 brands.\n\nLet us plot the data first:\n\n\n::: {.cell layout-ncol=\"3\"}\n\n```{.r .cell-code}\nIceCream %>%\n  gf_col(fct_reorder(Brand, VanillaCalories) ~ VanillaCalories,\n    fill = \"red\"\n  ) %>%\n  gf_col(fct_reorder(Brand, VanillaCalories) ~ -ChocolateCalories,\n    fill = \"green\",\n    xlab = \"Calories\", ylab = \"Brand\",\n    title = \"Calories across Icecream Brands\",\n    subtitle = \"Vanilla = Red, Green = Chocolate\"\n  ) %>%\n  gf_theme(theme_classic())\n```\n\n::: {.cell-output-display}\n![](paired-means-tutorial_files/figure-html/unnamed-chunk-2-1.png){width=2100}\n:::\n\n```{.r .cell-code}\nIceCream %>%\n  gf_col(fct_reorder(Brand, VanillaFat) ~ VanillaFat,\n    fill = \"red\"\n  ) %>%\n  gf_col(fct_reorder(Brand, VanillaFat) ~ -ChocolateFat,\n    fill = \"green\",\n    xlab = \"Fat\", ylab = \"Brand\",\n    title = \"Calories across Icecream Brands\",\n    subtitle = \"Vanilla = Red, Green = Chocolate\"\n  ) %>%\n  gf_theme(theme_classic())\n```\n\n::: {.cell-output-display}\n![](paired-means-tutorial_files/figure-html/unnamed-chunk-2-2.png){width=2100}\n:::\n\n```{.r .cell-code}\nIceCream %>%\n  gf_col(fct_reorder(Brand, VanillaSugar) ~ VanillaSugar,\n    fill = \"red\"\n  ) %>%\n  gf_col(fct_reorder(Brand, VanillaSugar) ~ -ChocolateSugar,\n    fill = \"green\",\n    xlab = \"Sugar\", ylab = \"Brand\",\n    title = \"Calories across Icecream Brands\",\n    subtitle = \"Vanilla = Red, Green = Chocolate\"\n  ) %>%\n  gf_theme(theme_classic())\n```\n\n::: {.cell-output-display}\n![](paired-means-tutorial_files/figure-html/unnamed-chunk-2-3.png){width=2100}\n:::\n:::\n\n\nWe may hypothesize that say, the fat content in the two flavours might\nbe similar on a **per brand** basis. That is, if say Baskin Robbins has\nhigh `sugar` in the vanilla flavour, it is likely to have high sugar\nalso in its chocolate flavour.\n\nLet us see what are the observed differences in the mean values of\n*calories*, *sugar*, and *fat* across brands:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nIceCream %>%\n  mutate(\n    diff_calories = VanillaCalories - ChocolateCalories,\n    diff_fat = VanillaFat - ChocolateFat,\n    diff_sugar = VanillaSugar - ChocolateSugar\n  ) %>%\n  summarise(\n    mean_diff_calories = mean(diff_calories),\n    mean_diff_fat = mean(diff_fat),\n    mean_diff_sugar = mean(diff_sugar)\n  )\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"mean_diff_calories\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"mean_diff_fat\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"mean_diff_sugar\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"-7.333333\",\"2\":\"0.1666667\",\"3\":\"-1.84359\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nHmm...while the numbers showing difference in means are quite different,\nwe need to perform tests to infer whether these difference are\nstatistically significant.\n\n### {{< iconify academicons hypothesis >}} Hypothesis\n\nHow do we specify our Hypotheses? (Of course, there is more than one!)\n\nWrite the Null and Alternate hypotheses here.\n\n### {{< iconify mdi null >}} {{< iconify tabler chart-histogram >}} Null Distribution Computations\n\nHow do we compute the NULL distributions, for each of the three\ncomponents of the ice creams, using pair-wise analysis?\n\n\n::: {.cell}\n\n:::\n\n\n## {{< iconify fluent-mdl2 decision-solid >}} Conclusions\n\nSo are there significant differences in sugar, fat, and calorie content\nacross the two flavours?\n\nIs this conclusion different if you **don't** use paired-data, and just\ntreat the data as independent readings?\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../../../../../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../../../../../../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}