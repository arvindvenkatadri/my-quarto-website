{
  "hash": "98551c0824704625567d1d7c8f7f6d48",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"\\U0001F0CF Inference for a Single Mean\"\nsubtitle: \"“The more I love humanity in general, the less I love man in particular. ― Fyodor Dostoyevsky, The Brothers Karamazov\"\nauthor: Arvind V. \ndate: 10/Nov/2022\ndate-modified: \"2025-07-29\"\nabstract: \"Inference Tests for a Single population Mean\"\norder: 100\ncategories:\n- t.test\n- Inference\n- Bootstrap\n- Null Distributions\n- Generating Parallel Worlds\nbibliography: \n  - grateful-refs.bib\ncitation: true\nfilters: \n  - gadenbuie/tachyons\n#suppress-bibliography: true\n---\n\n\n::: {.cell}\n\n:::\n\n\n:::: {.pa4}\n::: {.athelas .ml0 .mt0 .pl4 .black-90 .bl .bw2 .b--blue}\n[…neither let us despair over how small our successes are. For however much our successes fall short of our desire, our efforts aren't in vain when we are farther along today than yesterday.]{.f5 .f4-m .f3-l .lh-copy .measure .mt0}\n\n[ --- John Calvin]{.f6 .ttu .tracked .fs-normal}\n:::\n::::\n\n## {{< iconify noto-v1 package >}} Setting up R packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(mosaic)\nlibrary(ggformula)\nlibrary(infer)\nlibrary(broom) # Clean test results in tibble form\nlibrary(resampledata) # Datasets from Chihara and Hesterberg's book\nlibrary(openintro) # More datasets\nlibrary(tidyverse)\n```\n:::\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n#### Plot Fonts and Theme\n\n\n::: {.cell messages='false'}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(systemfonts)\nlibrary(showtext)\n## Clean the slate\nsystemfonts::clear_local_fonts()\nsystemfonts::clear_registry()\n##\nshowtext_opts(dpi = 96) # set DPI for showtext\nsysfonts::font_add(\n  family = \"Alegreya\",\n  regular = \"../../../../../../fonts/Alegreya-Regular.ttf\",\n  bold = \"../../../../../../fonts/Alegreya-Bold.ttf\",\n  italic = \"../../../../../../fonts/Alegreya-Italic.ttf\",\n  bolditalic = \"../../../../../../fonts/Alegreya-BoldItalic.ttf\"\n)\n\nsysfonts::font_add(\n  family = \"Roboto Condensed\",\n  regular = \"../../../../../../fonts/RobotoCondensed-Regular.ttf\",\n  bold = \"../../../../../../fonts/RobotoCondensed-Bold.ttf\",\n  italic = \"../../../../../../fonts/RobotoCondensed-Italic.ttf\",\n  bolditalic = \"../../../../../../fonts/RobotoCondensed-BoldItalic.ttf\"\n)\nshowtext_auto(enable = TRUE) # enable showtext\n##\ntheme_custom <- function() {\n  font <- \"Alegreya\" # assign font family up front\n\n  theme_classic(base_size = 14, base_family = font) %+replace% # replace elements we want to change\n\n    theme(\n      text = element_text(family = font), # set base font family\n\n      # text elements\n      plot.title = element_text( # title\n        family = font, # set font family\n        size = 24, # set font size\n        face = \"bold\", # bold typeface\n        hjust = 0, # left align\n        margin = margin(t = 5, r = 0, b = 5, l = 0)\n      ), # margin\n      plot.title.position = \"plot\",\n      plot.subtitle = element_text( # subtitle\n        family = font, # font family\n        size = 14, # font size\n        hjust = 0, # left align\n        margin = margin(t = 5, r = 0, b = 10, l = 0)\n      ), # margin\n\n      plot.caption = element_text( # caption\n        family = font, # font family\n        size = 9, # font size\n        hjust = 1\n      ), # right align\n\n      plot.caption.position = \"plot\", # right align\n\n      axis.title = element_text( # axis titles\n        family = \"Roboto Condensed\", # font family\n        size = 12\n      ), # font size\n\n      axis.text = element_text( # axis text\n        family = \"Roboto Condensed\", # font family\n        size = 9\n      ), # font size\n\n      axis.text.x = element_text( # margin for axis text\n        margin = margin(5, b = 10)\n      )\n\n      # since the legend often requires manual tweaking\n      # based on plot content, don't define it here\n    )\n}\n```\n:::\n\n\n\n::: {.cell}\n\n````{.cell-code  code-fold=\"true\"}\n```{{r}}\n#| cache: false\n#| code-fold: true\n## Set the theme\ntheme_set(new = theme_custom())\n\n## Use available fonts in ggplot text geoms too!\nupdate_geom_defaults(geom = \"text\", new = list(\n  family = \"Roboto Condensed\",\n  face = \"plain\",\n  size = 3.5,\n  color = \"#2b2b2b\"\n))\n```\n````\n:::\n\n\n\n\n\n## {{< iconify fxemoji japanesesymbolforbeginner >}} Introduction\nIn this module, we will answer a basic Question: What is the mean $\\mu$ of the population?\n\nRecall that the `mean` is the first of our [Summary Statistics](../../../Descriptive/Modules/10-FavStats/index.qmd). We wish to know more about the mean of the population from which we have drawn our data sample.\n\nWe will do this is in several ways, based on the assumptions we are willing to adopt about our data. \nFirst we will use a toy dataset with one \"imaginary\" sample, normally distributed and made up of 50 observations. Since we [\"know the answer\"]{.bg-yellow .black} we will be able to build up some belief in the tests and procedures, which we will dig into to form our intuitions.\n\nWe will then use a real-world dataset to make inferences on the means of Quant variables therein, and decide what that could tell us.\n\n## {{< iconify mdi:thought-bubble-outline >}} Statistical Inference is almost an Attitude!\n\nAs we will notice, the process of Statistical Inference is an attitude: [**ain't nothing happenin'!**]{.bg-yellow .athelas .black} We look at data that we might have received or collected ourselves, and look at it with this attitude, seemingly, of some disbelief. We *state* either that:\n\na) there is really nothing happening with our research question, and that anything we see in the data is the outcome of random chance. \nb) the value/statistic indicated by the data is off the mark and ought to be something else.\n\nWe then calculate how slim the chances are of [the given data sample showing up like that]{.bg-washed-green .black}, **given our belief**. It is a distance measurement of sorts. If those chances are too low, then that might alter our belief. This is the attitude that lies at the heart of *Hypothesis Testing*.\n\n::: callout-important\nThe *calculation of chances* is both a logical, and a possible procedure since we are dealing with **samples** from a *population*. If many other samples give us quite different estimates, then we would discredit the one we derive from it. \n:::\n\nEach test we perform will mechanize this attitude in different ways, based on assumptions and conveniences. (And history)\n\n## {{< iconify pajamas issue-type-test-case >}} Case Study #1: Toy data\n\nSince the CLT **assumes** the [sample is normally-distributed]{style=\"background-color: yellow;\"}, let us generate a sample that is just so:\n\n:::: {.columns}\n::: {.column width=\"60%\"}\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(40) # for replication\n#\n# Data as individual vectors\n# ( for t.tests etc)\n# Generate normally distributed data with mean = 2, sd = 2, length = 50\ny <- rnorm(n = 50, mean = 2, sd = 2)\n\n# And as tibble too\nmydata <- tibble(y = y)\nmydata\n```\n:::\n\n\n:::\n::: {.column width=\"40%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"y\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"2.95547807\"},{\"1\":\"2.99236565\"},{\"1\":\"0.28083140\"},{\"1\":\"0.34188009\"},{\"1\":\"1.35685383\"},{\"1\":\"-0.60754080\"},{\"1\":\"-0.84297320\"},{\"1\":\"5.48982989\"},{\"1\":\"1.42344128\"},{\"1\":\"-0.61773144\"},{\"1\":\"1.86109562\"},{\"1\":\"-0.44985335\"},{\"1\":\"3.61799252\"},{\"1\":\"1.01569932\"},{\"1\":\"2.90538787\"},{\"1\":\"3.99926619\"},{\"1\":\"2.93405920\"},{\"1\":\"2.75210399\"},{\"1\":\"5.40698191\"},{\"1\":\"-0.07092304\"},{\"1\":\"4.65624420\"},{\"1\":\"0.81142578\"},{\"1\":\"5.22256917\"},{\"1\":\"-0.22534766\"},{\"1\":\"-0.92036596\"},{\"1\":\"3.46431196\"},{\"1\":\"-1.22067886\"},{\"1\":\"2.66413472\"},{\"1\":\"3.52171231\"},{\"1\":\"-1.70733910\"},{\"1\":\"3.58230314\"},{\"1\":\"-0.56348079\"},{\"1\":\"0.44024532\"},{\"1\":\"4.87668456\"},{\"1\":\"1.53034091\"},{\"1\":\"3.22439428\"},{\"1\":\"-0.91694127\"},{\"1\":\"2.48553814\"},{\"1\":\"1.36521578\"},{\"1\":\"3.71874666\"},{\"1\":\"4.68831014\"},{\"1\":\"2.63111439\"},{\"1\":\"6.09088972\"},{\"1\":\"1.63505893\"},{\"1\":\"-0.96787647\"},{\"1\":\"2.79433127\"},{\"1\":\"5.13931511\"},{\"1\":\"4.54046592\"},{\"1\":\"0.25711331\"},{\"1\":\"2.72176652\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n:::\n::::\n\n\n\n## {{< iconify carbon chart-3d >}} Inspecting and Charting Data\n:::: {.columns}\n::: {.column width=\"60%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Set graph theme\ntheme_set(new = theme_custom())\n#\nmydata %>%\n  gf_density(~y) %>%\n  gf_fitdistr(dist = \"dnorm\") %>%\n  gf_labs(\n    title = \"Densities of Original Data Variables\",\n    subtitle = \"Compared with Normal Density\"\n  )\n```\n:::\n\n\n:::\n::: {.column width=\"40%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=2100}\n:::\n:::\n\n:::\n::::\n\n\n::: callout-note\n### Observations from Density Plots\n\n- The variable $y$ appear to be centred around\n- It does not seem to be normally distributed...\n- So assumptions are not always valid...\n:::\n\n### Research Question\nResearch Questions are always about the population! Here goes:\n\n::: callout-note\n### Research Question\nCould the mean of the population $\\mu$, from which y has been drawn, be zero?\n:::\n\n### Assumptions\n\n::: callout-note\n### Testing for Normality\nThe y-variable does not appear to be normally distributed. This would affect the test we can use to make inferences about the population mean.  \nThere are formal tests for normality too. We will do them in the next case study. For now, let us proceed naively. \n:::\n\n\n## Inference\n\n::: {.panel-tabset .nav-pills style=\"background: whitesmoke;\"}\n\n### The t-test \n\nA. Model\n\nWe have $mean(y) = \\bar{y}.$ \nWe formulate \"our disbelief\" of $\\bar{y}$ with a *NULL Hypothesis*, [**about the population**]{.bg-yellow .athelas .black} as follows:\n\n$$\n\\ H_0: \\mu = 0\n$$\nAnd the alternative hypothesis, again [**about the population**]{.bg-yellow .athelas .black} as\n\n$$\nH_a:\\mu \\ne 0\n$$\n\nB. Code\n\n::: {.cell}\n\n```{.r .cell-code}\n# t-test\nt1 <- mosaic::t_test(\n  y, # Name of variable\n  mu = 0, # belief of population mean\n  alternative = \"two.sided\"\n) %>% # Check both sides\n\n  broom::tidy() # Make results presentable, and plottable!!\nt1\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"estimate\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"statistic\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p.value\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"parameter\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"conf.low\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"conf.high\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"method\"],\"name\":[7],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"alternative\"],\"name\":[8],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"2.045689\",\"2\":\"6.785596\",\"3\":\"1.425495e-08\",\"4\":\"49\",\"5\":\"1.439852\",\"6\":\"2.651526\",\"7\":\"One Sample t-test\",\"8\":\"two.sided\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n::: callout-important\n### Recall Confidence Intervals\nRecall how we calculated means, standard deviations from data (samples). If we could measure the entire population, then there would be no uncertainty in our estimates for means and sd-s. Since we are forced to sample, we can only estimate population parameters based on the sample estimates and state how much off we might be.\n\nConfidence intervals for population means are given by:\n\n$$ \n\\begin{eqnarray*}\nCI & = & \\bar{y} ~ {\\pm ~ constant * Standard Error}\\\\\n& = & \\bar{y} ~ {\\pm ~ 1.96 * {sd/\\sqrt{n}}}\n\\end{eqnarray*}\n$$\n\n:::{.column width=\"60%\"}\n**Assuming** the y is normally-distributed, the $constant = 1.96$ for confidence level of 95%. What that means is that if we take multiple such samples like $y$ from the population, [**their means** (which are random)]{.bg-light-pink .black .athelas} will land within $CI$ of [the population mean (which is fixed!)]{.bg-light-green .black .athelas} 95% of the time. Uff...! May remind you of [Buffon's Needle](https://www.wikiwand.com/en/articles/Buffon's_needle_problem)...\n:::\n:::{.column width=\"40%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=2100}\n:::\n:::\n\n:::\n\n:::\n\nSo $\\bar{y}$ i.e. the `estimate` is $2.045689$. The confidence intervals do not straddle zero. The *chances* that this particular value of mean ($2.045689$) would randomly occur **under the assumption that $\\mu$ is zero**, are exceedingly slim, $p.value = 1.425495e-08$. Hence we can reject the NULL hypothesis that the true population, of which y is a sample, could have mean $\\mu = 0$. \n\n\n### Wilcoxon's Signed-Rank Test\n::: Callout-note\n\n#### \"Signed Rank\" Values: A Small Digression\nWhen the Quant variable we want to test for is *not normally* distributed, we need to think of other ways to perform our inference. Our assumption about *normality* has been invalidated.  \nMost statistical tests use the **actual values** of the data variables. However, in these cases where assumptions are invalidated, the data are used in **rank-transformed** sense/order. In some cases the **signed-rank** of the data values is used instead of the data itself. The signed ranks are then tested to see if there are more of one polarity than the other, roughly speaking, and how probable this could be. \n\nSigned Rank is calculated as follows:\n\n1. Take the absolute value of each observation in a sample\\\n2. Place the <u>*ranks*</u> in order of (absolute magnitude). The\nsmallest number has *rank = 1* and so on.\\\n3. Give each of the ranks the sign of the original observation ( + or -)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsigned_rank <- function(x) {\n  sign(x) * rank(abs(x))\n}\n```\n:::\n\n:::\n\nSince we are dealing with the **mean**, the *sign* of the rank becomes important to use.\n\nA. Model\n\n$$\nmean(signed\\_rank(y)) = \\beta_0\n$$\n\n$$\nH_0: \\mu_0 = 0\n$$\n$$\nH_a: \\mu_0 \\ne 0\n$$\n\nB. Code\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Standard Wilcoxon Signed_Rank Test\nt2 <- wilcox.test(y, # variable name\n  mu = 0, # belief\n  alternative = \"two.sided\",\n  conf.int = TRUE,\n  conf.level = 0.95\n) %>%\n  broom::tidy()\nt2\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"estimate\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"statistic\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p.value\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"conf.low\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"conf.high\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"method\"],\"name\":[6],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"alternative\"],\"name\":[7],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"2.04533\",\"2\":\"1144\",\"3\":\"1.036606e-06\",\"4\":\"1.383205\",\"5\":\"2.721736\",\"6\":\"Wilcoxon signed rank test with continuity correction\",\"7\":\"two.sided\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n# Can also do this equivalently\n# t-test with signed_rank data\nt3 <- t.test(signed_rank(y),\n  mu = 0,\n  alternative = \"two.sided\",\n  conf.int = TRUE,\n  conf.level = 0.95\n) %>%\n  broom::tidy()\nt3\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"estimate\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"statistic\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p.value\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"parameter\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"conf.low\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"conf.high\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"method\"],\"name\":[7],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"alternative\"],\"name\":[8],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"20.26\",\"2\":\"6.700123\",\"3\":\"1.933926e-08\",\"4\":\"49\",\"5\":\"14.1834\",\"6\":\"26.3366\",\"7\":\"One Sample t-test\",\"8\":\"two.sided\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nAgain, the `confidence intervals` do not straddle $0$, and we need to reject the belief that the mean is close to zero. \n\n::: callout-note\nNote how the Wilcoxon Test reports results about $y$, even though it computes with $signed-rank(y)$.\nThe \"equivalent t-test\" with signed-rank data cannot do this, since it uses \"rank\" data, and reports the same result.\n:::\n\n### Using Permutation and Bootstrap\n\nWe saw from the diagram created by Allen Downey that *there is only one test* [^1]! We will now use this philosophy to develop a technique that allows us to mechanize several *Statistical Models* in that way, with nearly identical code.\n\nWe can use two packages in R, `mosaic` to develop our intuition for what are called **permutation** based statistical tests; and a more recent package called `infer` in R which can do pretty much all of this, including visualization. \n\nWe will stick with `mosaic` for now. We will do a permutation test first, and then a bootstrap test. In subsequent modules, we will use `infer` also.\n\nFor the Permutation test, we mechanize our belief that $\\mu = 0$ by *shuffling the polarities of the y observations* randomly 4999 times to generate other samples from the population $y$ could have come from[^2]. If these samples can frequently achieve $\\bar{y_i} \\leq 0$, then we might believe that the population mean may be 0! \n\nWe see that the means here that **chances** that the randomly generated means can exceed our real-world mean are about $0$! So the mean is definitely different from $0$. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Set graph theme\ntheme_set(new = theme_custom())\n#\n# Calculate exact mean\nobs_mean <- mean(~y, data = mydata)\nbelief1 <- 0 # What we think the mean is\nobs_diff_mosaic <- obs_mean - belief1\nobs_diff_mosaic\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 2.045689\n```\n\n\n:::\n\n```{.r .cell-code}\n## Steps in Permutation Test\n## Repeatedly Shuffle polarities of data observations\n## Take means\n## Compare all means with the real-world observed one\nnull_dist_mosaic <-\n  mosaic::do(9999) * mean(\n    ~ abs(y) *\n      sample(c(-1, 1), # +/- 1s multiply y\n        length(y), # How many +/- 1s?\n        replace = T\n      ), # select with replacement\n    data = mydata\n  )\n##\nrange(null_dist_mosaic$mean)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] -1.754293  1.473298\n```\n\n\n:::\n\n```{.r .cell-code}\n##\n## Plot this NULL distribution\ngf_histogram(\n  ~mean,\n  data = null_dist_mosaic,\n  fill = ~ (mean >= obs_diff_mosaic),\n  bins = 50, title = \"Distribution of Permutation Means under Null Hypothesis\",\n  subtitle = \"Why is the mean of the means zero??\"\n) %>%\n  gf_labs(\n    x = \"Calculated Random Means\",\n    y = \"How Often do these occur?\"\n  ) %>%\n  gf_vline(xintercept = obs_diff_mosaic, colour = \"red\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/permutation-test-1-1.png){width=2100}\n:::\n\n```{.r .cell-code}\n# p-value\n# Null distributions are always centered around zero. Why?\nprop(~ mean >= obs_diff_mosaic,\n  data = null_dist_mosaic\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nprop_TRUE \n        0 \n```\n\n\n:::\n:::\n\n\nLet us try the bootstrap test now: Here we *simulate samples, similar to the one at hand*, using repeated sampling the sample itself, with replacement, a process known as **bootstrapping**, or *bootstrap sampling*.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Set graph theme\ntheme_set(new = theme_custom())\n##\n## Resample with replacement from the one sample of 50\n## Calculate the mean each time\nnull_toy_bs <- mosaic::do(4999) *\n  mean(\n    ~ sample(y,\n      replace = T\n    ), # select with replacement\n    data = mydata\n  )\n\n## Plot this NULL distribution\ngf_histogram(\n  ~mean,\n  data = null_toy_bs,\n  bins = 50,\n  title = \"Distribution of Bootstrap Means\"\n) %>%\n  gf_labs(\n    x = \"Calculated Random Means\",\n    y = \"How Often do these occur?\"\n  ) %>%\n  gf_vline(xintercept = ~belief1, colour = \"red\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/bootstrap-test-1-1.png){width=2100}\n:::\n\n```{.r .cell-code}\nprop(~ mean >= belief1,\n  data = null_toy_bs\n) +\n  prop(~ mean <= -belief1,\n    data = null_toy_bs\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nprop_TRUE \n        1 \n```\n\n\n:::\n:::\n\n\n::: callout-note\n### Permutation vs Bootstrap\nThere is a difference between the two. \nThe *bootstrap test* uses the sample at hand to generate many similar samples *without access to the population*, and calculates the statistic needed (i.e. mean). No Hypothesis is stated. The distribution of bootstrap samples looks \"similar\" to that we might obtain by repeatedly sampling the population itself. (centred around a population parameter, i.e. $\\mu$)\n\nThe *permutation test* generates many permutations of the data and generates appropriates measures/statistics *under the NULL hypothesis*. Which is why the permutation test has a NULL distribution centered at $0$ in this case, our NULL hypothesis. \n\nAs student [Sneha Manu Jacob](https://linkedin.com) remarked in class, *Permutation flips the signs of the data values in our sample; Bootstrap flips the number of times each data value is (re)used*. Good Insight!!\n\n:::\n\n### Intuitive\n\nYes, the t-test works, but what is really happening under the hood of the t-test? The inner mechanism of the t-test can be stated in the following steps:\n\n1. Calculate the `mean` of the sample $\\bar{y}$.\n2. Calculate the `sd` of the sample, and, assuming the sample is normally distributed, calculate the `standard error` (i.e. $\\frac{sd}{\\sqrt{n}}$)\n3. Take the difference between the sample mean $\\bar{y}$ and our expected/believed population mean $\\mu$. \n4. We expect that the population mean ought to be within the `confidence interval` of the sample mean $\\bar{y}$.\n5. For a normally distributed sample, the confidence interval is given by $\\pm1.96 * standarderror$, to be 95% sure that the sample mean is a good estimate for the population mean. \n5. Therefore if the difference between actual and believed is far beyond the confidence interval, hmm...we cannot think our belief is correct and we change our opinion. \n\nLet us translate that mouthful into calculations!\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmean_belief_pop <- 0.0 # Assert our belief\n# Sample Mean\nmean_y <- mean(y)\nmean_y\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 2.045689\n```\n\n\n:::\n\n```{.r .cell-code}\n## Sample standard error\nstd_error <- sd(y) / sqrt(length(y))\nstd_error\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.3014752\n```\n\n\n:::\n\n```{.r .cell-code}\n## Confidence Interval of Observed Mean\nconf_int <- tibble(ci_low = mean_y - 1.96 * std_error, ci_high = mean_y + 1.96 * std_error)\nconf_int\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"ci_low\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"ci_high\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1.454798\",\"2\":\"2.63658\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n## Difference between actual and believed mean\nmean_diff <- mean_y - mean_belief_pop\nmean_diff\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 2.045689\n```\n\n\n:::\n\n```{.r .cell-code}\n## Test Statistic\nt <- mean_diff / std_error\nt\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 6.785596\n```\n\n\n:::\n:::\n\n\nWe see that the difference between means is 6.78 times the std_error! At a distance of 1.96 (either way) the probability of this data happening by chance already drops to 5%!! At this distance of 6.78, we would have negligible probability of this data occurring by chance!\n\nHow can we visualize this?\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=2100}\n:::\n:::\n\n\n\n::: {.cell layout-ncol=\"2\"}\n::: {.cell-output .cell-output-stderr}\n\n```\n\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nIf X ~ N(2.046, 0.3015), then \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\tP(X <= 1.443e-07) = P(Z <= -6.786) = 5.78e-12\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\tP(X >  1.443e-07) = P(Z >  -6.786) = 1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=2100}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 5.780412e-12\n```\n\n\n:::\n:::\n\n\n:::\n\n\n## {{< iconify pajamas issue-type-test-case >}} Case Study #2: Exam data\n\nLet us now choose a dataset from the `openintro` package:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(\"exam_grades\")\nexam_grades\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"semester\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"sex\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"exam1\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"exam2\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"exam3\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"course_grade\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"84.5000\",\"4\":\"69.5\",\"5\":\"86.5000\",\"6\":\"76.2564\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"80.0000\",\"4\":\"74.0\",\"5\":\"67.0000\",\"6\":\"75.3882\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"56.0000\",\"4\":\"70.0\",\"5\":\"71.5000\",\"6\":\"67.0564\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"64.0000\",\"4\":\"61.0\",\"5\":\"67.5000\",\"6\":\"63.4538\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"90.5000\",\"4\":\"72.5\",\"5\":\"75.0000\",\"6\":\"72.3949\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"74.0000\",\"4\":\"78.5\",\"5\":\"84.5000\",\"6\":\"71.4128\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"60.5000\",\"4\":\"44.0\",\"5\":\"58.0000\",\"6\":\"56.0949\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"89.0000\",\"4\":\"82.0\",\"5\":\"88.0000\",\"6\":\"78.0103\"},{\"1\":\"2000-1\",\"2\":\"Woman\",\"3\":\"87.5000\",\"4\":\"86.5\",\"5\":\"95.0000\",\"6\":\"82.9026\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"91.0000\",\"4\":\"98.0\",\"5\":\"88.0000\",\"6\":\"89.0846\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"79.5000\",\"4\":\"88.0\",\"5\":\"56.0000\",\"6\":\"72.9769\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"96.0000\",\"4\":\"91.5\",\"5\":\"78.0000\",\"6\":\"82.5282\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"55.0000\",\"4\":\"79.5\",\"5\":\"72.0000\",\"6\":\"69.9872\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"80.0000\",\"4\":\"83.5\",\"5\":\"70.0000\",\"6\":\"67.7256\"},{\"1\":\"2000-1\",\"2\":\"Woman\",\"3\":\"64.5000\",\"4\":\"83.5\",\"5\":\"77.0000\",\"6\":\"80.3051\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"73.0000\",\"4\":\"90.0\",\"5\":\"96.0000\",\"6\":\"74.8744\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"83.0000\",\"4\":\"79.0\",\"5\":\"65.0000\",\"6\":\"71.1615\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"72.0000\",\"4\":\"91.0\",\"5\":\"90.0000\",\"6\":\"76.5615\"},{\"1\":\"2000-1\",\"2\":\"Woman\",\"3\":\"57.9000\",\"4\":\"53.0\",\"5\":\"47.0000\",\"6\":\"56.9903\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"89.0000\",\"4\":\"83.5\",\"5\":\"78.5000\",\"6\":\"80.8026\"},{\"1\":\"2000-1\",\"2\":\"Woman\",\"3\":\"69.0000\",\"4\":\"57.0\",\"5\":\"88.0000\",\"6\":\"69.4308\"},{\"1\":\"2000-1\",\"2\":\"Woman\",\"3\":\"91.0000\",\"4\":\"91.0\",\"5\":\"95.5000\",\"6\":\"92.0051\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"68.0000\",\"4\":\"84.5\",\"5\":\"64.0000\",\"6\":\"67.9051\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"83.0000\",\"4\":\"89.5\",\"5\":\"93.0000\",\"6\":\"79.7872\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"72.0000\",\"4\":\"77.5\",\"5\":\"67.0000\",\"6\":\"67.1256\"},{\"1\":\"2000-1\",\"2\":\"Woman\",\"3\":\"56.0000\",\"4\":\"45.0\",\"5\":\"61.0000\",\"6\":\"58.6308\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"55.0000\",\"4\":\"71.0\",\"5\":\"72.0000\",\"6\":\"67.8308\"},{\"1\":\"2000-1\",\"2\":\"Woman\",\"3\":\"68.5000\",\"4\":\"64.0\",\"5\":\"93.0000\",\"6\":\"77.6903\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"68.5000\",\"4\":\"79.5\",\"5\":\"50.5000\",\"6\":\"69.9308\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"70.0000\",\"4\":\"71.0\",\"5\":\"76.0000\",\"6\":\"69.6769\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"75.0000\",\"4\":\"81.0\",\"5\":\"81.5000\",\"6\":\"68.0923\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"68.5000\",\"4\":\"66.0\",\"5\":\"58.0000\",\"6\":\"60.3128\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"54.0000\",\"4\":\"84.0\",\"5\":\"88.0000\",\"6\":\"72.3821\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"79.6000\",\"4\":\"67.0\",\"5\":\"72.0000\",\"6\":\"67.4787\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"85.0000\",\"4\":\"61.0\",\"5\":\"44.5000\",\"6\":\"66.2364\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"82.0000\",\"4\":\"86.5\",\"5\":\"92.5000\",\"6\":\"83.3231\"},{\"1\":\"2000-1\",\"2\":\"Woman\",\"3\":\"65.0000\",\"4\":\"83.5\",\"5\":\"87.0000\",\"6\":\"77.6436\"},{\"1\":\"2000-1\",\"2\":\"Woman\",\"3\":\"76.0000\",\"4\":\"50.0\",\"5\":\"91.5000\",\"6\":\"70.9462\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"94.5000\",\"4\":\"67.0\",\"5\":\"96.0000\",\"6\":\"86.0133\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"72.0000\",\"4\":\"67.0\",\"5\":\"90.0000\",\"6\":\"72.0269\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"65.5000\",\"4\":\"82.5\",\"5\":\"79.0000\",\"6\":\"77.0282\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"61.5000\",\"4\":\"80.5\",\"5\":\"81.5000\",\"6\":\"68.2821\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"65.0000\",\"4\":\"50.0\",\"5\":\"43.5000\",\"6\":\"43.2733\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"63.0000\",\"4\":\"82.0\",\"5\":\"88.0000\",\"6\":\"70.1031\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"75.0000\",\"4\":\"66.5\",\"5\":\"76.0000\",\"6\":\"65.0846\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"69.5000\",\"4\":\"70.5\",\"5\":\"76.0000\",\"6\":\"68.6538\"},{\"1\":\"2000-1\",\"2\":\"Woman\",\"3\":\"60.0000\",\"4\":\"95.0\",\"5\":\"91.0000\",\"6\":\"83.0508\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"84.0000\",\"4\":\"88.0\",\"5\":\"67.0000\",\"6\":\"75.0856\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"90.0000\",\"4\":\"99.5\",\"5\":\"87.5000\",\"6\":\"74.4718\"},{\"1\":\"2000-1\",\"2\":\"Woman\",\"3\":\"62.5000\",\"4\":\"85.5\",\"5\":\"85.5000\",\"6\":\"74.4821\"},{\"1\":\"2000-1\",\"2\":\"Man\",\"3\":\"88.5000\",\"4\":\"86.5\",\"5\":\"70.0000\",\"6\":\"77.9526\"},{\"1\":\"2000-2\",\"2\":\"Man\",\"3\":\"74.5000\",\"4\":\"83.0\",\"5\":\"62.4000\",\"6\":\"78.7554\"},{\"1\":\"2000-2\",\"2\":\"Man\",\"3\":\"73.5000\",\"4\":\"69.5\",\"5\":\"74.5000\",\"6\":\"69.0228\"},{\"1\":\"2000-2\",\"2\":\"Man\",\"3\":\"75.0000\",\"4\":\"60.5\",\"5\":\"80.9000\",\"6\":\"68.6502\"},{\"1\":\"2000-2\",\"2\":\"Man\",\"3\":\"76.5000\",\"4\":\"76.0\",\"5\":\"61.0000\",\"6\":\"73.6702\"},{\"1\":\"2000-2\",\"2\":\"Woman\",\"3\":\"90.5000\",\"4\":\"68.0\",\"5\":\"59.0000\",\"6\":\"69.7842\"},{\"1\":\"2000-2\",\"2\":\"Man\",\"3\":\"88.0000\",\"4\":\"77.5\",\"5\":\"90.5000\",\"6\":\"84.1474\"},{\"1\":\"2000-2\",\"2\":\"Man\",\"3\":\"87.2727\",\"4\":\"58.0\",\"5\":\"28.0000\",\"6\":\"49.1931\"},{\"1\":\"2000-2\",\"2\":\"Man\",\"3\":\"81.9000\",\"4\":\"86.0\",\"5\":\"62.0000\",\"6\":\"73.9116\"},{\"1\":\"2000-2\",\"2\":\"Man\",\"3\":\"65.5000\",\"4\":\"90.0\",\"5\":\"61.8000\",\"6\":\"68.5425\"},{\"1\":\"2000-2\",\"2\":\"Woman\",\"3\":\"84.5000\",\"4\":\"80.5\",\"5\":\"72.5000\",\"6\":\"81.2088\"},{\"1\":\"2000-2\",\"2\":\"Man\",\"3\":\"88.9000\",\"4\":\"67.0\",\"5\":\"76.0000\",\"6\":\"80.5554\"},{\"1\":\"2000-2\",\"2\":\"Man\",\"3\":\"70.0000\",\"4\":\"56.0\",\"5\":\"81.5000\",\"6\":\"68.7839\"},{\"1\":\"2000-2\",\"2\":\"Man\",\"3\":\"73.0000\",\"4\":\"48.0\",\"5\":\"55.0000\",\"6\":\"65.3088\"},{\"1\":\"2000-2\",\"2\":\"Man\",\"3\":\"86.0000\",\"4\":\"77.0\",\"5\":\"82.0000\",\"6\":\"79.6035\"},{\"1\":\"2000-2\",\"2\":\"Man\",\"3\":\"68.0000\",\"4\":\"60.0\",\"5\":\"59.0000\",\"6\":\"58.4316\"},{\"1\":\"2000-2\",\"2\":\"Woman\",\"3\":\"82.0000\",\"4\":\"74.0\",\"5\":\"81.5000\",\"6\":\"76.6842\"},{\"1\":\"2000-2\",\"2\":\"Man\",\"3\":\"86.4000\",\"4\":\"72.0\",\"5\":\"69.5000\",\"6\":\"67.5625\"},{\"1\":\"2000-2\",\"2\":\"Man\",\"3\":\"74.0000\",\"4\":\"83.0\",\"5\":\"79.9000\",\"6\":\"74.5730\"},{\"1\":\"2000-2\",\"2\":\"Man\",\"3\":\"92.3000\",\"4\":\"76.0\",\"5\":\"97.0000\",\"6\":\"87.0288\"},{\"1\":\"2000-2\",\"2\":\"Man\",\"3\":\"57.0000\",\"4\":\"70.0\",\"5\":\"56.0000\",\"6\":\"65.3947\"},{\"1\":\"2000-2\",\"2\":\"Man\",\"3\":\"62.5000\",\"4\":\"41.0\",\"5\":\"77.8000\",\"6\":\"59.8863\"},{\"1\":\"2000-2\",\"2\":\"Man\",\"3\":\"75.5000\",\"4\":\"62.5\",\"5\":\"79.7000\",\"6\":\"73.5435\"},{\"1\":\"2000-2\",\"2\":\"Man\",\"3\":\"67.0000\",\"4\":\"58.0\",\"5\":\"45.8000\",\"6\":\"58.3828\"},{\"1\":\"2000-2\",\"2\":\"Man\",\"3\":\"73.0000\",\"4\":\"78.0\",\"5\":\"77.3000\",\"6\":\"79.2354\"},{\"1\":\"2000-2\",\"2\":\"Man\",\"3\":\"93.0000\",\"4\":\"75.0\",\"5\":\"96.0000\",\"6\":\"71.3228\"},{\"1\":\"2000-2\",\"2\":\"Man\",\"3\":\"81.5000\",\"4\":\"73.0\",\"5\":\"69.5000\",\"6\":\"65.5295\"},{\"1\":\"2000-2\",\"2\":\"Man\",\"3\":\"82.5000\",\"4\":\"83.5\",\"5\":\"82.5000\",\"6\":\"81.4474\"},{\"1\":\"2000-2\",\"2\":\"Woman\",\"3\":\"46.5000\",\"4\":\"77.0\",\"5\":\"47.0000\",\"6\":\"62.8842\"},{\"1\":\"2000-2\",\"2\":\"Man\",\"3\":\"62.0000\",\"4\":\"71.0\",\"5\":\"64.0000\",\"6\":\"69.4702\"},{\"1\":\"2000-2\",\"2\":\"Woman\",\"3\":\"68.5000\",\"4\":\"55.5\",\"5\":\"52.0000\",\"6\":\"61.8263\"},{\"1\":\"2000-2\",\"2\":\"Man\",\"3\":\"80.0000\",\"4\":\"84.0\",\"5\":\"48.5000\",\"6\":\"70.0947\"},{\"1\":\"2000-2\",\"2\":\"Man\",\"3\":\"77.0000\",\"4\":\"77.0\",\"5\":\"44.0000\",\"6\":\"68.0404\"},{\"1\":\"2000-2\",\"2\":\"Woman\",\"3\":\"55.0000\",\"4\":\"94.0\",\"5\":\"96.0000\",\"6\":\"83.5193\"},{\"1\":\"2000-2\",\"2\":\"Man\",\"3\":\"69.0000\",\"4\":\"74.5\",\"5\":\"41.5000\",\"6\":\"59.0386\"},{\"1\":\"2000-2\",\"2\":\"Woman\",\"3\":\"74.0000\",\"4\":\"56.0\",\"5\":\"69.9000\",\"6\":\"65.0204\"},{\"1\":\"2001-1\",\"2\":\"Man\",\"3\":\"93.0000\",\"4\":\"76.0\",\"5\":\"95.5000\",\"6\":\"85.5000\"},{\"1\":\"2001-1\",\"2\":\"Man\",\"3\":\"81.0000\",\"4\":\"78.0\",\"5\":\"79.5000\",\"6\":\"75.7333\"},{\"1\":\"2001-1\",\"2\":\"Man\",\"3\":\"98.0000\",\"4\":\"87.0\",\"5\":\"85.5000\",\"6\":\"86.5833\"},{\"1\":\"2001-1\",\"2\":\"Man\",\"3\":\"92.5000\",\"4\":\"81.0\",\"5\":\"74.5000\",\"6\":\"77.2833\"},{\"1\":\"2001-1\",\"2\":\"Man\",\"3\":\"83.5000\",\"4\":\"60.5\",\"5\":\"78.0000\",\"6\":\"73.6333\"},{\"1\":\"2001-1\",\"2\":\"Man\",\"3\":\"98.0000\",\"4\":\"92.0\",\"5\":\"90.5000\",\"6\":\"91.8585\"},{\"1\":\"2001-1\",\"2\":\"Man\",\"3\":\"80.5000\",\"4\":\"53.5\",\"5\":\"67.5000\",\"6\":\"62.9555\"},{\"1\":\"2001-1\",\"2\":\"Man\",\"3\":\"80.9000\",\"4\":\"68.0\",\"5\":\"67.0000\",\"6\":\"72.7600\"},{\"1\":\"2001-1\",\"2\":\"Man\",\"3\":\"84.5000\",\"4\":\"46.0\",\"5\":\"65.5000\",\"6\":\"60.6167\"},{\"1\":\"2001-1\",\"2\":\"Man\",\"3\":\"93.8000\",\"4\":\"59.5\",\"5\":\"73.3000\",\"6\":\"70.0067\"},{\"1\":\"2001-1\",\"2\":\"Man\",\"3\":\"98.0000\",\"4\":\"96.5\",\"5\":\"98.5000\",\"6\":\"97.5667\"},{\"1\":\"2001-1\",\"2\":\"Man\",\"3\":\"92.0000\",\"4\":\"78.5\",\"5\":\"72.0000\",\"6\":\"73.2833\"},{\"1\":\"2001-1\",\"2\":\"Man\",\"3\":\"91.0000\",\"4\":\"72.0\",\"5\":\"81.0000\",\"6\":\"75.1167\"},{\"1\":\"2001-1\",\"2\":\"Man\",\"3\":\"80.0000\",\"4\":\"72.0\",\"5\":\"59.5000\",\"6\":\"69.7000\"},{\"1\":\"2001-1\",\"2\":\"Man\",\"3\":\"94.0000\",\"4\":\"84.0\",\"5\":\"98.5000\",\"6\":\"88.8667\"},{\"1\":\"2001-1\",\"2\":\"Man\",\"3\":\"90.0000\",\"4\":\"73.0\",\"5\":\"63.5000\",\"6\":\"72.9000\"},{\"1\":\"2001-1\",\"2\":\"Man\",\"3\":\"94.0000\",\"4\":\"82.0\",\"5\":\"86.4000\",\"6\":\"80.3267\"},{\"1\":\"2001-1\",\"2\":\"Man\",\"3\":\"86.5000\",\"4\":\"76.0\",\"5\":\"85.5000\",\"6\":\"76.2000\"},{\"1\":\"2001-1\",\"2\":\"Man\",\"3\":\"87.0000\",\"4\":\"76.0\",\"5\":\"72.5000\",\"6\":\"70.7442\"},{\"1\":\"2001-1\",\"2\":\"Man\",\"3\":\"80.3000\",\"4\":\"88.5\",\"5\":\"83.5000\",\"6\":\"85.9700\"},{\"1\":\"2001-1\",\"2\":\"Man\",\"3\":\"89.5000\",\"4\":\"66.5\",\"5\":\"78.9000\",\"6\":\"72.5267\"},{\"1\":\"2001-1\",\"2\":\"Man\",\"3\":\"70.5000\",\"4\":\"70.5\",\"5\":\"58.0000\",\"6\":\"57.0000\"},{\"1\":\"2001-1\",\"2\":\"Man\",\"3\":\"89.4000\",\"4\":\"84.5\",\"5\":\"82.5000\",\"6\":\"83.8685\"},{\"1\":\"2001-1\",\"2\":\"Woman\",\"3\":\"79.5000\",\"4\":\"56.0\",\"5\":\"81.0000\",\"6\":\"68.2500\"},{\"1\":\"2001-1\",\"2\":\"Man\",\"3\":\"93.9000\",\"4\":\"88.0\",\"5\":\"71.0000\",\"6\":\"80.0600\"},{\"1\":\"2001-1\",\"2\":\"Man\",\"3\":\"73.5000\",\"4\":\"78.5\",\"5\":\"72.0000\",\"6\":\"77.0333\"},{\"1\":\"2001-1\",\"2\":\"Man\",\"3\":\"94.8000\",\"4\":\"84.5\",\"5\":\"77.5000\",\"6\":\"84.1700\"},{\"1\":\"2001-1\",\"2\":\"Woman\",\"3\":\"66.0000\",\"4\":\"62.0\",\"5\":\"80.5000\",\"6\":\"70.9333\"},{\"1\":\"2001-1\",\"2\":\"Man\",\"3\":\"96.3000\",\"4\":\"82.0\",\"5\":\"76.0000\",\"6\":\"79.9867\"},{\"1\":\"2001-1\",\"2\":\"Man\",\"3\":\"93.3000\",\"4\":\"93.0\",\"5\":\"92.5000\",\"6\":\"89.8033\"},{\"1\":\"2001-1\",\"2\":\"Man\",\"3\":\"87.3000\",\"4\":\"81.0\",\"5\":\"78.5000\",\"6\":\"85.7367\"},{\"1\":\"2001-1\",\"2\":\"Man\",\"3\":\"79.0000\",\"4\":\"81.0\",\"5\":\"91.0000\",\"6\":\"78.1222\"},{\"1\":\"2001-1\",\"2\":\"Man\",\"3\":\"84.0000\",\"4\":\"81.0\",\"5\":\"91.0000\",\"6\":\"75.0333\"},{\"1\":\"2001-1\",\"2\":\"Woman\",\"3\":\"81.0000\",\"4\":\"81.5\",\"5\":\"70.0000\",\"6\":\"74.2167\"},{\"1\":\"2001-1\",\"2\":\"Woman\",\"3\":\"84.5000\",\"4\":\"71.5\",\"5\":\"76.0000\",\"6\":\"73.9833\"},{\"1\":\"2001-1\",\"2\":\"Woman\",\"3\":\"90.6250\",\"4\":\"61.5\",\"5\":\"59.5000\",\"6\":\"66.6958\"},{\"1\":\"2001-1\",\"2\":\"Woman\",\"3\":\"91.5000\",\"4\":\"58.0\",\"5\":\"79.5000\",\"6\":\"74.9888\"},{\"1\":\"2001-1\",\"2\":\"Man\",\"3\":\"84.0000\",\"4\":\"72.5\",\"5\":\"76.0000\",\"6\":\"75.7000\"},{\"1\":\"2001-2\",\"2\":\"Man\",\"3\":\"73.2000\",\"4\":\"44.0\",\"5\":\"50.9000\",\"6\":\"47.9000\"},{\"1\":\"2001-2\",\"2\":\"Man\",\"3\":\"70.5000\",\"4\":\"42.8\",\"5\":\"36.4000\",\"6\":\"48.0500\"},{\"1\":\"2001-2\",\"2\":\"Woman\",\"3\":\"92.9000\",\"4\":\"88.5\",\"5\":\"79.0000\",\"6\":\"86.6500\"},{\"1\":\"2001-2\",\"2\":\"Man\",\"3\":\"68.8000\",\"4\":\"52.1\",\"5\":\"65.4000\",\"6\":\"55.9500\"},{\"1\":\"2001-2\",\"2\":\"Man\",\"3\":\"91.3000\",\"4\":\"71.0\",\"5\":\"79.5000\",\"6\":\"77.8250\"},{\"1\":\"2001-2\",\"2\":\"Man\",\"3\":\"78.3000\",\"4\":\"46.5\",\"5\":\"63.9000\",\"6\":\"56.7250\"},{\"1\":\"2001-2\",\"2\":\"Man\",\"3\":\"71.3000\",\"4\":\"43.0\",\"5\":\"67.4000\",\"6\":\"58.3750\"},{\"1\":\"2001-2\",\"2\":\"Man\",\"3\":\"74.9000\",\"4\":\"65.4\",\"5\":\"51.5000\",\"6\":\"56.0750\"},{\"1\":\"2001-2\",\"2\":\"Man\",\"3\":\"90.5000\",\"4\":\"71.5\",\"5\":\"69.5000\",\"6\":\"78.5000\"},{\"1\":\"2001-2\",\"2\":\"Man\",\"3\":\"80.3000\",\"4\":\"63.0\",\"5\":\"64.0000\",\"6\":\"64.7000\"},{\"1\":\"2001-2\",\"2\":\"Woman\",\"3\":\"79.0000\",\"4\":\"74.5\",\"5\":\"72.5000\",\"6\":\"68.3250\"},{\"1\":\"2001-2\",\"2\":\"Man\",\"3\":\"82.5000\",\"4\":\"62.5\",\"5\":\"77.5000\",\"6\":\"73.5000\"},{\"1\":\"2001-2\",\"2\":\"Man\",\"3\":\"79.7000\",\"4\":\"84.4\",\"5\":\"77.3000\",\"6\":\"75.5500\"},{\"1\":\"2001-2\",\"2\":\"Man\",\"3\":\"79.5000\",\"4\":\"77.9\",\"5\":\"62.0000\",\"6\":\"68.3500\"},{\"1\":\"2001-2\",\"2\":\"Man\",\"3\":\"79.5000\",\"4\":\"68.7\",\"5\":\"87.0000\",\"6\":\"81.7500\"},{\"1\":\"2001-2\",\"2\":\"Man\",\"3\":\"93.0000\",\"4\":\"70.9\",\"5\":\"67.5000\",\"6\":\"70.4250\"},{\"1\":\"2001-2\",\"2\":\"Man\",\"3\":\"88.5000\",\"4\":\"79.5\",\"5\":\"82.0000\",\"6\":\"80.5000\"},{\"1\":\"2001-2\",\"2\":\"Woman\",\"3\":\"86.0000\",\"4\":\"73.0\",\"5\":\"47.0000\",\"6\":\"66.0000\"},{\"1\":\"2001-2\",\"2\":\"Man\",\"3\":\"93.8000\",\"4\":\"68.5\",\"5\":\"66.4000\",\"6\":\"74.8750\"},{\"1\":\"2001-2\",\"2\":\"Woman\",\"3\":\"93.9000\",\"4\":\"84.0\",\"5\":\"83.5000\",\"6\":\"88.2250\"},{\"1\":\"2001-2\",\"2\":\"Man\",\"3\":\"83.3000\",\"4\":\"83.0\",\"5\":\"78.0000\",\"6\":\"82.5750\"},{\"1\":\"2001-2\",\"2\":\"Man\",\"3\":\"75.1000\",\"4\":\"70.0\",\"5\":\"61.0000\",\"6\":\"64.0250\"},{\"1\":\"2001-2\",\"2\":\"Man\",\"3\":\"92.9000\",\"4\":\"83.0\",\"5\":\"84.5000\",\"6\":\"84.1500\"},{\"1\":\"2001-2\",\"2\":\"Man\",\"3\":\"76.5000\",\"4\":\"41.5\",\"5\":\"48.0000\",\"6\":\"53.0750\"},{\"1\":\"2001-2\",\"2\":\"Woman\",\"3\":\"84.1000\",\"4\":\"88.8\",\"5\":\"75.5000\",\"6\":\"81.5500\"},{\"1\":\"2001-2\",\"2\":\"Man\",\"3\":\"87.9000\",\"4\":\"58.2\",\"5\":\"67.0000\",\"6\":\"63.5250\"},{\"1\":\"2001-2\",\"2\":\"Woman\",\"3\":\"79.5000\",\"4\":\"66.0\",\"5\":\"67.5000\",\"6\":\"69.1250\"},{\"1\":\"2001-2\",\"2\":\"Man\",\"3\":\"82.0000\",\"4\":\"53.5\",\"5\":\"52.0000\",\"6\":\"54.5000\"},{\"1\":\"2001-2\",\"2\":\"Woman\",\"3\":\"91.4000\",\"4\":\"77.0\",\"5\":\"76.0000\",\"6\":\"76.1000\"},{\"1\":\"2001-2\",\"2\":\"Man\",\"3\":\"84.9000\",\"4\":\"69.5\",\"5\":\"37.3000\",\"6\":\"60.3000\"},{\"1\":\"2001-2\",\"2\":\"Man\",\"3\":\"58.0000\",\"4\":\"61.0\",\"5\":\"47.4000\",\"6\":\"57.6000\"},{\"1\":\"2001-2\",\"2\":\"Man\",\"3\":\"81.5000\",\"4\":\"57.5\",\"5\":\"65.8000\",\"6\":\"60.3250\"},{\"1\":\"2001-2\",\"2\":\"Man\",\"3\":\"95.0000\",\"4\":\"68.0\",\"5\":\"82.5000\",\"6\":\"76.7500\"},{\"1\":\"2001-2\",\"2\":\"Man\",\"3\":\"95.5000\",\"4\":\"80.5\",\"5\":\"84.3000\",\"6\":\"75.7750\"},{\"1\":\"2001-2\",\"2\":\"Man\",\"3\":\"77.5000\",\"4\":\"80.9\",\"5\":\"75.0000\",\"6\":\"76.4250\"},{\"1\":\"2001-2\",\"2\":\"Man\",\"3\":\"82.0000\",\"4\":\"46.0\",\"5\":\"54.0000\",\"6\":\"53.0000\"},{\"1\":\"2001-2\",\"2\":\"Man\",\"3\":\"93.8000\",\"4\":\"82.5\",\"5\":\"80.5000\",\"6\":\"84.6500\"},{\"1\":\"2002-1\",\"2\":\"Man\",\"3\":\"89.0000\",\"4\":\"83.5\",\"5\":\"92.0000\",\"6\":\"77.1197\"},{\"1\":\"2002-1\",\"2\":\"Man\",\"3\":\"82.0000\",\"4\":\"78.5\",\"5\":\"82.0000\",\"6\":\"61.7972\"},{\"1\":\"2002-1\",\"2\":\"Man\",\"3\":\"73.5000\",\"4\":\"80.0\",\"5\":\"82.0000\",\"6\":\"73.5563\"},{\"1\":\"2002-1\",\"2\":\"Man\",\"3\":\"73.5000\",\"4\":\"82.8\",\"5\":\"79.5000\",\"6\":\"69.9459\"},{\"1\":\"2002-1\",\"2\":\"Woman\",\"3\":\"79.0000\",\"4\":\"86.5\",\"5\":\"97.0000\",\"6\":\"80.5324\"},{\"1\":\"2002-1\",\"2\":\"Man\",\"3\":\"71.5000\",\"4\":\"71.0\",\"5\":\"58.0000\",\"6\":\"62.4331\"},{\"1\":\"2002-1\",\"2\":\"Man\",\"3\":\"92.5000\",\"4\":\"92.0\",\"5\":\"93.5000\",\"6\":\"82.2000\"},{\"1\":\"2002-1\",\"2\":\"Woman\",\"3\":\"85.5000\",\"4\":\"90.5\",\"5\":\"85.0000\",\"6\":\"86.7901\"},{\"1\":\"2002-1\",\"2\":\"Man\",\"3\":\"93.0000\",\"4\":\"47.0\",\"5\":\"70.0000\",\"6\":\"59.8218\"},{\"1\":\"2002-1\",\"2\":\"Man\",\"3\":\"75.5000\",\"4\":\"66.0\",\"5\":\"94.0000\",\"6\":\"69.0648\"},{\"1\":\"2002-1\",\"2\":\"Man\",\"3\":\"88.5000\",\"4\":\"74.0\",\"5\":\"87.0000\",\"6\":\"78.2085\"},{\"1\":\"2002-1\",\"2\":\"Man\",\"3\":\"87.0000\",\"4\":\"96.0\",\"5\":\"98.5000\",\"6\":\"84.0577\"},{\"1\":\"2002-1\",\"2\":\"Woman\",\"3\":\"89.5000\",\"4\":\"77.5\",\"5\":\"88.9000\",\"6\":\"69.2110\"},{\"1\":\"2002-1\",\"2\":\"Man\",\"3\":\"97.5000\",\"4\":\"94.5\",\"5\":\"76.0000\",\"6\":\"78.9310\"},{\"1\":\"2002-1\",\"2\":\"Woman\",\"3\":\"59.0000\",\"4\":\"73.0\",\"5\":\"85.5000\",\"6\":\"58.2606\"},{\"1\":\"2002-1\",\"2\":\"Man\",\"3\":\"81.0000\",\"4\":\"87.0\",\"5\":\"86.5000\",\"6\":\"72.1352\"},{\"1\":\"2002-1\",\"2\":\"Man\",\"3\":\"73.5000\",\"4\":\"57.5\",\"5\":\"83.0000\",\"6\":\"61.7713\"},{\"1\":\"2002-1\",\"2\":\"Man\",\"3\":\"90.5000\",\"4\":\"53.0\",\"5\":\"78.5000\",\"6\":\"60.7915\"},{\"1\":\"2002-1\",\"2\":\"Man\",\"3\":\"70.0000\",\"4\":\"62.5\",\"5\":\"85.0000\",\"6\":\"64.5225\"},{\"1\":\"2002-1\",\"2\":\"Man\",\"3\":\"98.5000\",\"4\":\"98.0\",\"5\":\"90.0000\",\"6\":\"80.3761\"},{\"1\":\"2002-1\",\"2\":\"Man\",\"3\":\"85.5000\",\"4\":\"67.0\",\"5\":\"86.0000\",\"6\":\"67.6535\"},{\"1\":\"2002-1\",\"2\":\"Man\",\"3\":\"78.0000\",\"4\":\"58.0\",\"5\":\"92.5000\",\"6\":\"65.1831\"},{\"1\":\"2002-1\",\"2\":\"Man\",\"3\":\"86.5000\",\"4\":\"85.0\",\"5\":\"85.0000\",\"6\":\"73.5972\"},{\"1\":\"2002-1\",\"2\":\"Woman\",\"3\":\"99.3000\",\"4\":\"96.0\",\"5\":\"89.0000\",\"6\":\"91.4868\"},{\"1\":\"2002-1\",\"2\":\"Man\",\"3\":\"90.5000\",\"4\":\"78.5\",\"5\":\"79.5000\",\"6\":\"73.0634\"},{\"1\":\"2002-1\",\"2\":\"Man\",\"3\":\"86.5000\",\"4\":\"67.5\",\"5\":\"85.5000\",\"6\":\"70.0746\"},{\"1\":\"2002-1\",\"2\":\"Man\",\"3\":\"80.0000\",\"4\":\"94.0\",\"5\":\"90.5000\",\"6\":\"88.4310\"},{\"1\":\"2002-1\",\"2\":\"Man\",\"3\":\"72.0000\",\"4\":\"95.0\",\"5\":\"78.0000\",\"6\":\"77.3507\"},{\"1\":\"2002-1\",\"2\":\"Man\",\"3\":\"72.5000\",\"4\":\"69.5\",\"5\":\"92.0000\",\"6\":\"73.5648\"},{\"1\":\"2002-1\",\"2\":\"Man\",\"3\":\"77.5000\",\"4\":\"74.0\",\"5\":\"82.0000\",\"6\":\"73.1493\"},{\"1\":\"2002-1\",\"2\":\"Man\",\"3\":\"74.0000\",\"4\":\"49.5\",\"5\":\"82.0000\",\"6\":\"64.6690\"},{\"1\":\"2002-1\",\"2\":\"Man\",\"3\":\"79.0000\",\"4\":\"80.5\",\"5\":\"80.5000\",\"6\":\"71.9845\"},{\"1\":\"2002-1\",\"2\":\"Man\",\"3\":\"80.0000\",\"4\":\"82.0\",\"5\":\"77.0000\",\"6\":\"67.7986\"},{\"1\":\"2002-1\",\"2\":\"Man\",\"3\":\"97.4000\",\"4\":\"66.9\",\"5\":\"83.0000\",\"6\":\"74.9276\"},{\"1\":\"2002-1\",\"2\":\"Man\",\"3\":\"61.5000\",\"4\":\"64.5\",\"5\":\"86.0000\",\"6\":\"63.7651\"},{\"1\":\"2002-1\",\"2\":\"Man\",\"3\":\"86.0000\",\"4\":\"67.0\",\"5\":\"96.8000\",\"6\":\"73.7346\"},{\"1\":\"2003-1\",\"2\":\"Woman\",\"3\":\"75.7143\",\"4\":\"62.6\",\"5\":\"45.5556\",\"6\":\"59.5549\"},{\"1\":\"2003-1\",\"2\":\"Woman\",\"3\":\"80.7143\",\"4\":\"38.0\",\"5\":\"78.3333\",\"6\":\"65.2202\"},{\"1\":\"2003-1\",\"2\":\"Woman\",\"3\":\"88.2143\",\"4\":\"75.1\",\"5\":\"70.0000\",\"6\":\"72.3670\"},{\"1\":\"2003-1\",\"2\":\"Man\",\"3\":\"81.7857\",\"4\":\"76.0\",\"5\":\"68.3333\",\"6\":\"74.1120\"},{\"1\":\"2003-1\",\"2\":\"Man\",\"3\":\"96.0714\",\"4\":\"68.1\",\"5\":\"74.4444\",\"6\":\"70.4423\"},{\"1\":\"2003-1\",\"2\":\"Man\",\"3\":\"NA\",\"4\":\"58.0\",\"5\":\"78.3333\",\"6\":\"46.7231\"},{\"1\":\"2003-1\",\"2\":\"Man\",\"3\":\"73.5714\",\"4\":\"62.1\",\"5\":\"97.7778\",\"6\":\"69.1030\"},{\"1\":\"2003-1\",\"2\":\"Man\",\"3\":\"71.0714\",\"4\":\"41.5\",\"5\":\"55.5556\",\"6\":\"53.9348\"},{\"1\":\"2003-1\",\"2\":\"Man\",\"3\":\"66.4286\",\"4\":\"59.1\",\"5\":\"85.5556\",\"6\":\"68.5149\"},{\"1\":\"2003-1\",\"2\":\"Man\",\"3\":\"85.7143\",\"4\":\"77.1\",\"5\":\"83.3333\",\"6\":\"79.8810\"},{\"1\":\"2003-1\",\"2\":\"Woman\",\"3\":\"88.9286\",\"4\":\"72.0\",\"5\":\"93.3333\",\"6\":\"82.3626\"},{\"1\":\"2003-1\",\"2\":\"Man\",\"3\":\"65.7143\",\"4\":\"60.5\",\"5\":\"30.0000\",\"6\":\"48.5152\"},{\"1\":\"2003-1\",\"2\":\"Man\",\"3\":\"92.5000\",\"4\":\"63.5\",\"5\":\"92.7778\",\"6\":\"80.3655\"},{\"1\":\"2003-1\",\"2\":\"Woman\",\"3\":\"86.0714\",\"4\":\"77.5\",\"5\":\"96.6667\",\"6\":\"80.3527\"},{\"1\":\"2003-1\",\"2\":\"Man\",\"3\":\"75.0000\",\"4\":\"71.9\",\"5\":\"88.3333\",\"6\":\"70.3606\"},{\"1\":\"2003-1\",\"2\":\"Man\",\"3\":\"95.7143\",\"4\":\"90.1\",\"5\":\"98.8889\",\"6\":\"93.3003\"},{\"1\":\"2003-1\",\"2\":\"Man\",\"3\":\"88.9286\",\"4\":\"52.5\",\"5\":\"62.5000\",\"6\":\"61.1081\"},{\"1\":\"2003-1\",\"2\":\"Man\",\"3\":\"94.6429\",\"4\":\"90.0\",\"5\":\"90.0000\",\"6\":\"87.6431\"},{\"1\":\"2003-1\",\"2\":\"Man\",\"3\":\"92.5000\",\"4\":\"80.0\",\"5\":\"96.1111\",\"6\":\"87.9477\"},{\"1\":\"2003-1\",\"2\":\"Woman\",\"3\":\"91.0714\",\"4\":\"39.5\",\"5\":\"78.8889\",\"6\":\"67.9143\"},{\"1\":\"2003-1\",\"2\":\"Man\",\"3\":\"92.8571\",\"4\":\"73.5\",\"5\":\"92.1111\",\"6\":\"86.2788\"},{\"1\":\"2003-1\",\"2\":\"Woman\",\"3\":\"86.0714\",\"4\":\"45.5\",\"5\":\"55.5556\",\"6\":\"59.8701\"},{\"1\":\"2003-1\",\"2\":\"Man\",\"3\":\"87.1429\",\"4\":\"81.6\",\"5\":\"73.8889\",\"6\":\"76.4304\"},{\"1\":\"2003-1\",\"2\":\"Man\",\"3\":\"74.2857\",\"4\":\"52.6\",\"5\":\"47.2222\",\"6\":\"56.3211\"},{\"1\":\"2003-1\",\"2\":\"Man\",\"3\":\"95.7143\",\"4\":\"78.0\",\"5\":\"84.4444\",\"6\":\"83.2086\"},{\"1\":\"2003-1\",\"2\":\"Man\",\"3\":\"83.2143\",\"4\":\"64.6\",\"5\":\"58.8889\",\"6\":\"68.0731\"},{\"1\":\"2003-1\",\"2\":\"Man\",\"3\":\"85.0000\",\"4\":\"78.1\",\"5\":\"82.2222\",\"6\":\"70.5416\"},{\"1\":\"2003-1\",\"2\":\"Man\",\"3\":\"85.7143\",\"4\":\"68.1\",\"5\":\"72.0000\",\"6\":\"66.1202\"},{\"1\":\"2003-1\",\"2\":\"Woman\",\"3\":\"94.6429\",\"4\":\"94.5\",\"5\":\"96.1111\",\"6\":\"90.7190\"},{\"1\":\"2003-1\",\"2\":\"Man\",\"3\":\"90.7143\",\"4\":\"77.5\",\"5\":\"78.2222\",\"6\":\"77.5340\"},{\"1\":\"2003-1\",\"2\":\"Man\",\"3\":\"86.4286\",\"4\":\"70.1\",\"5\":\"88.3333\",\"6\":\"74.5553\"},{\"1\":\"2003-1\",\"2\":\"Man\",\"3\":\"98.2143\",\"4\":\"89.1\",\"5\":\"71.1111\",\"6\":\"85.5208\"},{\"1\":\"2003-1\",\"2\":\"Woman\",\"3\":\"95.0000\",\"4\":\"86.0\",\"5\":\"78.3333\",\"6\":\"83.6959\"},{\"1\":\"2003-1\",\"2\":\"Man\",\"3\":\"97.1429\",\"4\":\"53.5\",\"5\":\"67.2222\",\"6\":\"72.1189\"},{\"1\":\"2003-1\",\"2\":\"Man\",\"3\":\"85.0000\",\"4\":\"63.0\",\"5\":\"75.0000\",\"6\":\"67.1996\"},{\"1\":\"2003-1\",\"2\":\"Man\",\"3\":\"72.8571\",\"4\":\"48.5\",\"5\":\"90.5556\",\"6\":\"66.4035\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n### Research Question\nThere are quite a few Quant variables in the data. Let us choose `course_grade` as our variable of interest. What might we wish to find out?\n\n::: callout-note\n### Research Question\nIn *general*, the Teacher in this class is overly generous with grades [[unlike others we know of](https://www.linkedin.com/in/arvindvenkatadri)]{.bg-washed-red}, and so the average `course-grade` is equal to 80% !!\n:::\n\n### {{< iconify carbon chart-3d >}} Inspecting and Charting Data\n\n:::: {.columns}\n::: {.column width=\"50%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Set graph theme\ntheme_set(new = theme_custom())\n#\nexam_grades %>%\n  gf_density(~course_grade) %>%\n  gf_fitdistr(dist = \"dnorm\") %>%\n  gf_labs(\n    title = \"Density of Course Grade\",\n    subtitle = \"Compared with Normal Density\"\n  )\n```\n:::\n\n:::\n\n::: {.column width=\"50%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=2100}\n:::\n:::\n\n\n:::\n::::\nHmm...data looks normally distributed. But this time we will not merely trust our eyes, but do a test for it. \n\n### Testing Assumptions in the Data\n\n::: callout-note\n### Is the data normally distributed?\n\n::: {.cell}\n\n```{.r .cell-code}\nstats::shapiro.test(x = exam_grades$course_grade) %>%\n  broom::tidy()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"statistic\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p.value\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"method\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"0.9939453\",\"2\":\"0.470688\",\"3\":\"Shapiro-Wilk normality test\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\nThe [Shapiro-Wilkes Test]{} tests whether a data variable is normally distributed or not. Without digging into the maths of it, let us say it makes the assumption that the variable **is** so distributed and then computes the probability of how likely this is. So a **high** `p-value` ($0.47$) is a good thing here. \n\nWhen we have *large* Quant variables ( i.e. with length >= 5000), the `shapiro.test` does not work, and we use an Anderson-Darling[^3] test to confirm normality:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(nortest)\n# Especially when we have >= 5000 observations\nnortest::ad.test(x = exam_grades$course_grade) %>%\n  broom::tidy()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"statistic\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p.value\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"method\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"0.3306555\",\"2\":\"0.5118521\",\"3\":\"Anderson-Darling normality test\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\nSo `course_grade` is a normally-distributed variable. There are *no* exceptional students! Hmph!\n\n:::\n\n## Inference\n\n::: {.panel-tabset .nav-pills style=\"background: whitesmoke;\"}\n\n### t.test\nA. Model\n\nWe have that $mean(course\\_grade) = \\beta_0$. As before, we formulate \"our (dis)belief\" in this sample mean with a *NULL Hypothesis* about the **population**, as follows:\n\n$$\n\\ H_0: \\mu= 80\n$$\n\n$$\nH_a: \\mu \\ne 80\n$$\n\n\nB. Code\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# t-test\nt4 <- mosaic::t_test(\n  exam_grades$course_grade, # Name of variable\n  mu = 80, # belief\n  alternative = \"two.sided\"\n) %>% # Check both sides\n  broom::tidy()\nt4\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"estimate\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"statistic\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p.value\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"parameter\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"conf.low\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"conf.high\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"method\"],\"name\":[7],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"alternative\"],\"name\":[8],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"72.23883\",\"2\":\"-12.07999\",\"3\":\"2.187064e-26\",\"4\":\"232\",\"5\":\"70.97299\",\"6\":\"73.50467\",\"7\":\"One Sample t-test\",\"8\":\"two.sided\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nSo, we can reject the NULL Hypothesis that the average grade in the population of students who have taken this class is 80, since there is a minuscule chance that we would see an *observed sample mean* of 72.238, if the population mean $\\mu$ had really been $80$. \n\n### Wilcoxon test\n\n::: {.cell}\n\n```{.r .cell-code}\n# t-test\nt5 <- wilcox.test(\n  exam_grades$course_grade, # Name of variable\n  mu = 90, # belief\n  alternative = \"two.sided\",\n  conf.int = TRUE,\n  conf.level = 0.95\n) %>% # Check both sides\n\n  broom::tidy() # Make results presentable, and plottable!!\nt5\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"estimate\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"statistic\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p.value\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"conf.low\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"conf.high\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"method\"],\"name\":[6],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"alternative\"],\"name\":[7],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"72.42511\",\"2\":\"75\",\"3\":\"1.487917e-39\",\"4\":\"71.15002\",\"5\":\"73.71426\",\"6\":\"Wilcoxon signed rank test with continuity correction\",\"7\":\"two.sided\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\nThis test too suggests that the average course grade is different from 80.\n\n::: callout-note\n### Why compare on both sides?\nNote that we have computed whether the average `course_grade` is generally **different** from 80 for this Teacher. We could have computed whether it is greater, or lesser than 80 ( or any other number too). Read [this article](https://stats.oarc.ucla.edu/other/mult-pkg/faq/general/faq-what-are-the-differences-between-one-tailed-and-two-tailed-tests/) for why it is better to do a \"two.sided\" test in most cases. \n:::\n\n\n### Using Permutation and Bootstrap\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Set graph theme\ntheme_set(new = theme_custom())\n#\n# Calculate exact mean\nobs_mean_grade <- mean(~course_grade, data = exam_grades)\nbelief <- 80\nobs_grade_diff <- belief - obs_mean_grade\n## Steps in a Permutation Test\n## Repeatedly Shuffle polarities of data observations\n## Take means\n## Compare all means with the real-world observed one\nnull_dist_grade <-\n  mosaic::do(4999) *\n    mean(\n      ~ (course_grade - belief) *\n        sample(c(-1, 1), # +/- 1s multiply y\n          length(course_grade), # How many +/- 1s?\n          replace = T\n        ), # select with replacement\n      data = exam_grades\n    )\n\n## Plot this NULL distribution\ngf_histogram(\n  ~mean,\n  data = null_dist_grade,\n  fill = ~ (mean >= obs_grade_diff),\n  bins = 50,\n  title = \"Distribution of Permuted Difference-Means under Null Hypothesis\",\n  subtitle = \"Why is the mean of the means zero??\"\n) %>%\n  gf_labs(\n    x = \"Calculated Random Means\",\n    y = \"How Often do these occur?\"\n  ) %>%\n  gf_vline(xintercept = obs_grade_diff, colour = \"red\") %>%\n  gf_vline(xintercept = -obs_grade_diff, colour = \"red\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/permutation-test-2-1.png){width=2100}\n:::\n\n```{.r .cell-code}\n# p-value\n# Permutation distributions are always centered around zero. Why?\nprop(~ mean >= obs_grade_diff,\n  data = null_dist_grade\n) +\n  prop(~ mean <= -obs_grade_diff,\n    data = null_dist_grade\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nprop_TRUE \n        0 \n```\n\n\n:::\n:::\n\n\nAnd let us now do the bootstrap test:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnull_grade_bs <- mosaic::do(4999) *\n  mean(\n    ~ sample(course_grade,\n      replace = T\n    ), # select with replacement\n    data = exam_grades\n  )\n\n## Plot this NULL distribution\ngf_histogram(\n  ~mean,\n  data = null_grade_bs,\n  fill = ~ (mean >= obs_grade_diff),\n  bins = 50,\n  title = \"Distribution of Bootstrap Means\"\n) %>%\n  gf_labs(\n    x = \"Calculated Random Means\",\n    y = \"How Often do these occur?\"\n  ) %>%\n  gf_vline(xintercept = ~belief, colour = \"red\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/bootstrap-test-2-1.png){width=2100}\n:::\n\n```{.r .cell-code}\nprop(~ mean >= belief,\n  data = null_grade_bs\n) +\n  prop(~ mean <= -belief,\n    data = null_grade_bs\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nprop_TRUE \n        0 \n```\n\n\n:::\n:::\n\n\nThe permutation test shows that we are not able to \"generate\" the *believed* mean-difference with any of the permutations. Likewise with the bootstrap, we are not able to hit the believed mean with any of the bootstrap samples. \n\nHence there is no reason to believe that the belief (80) might be a reasonable one and we reject our NULL Hypothesis that the mean is equal to 80. \n\n\n:::\n\n## {{< iconify openmoji flat-color-icons workflow >}} Workflow for Inference for a Single Mean\n\nA series of tests deal with one mean value of a sample. The idea is to\nevaluate whether that mean is representative of the mean of the\nunderlying population. Depending upon the nature of the (single)\nvariable, the test that can be used are as follows:\n\n```{mermaid}\n%%| echo: false\nflowchart TD\n    A[Inference for Single Mean] -->|Check Assumptions| B[Normality: Shapiro-Wilk Test shapiro.test\\n or\\n Anderson-Darling Test]\n    B --> C{OK?}\n    C -->|Yes\\n Parametric| D[t.test]\n    C -->|No\\n Non-Parametric| E[wilcox.test]\n    E <--> G[t.test\\n with\\n Signed-Ranks of Data]\n    C -->|No\\n Non-Parametric| P[Bootstrap]\n    C -->|No\\n Non-Parametric| Q[Permutation]\n \n```\n\n## {{< iconify mingcute thought-line >}} Wait, But Why?\n\n - We can only sample from a population, and calculate sample statistics\n - But we still want to know about *population parameters*\n - All our tests and measures of uncertainty with samples are aimed at obtaining a confident measure of a population parameter. \n - Means are the first on the list!\n\n\n\n## {{< iconify fluent-mdl2 decision-solid >}} Conclusion\n\n- If samples are normally distributed, we use a t.test.\n- Else we try *non-parametric* tests such as the Wilcoxon test.\n- Since we now have compute power at our fingertips, we can leave off considerations of normality and simply proceed with either a permutation or a boostrap test. \n\n## {{< iconify ooui references-rtl >}} References {#sec-references}\n\n1. OpenIntro Modern Statistics, [Chapter #17](https://openintro-ims.netlify.app/inference-one-prop.html)\n1. Bootstrap based Inference using the `infer` package: <https://infer.netlify.app/articles/t_test>\n1. Michael Clark & Seth Berry. *Models Demystified: A Practical Guide from t-tests to Deep Learning*. <https://m-clark.github.io/book-of-models/>\n1. University of Warwickshire. *SAMPLING: Searching for the Approximation Method use to Perform rational inference by Individuals and Groups*. <https://sampling.warwick.ac.uk/#Overview>\n\n\n## {{< iconify streamline book-reading >}} Additional Readings\n\n1. <https://mine-cetinkaya-rundel.github.io/quarto-tip-a-day/posts/21-diagrams/>\n\n\n::: {#refs style=\"font-size: 60%;\"}\n###### {{< iconify lucide package-check >}} R Package Citations\n\n::: {.cell}\n::: {.cell-output-display}\n\n\nPackage         Version   Citation       \n--------------  --------  ---------------\nexplore         1.3.5     @explore       \ninfer           1.0.9     @infer         \nopenintro       2.5.0     @openintro     \nresampledata    0.3.2     @resampledata  \nTeachHist       0.2.1     @TeachHist     \nTeachingDemos   2.13      @TeachingDemos \n\n\n:::\n:::\n\n\n\n:::\n\n\n[^1]: <https://allendowney.blogspot.com/2016/06/there-is-still-only-one-test.html>\n\n[^2]: <https://stats.stackexchange.com/q/171748> \n\n[^3]: <https://www.r-bloggers.com/2021/11/anderson-darling-test-in-r-quick-normality-check/>\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../../../../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../../../../../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}