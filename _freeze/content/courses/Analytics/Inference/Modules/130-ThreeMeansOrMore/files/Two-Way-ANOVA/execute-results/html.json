{
  "hash": "964dd434a8fea33fcaf21e91b008e948",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Different Types of ANOVA\"\ndate: 27/Dec/2023\ndate-modified: \"2025-07-17\"\ndraft: true\nbibliography: \n  - grateful-refs.bib\ncitation: true\neditor: \n  markdown: \n    wrap: 72\n---\n\n## {{< iconify noto-v1 package >}} Setting up R Packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::opts_chunk$set(tidy = TRUE)\n\nlibrary(ggformula) # Formula based plots\nlibrary(mosaic) # Data inspection and Statistical Inference\nlibrary(broom) # Tidy outputs from Statistical Analyses\nlibrary(infer) # Statistical Inference\nlibrary(supernova) # ANOVA Tables\n\nlibrary(multcomp)\nlibrary(marginaleffects)\nlibrary(gplots)\n\n# Plots\nlibrary(ggprism)\nlibrary(cowplot) # Arranging Plots\nlibrary(patchwork) # Arranging Plots\nlibrary(plotly) # 3D plots, should we need them\n\nlibrary(tidyverse) # Tidy data processing\n```\n:::\n\n\n\n::: {.cell}\n\n:::\n\n\n\n#### Plot Fonts and Theme\n\n\n::: {.cell messages='false'}\n\n````{.cell-code  code-fold=\"true\"}\n```{{r}}\n#| label: plot-theme\n#| code-fold: true\n#| messages: false\n#| warning: false\n\nlibrary(sysfonts)\nlibrary(showtext)\nfont_add(family = \"Alegreya\", regular = \"../../../../gfonts/fonts/Alegreya/Alegreya-Regular.ttf\")\nfont_add(family = \"Roboto Condensed\", regular = \"../../../../gfonts/fonts/RobotoCondensed-Regular.ttf\")\nshowtext_auto(enable = TRUE) #enable showtext\n##\ntheme_custom <- function(){ \n    font <- \"Alegreya\"   #assign font family up front\n    \n    theme_classic(base_size = 14) %+replace%    #replace elements we want to change\n    \n    theme(\n      text = element_text(family = font),  #set base font family\n      \n      #text elements\n      plot.title = element_text(                 #title\n                   family = \"Alegreya\",          #set font family\n                   size = 18,                    #set font size\n                   face = 'bold',                #bold typeface\n                   hjust = 0,                    #left align\n                   margin = margin(t = 5, r = 0, b = 5, l = 0)), #margin\n      plot.title.position = \"plot\", \n      \n      plot.subtitle = element_text(              #subtitle\n                   family = \"Alegreya\",          #font family\n                   size = 14,                   #font size\n                   hjust = 0,                   #left align\n                   margin = margin(t = 5, r = 0, b = 10, l = 0)), #margin\n      \n      plot.caption = element_text(               #caption\n                   family = \"Alegreya\",          #font family\n                   size = 9,                     #font size\n                   hjust = 1),                   #right align\n      \n      plot.caption.position = \"plot\",            #right align\n      \n      axis.title = element_text(                 #axis titles\n                   family = \"Roboto Condensed\",  #font family\n                   size = 12),                   #font size\n      \n      axis.text = element_text(                  #axis text\n                   family = \"Roboto Condensed\",  #font family\n                   size = 9),                    #font size\n      \n      axis.text.x = element_text(                #margin for axis text\n                    margin = margin(5, b = 10))\n      \n      #since the legend often requires manual tweaking \n      #based on plot content, don't define it here\n    )\n}\n```\n````\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n## Use available fonts in ggplot text geoms too!\nupdate_geom_defaults(geom = \"text\", new = list(family = \"Roboto Condensed\", face = \"plain\",\n    size = 3.5, color = \"#2b2b2b\"))\n\n## Set the theme\ntheme_set(new = theme_custom())\n```\n:::\n\n\n\n\n\n## {{< iconify openmoji japanese-symbol-for-beginner >}} Introduction\n\nWhat we have seen up to now is an ANOVA model where we had a single\nQuantitative target variable, and one Qualitative independent variable,\nwhat we call \"one-way ANOVA\".\n\nIn **two-way ANOVA**, subjects are randomly assigned to groups formed by\nthe cross-combination of *two factors*, and differences (in means) are\ncalculated *between groups*. If the *same subjects* are used to perform\nobservations over levels of the Qualitative independent variable, we\nhave **repeated measures ANOVA**, where differences are calculated\n*within groups*. Models with both between-groups and within-groups\nfactors are called *mixed models*.\n\nSometimes there is an additional independent **Quantitative** variable\n(a \"covariate\") that varies across the groups of the **Qualitative**\nvariable, which leads to an **Analysis of Covariance (ANCOVA)** model.\nWith **multiple ANOVA (MANOVA)**, we are trying to deal with more than\none **target** Quantitative variable. And if we again have a\nQuantitative covariate, then we perform a MANCOVA analysis.\n\n## {{< iconify pajamas issue-type-test-case >}} Two-Way Factorial ANOVA: ToothGrowth\n\nSixty guinea pigs are randomly assigned to receive one of three levels\nof *ascorbic acid* (0.5, 1, or 2 mg) via one of two delivery\nmethods(orange juice or vitamin C); this gives us 6 *cells* of\nobservations.\n\nHere we have two factors (dose and delivery method), and each cell of\nobservations is separate. Hence this is a **between groups two-way ANOVA**. Since each cell has the same number of observations, the design is also **balanced**.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nToothGrowth\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"len\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"supp\"],\"name\":[2],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"dose\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"4.2\",\"2\":\"VC\",\"3\":\"0.5\"},{\"1\":\"11.5\",\"2\":\"VC\",\"3\":\"0.5\"},{\"1\":\"7.3\",\"2\":\"VC\",\"3\":\"0.5\"},{\"1\":\"5.8\",\"2\":\"VC\",\"3\":\"0.5\"},{\"1\":\"6.4\",\"2\":\"VC\",\"3\":\"0.5\"},{\"1\":\"10.0\",\"2\":\"VC\",\"3\":\"0.5\"},{\"1\":\"11.2\",\"2\":\"VC\",\"3\":\"0.5\"},{\"1\":\"11.2\",\"2\":\"VC\",\"3\":\"0.5\"},{\"1\":\"5.2\",\"2\":\"VC\",\"3\":\"0.5\"},{\"1\":\"7.0\",\"2\":\"VC\",\"3\":\"0.5\"},{\"1\":\"16.5\",\"2\":\"VC\",\"3\":\"1.0\"},{\"1\":\"16.5\",\"2\":\"VC\",\"3\":\"1.0\"},{\"1\":\"15.2\",\"2\":\"VC\",\"3\":\"1.0\"},{\"1\":\"17.3\",\"2\":\"VC\",\"3\":\"1.0\"},{\"1\":\"22.5\",\"2\":\"VC\",\"3\":\"1.0\"},{\"1\":\"17.3\",\"2\":\"VC\",\"3\":\"1.0\"},{\"1\":\"13.6\",\"2\":\"VC\",\"3\":\"1.0\"},{\"1\":\"14.5\",\"2\":\"VC\",\"3\":\"1.0\"},{\"1\":\"18.8\",\"2\":\"VC\",\"3\":\"1.0\"},{\"1\":\"15.5\",\"2\":\"VC\",\"3\":\"1.0\"},{\"1\":\"23.6\",\"2\":\"VC\",\"3\":\"2.0\"},{\"1\":\"18.5\",\"2\":\"VC\",\"3\":\"2.0\"},{\"1\":\"33.9\",\"2\":\"VC\",\"3\":\"2.0\"},{\"1\":\"25.5\",\"2\":\"VC\",\"3\":\"2.0\"},{\"1\":\"26.4\",\"2\":\"VC\",\"3\":\"2.0\"},{\"1\":\"32.5\",\"2\":\"VC\",\"3\":\"2.0\"},{\"1\":\"26.7\",\"2\":\"VC\",\"3\":\"2.0\"},{\"1\":\"21.5\",\"2\":\"VC\",\"3\":\"2.0\"},{\"1\":\"23.3\",\"2\":\"VC\",\"3\":\"2.0\"},{\"1\":\"29.5\",\"2\":\"VC\",\"3\":\"2.0\"},{\"1\":\"15.2\",\"2\":\"OJ\",\"3\":\"0.5\"},{\"1\":\"21.5\",\"2\":\"OJ\",\"3\":\"0.5\"},{\"1\":\"17.6\",\"2\":\"OJ\",\"3\":\"0.5\"},{\"1\":\"9.7\",\"2\":\"OJ\",\"3\":\"0.5\"},{\"1\":\"14.5\",\"2\":\"OJ\",\"3\":\"0.5\"},{\"1\":\"10.0\",\"2\":\"OJ\",\"3\":\"0.5\"},{\"1\":\"8.2\",\"2\":\"OJ\",\"3\":\"0.5\"},{\"1\":\"9.4\",\"2\":\"OJ\",\"3\":\"0.5\"},{\"1\":\"16.5\",\"2\":\"OJ\",\"3\":\"0.5\"},{\"1\":\"9.7\",\"2\":\"OJ\",\"3\":\"0.5\"},{\"1\":\"19.7\",\"2\":\"OJ\",\"3\":\"1.0\"},{\"1\":\"23.3\",\"2\":\"OJ\",\"3\":\"1.0\"},{\"1\":\"23.6\",\"2\":\"OJ\",\"3\":\"1.0\"},{\"1\":\"26.4\",\"2\":\"OJ\",\"3\":\"1.0\"},{\"1\":\"20.0\",\"2\":\"OJ\",\"3\":\"1.0\"},{\"1\":\"25.2\",\"2\":\"OJ\",\"3\":\"1.0\"},{\"1\":\"25.8\",\"2\":\"OJ\",\"3\":\"1.0\"},{\"1\":\"21.2\",\"2\":\"OJ\",\"3\":\"1.0\"},{\"1\":\"14.5\",\"2\":\"OJ\",\"3\":\"1.0\"},{\"1\":\"27.3\",\"2\":\"OJ\",\"3\":\"1.0\"},{\"1\":\"25.5\",\"2\":\"OJ\",\"3\":\"2.0\"},{\"1\":\"26.4\",\"2\":\"OJ\",\"3\":\"2.0\"},{\"1\":\"22.4\",\"2\":\"OJ\",\"3\":\"2.0\"},{\"1\":\"24.5\",\"2\":\"OJ\",\"3\":\"2.0\"},{\"1\":\"24.8\",\"2\":\"OJ\",\"3\":\"2.0\"},{\"1\":\"30.9\",\"2\":\"OJ\",\"3\":\"2.0\"},{\"1\":\"26.4\",\"2\":\"OJ\",\"3\":\"2.0\"},{\"1\":\"27.3\",\"2\":\"OJ\",\"3\":\"2.0\"},{\"1\":\"29.4\",\"2\":\"OJ\",\"3\":\"2.0\"},{\"1\":\"23.0\",\"2\":\"OJ\",\"3\":\"2.0\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nToothGrowth <- ToothGrowth %>%\n    mutate(dose = as_factor(dose))\n\nplot_ly(ToothGrowth, x = ~supp, y = ~dose, z = ~len, color = ~supp, colors = c(\"#BF382A\",\n    \"#0C4B8E\")) %>%\n    add_markers()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-d205c5987c8c07b5fdb8\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-d205c5987c8c07b5fdb8\">{\"x\":{\"visdat\":{\"f80e33449f34\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"f80e33449f34\",\"attrs\":{\"f80e33449f34\":{\"x\":{},\"y\":{},\"z\":{},\"color\":{},\"colors\":[\"#BF382A\",\"#0C4B8E\"],\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"scatter3d\",\"mode\":\"markers\",\"inherit\":true}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"scene\":{\"xaxis\":{\"title\":\"supp\"},\"yaxis\":{\"title\":\"dose\"},\"zaxis\":{\"title\":\"len\"}},\"xaxis\":{\"type\":\"category\",\"categoryorder\":\"array\",\"categoryarray\":[\"OJ\",\"VC\"]},\"yaxis\":{\"type\":\"category\",\"categoryorder\":\"array\",\"categoryarray\":[\"0.5\",\"1\",\"2\"]},\"hovermode\":\"closest\",\"showlegend\":true},\"source\":\"A\",\"config\":{\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"data\":[{\"x\":[\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\"],\"y\":[\"0.5\",\"0.5\",\"0.5\",\"0.5\",\"0.5\",\"0.5\",\"0.5\",\"0.5\",\"0.5\",\"0.5\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\"],\"z\":[15.199999999999999,21.5,17.600000000000001,9.6999999999999993,14.5,10,8.1999999999999993,9.4000000000000004,16.5,9.6999999999999993,19.699999999999999,23.300000000000001,23.600000000000001,26.399999999999999,20,25.199999999999999,25.800000000000001,21.199999999999999,14.5,27.300000000000001,25.5,26.399999999999999,22.399999999999999,24.5,24.800000000000001,30.899999999999999,26.399999999999999,27.300000000000001,29.399999999999999,23],\"type\":\"scatter3d\",\"mode\":\"markers\",\"name\":\"OJ\",\"marker\":{\"color\":\"rgba(191,56,42,1)\",\"line\":{\"color\":\"rgba(191,56,42,1)\"}},\"textfont\":{\"color\":\"rgba(191,56,42,1)\"},\"error_y\":{\"color\":\"rgba(191,56,42,1)\"},\"error_x\":{\"color\":\"rgba(191,56,42,1)\"},\"line\":{\"color\":\"rgba(191,56,42,1)\"},\"frame\":null},{\"x\":[\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\"],\"y\":[\"0.5\",\"0.5\",\"0.5\",\"0.5\",\"0.5\",\"0.5\",\"0.5\",\"0.5\",\"0.5\",\"0.5\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\"],\"z\":[4.2000000000000002,11.5,7.2999999999999998,5.7999999999999998,6.4000000000000004,10,11.199999999999999,11.199999999999999,5.2000000000000002,7,16.5,16.5,15.199999999999999,17.300000000000001,22.5,17.300000000000001,13.6,14.5,18.800000000000001,15.5,23.600000000000001,18.5,33.899999999999999,25.5,26.399999999999999,32.5,26.699999999999999,21.5,23.300000000000001,29.5],\"type\":\"scatter3d\",\"mode\":\"markers\",\"name\":\"VC\",\"marker\":{\"color\":\"rgba(12,75,142,1)\",\"line\":{\"color\":\"rgba(12,75,142,1)\"}},\"textfont\":{\"color\":\"rgba(12,75,142,1)\"},\"error_y\":{\"color\":\"rgba(12,75,142,1)\"},\"error_x\":{\"color\":\"rgba(12,75,142,1)\"},\"line\":{\"color\":\"rgba(12,75,142,1)\"},\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nToothGrowth %>%\n    group_by(supp, dose) %>%\n    summarise(mean = mean(len), sd = sd(len), n = n())\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"supp\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"dose\"],\"name\":[2],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"mean\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"sd\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"n\"],\"name\":[5],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"OJ\",\"2\":\"0.5\",\"3\":\"13.23\",\"4\":\"4.459709\",\"5\":\"10\"},{\"1\":\"OJ\",\"2\":\"1\",\"3\":\"22.70\",\"4\":\"3.910953\",\"5\":\"10\"},{\"1\":\"OJ\",\"2\":\"2\",\"3\":\"26.06\",\"4\":\"2.655058\",\"5\":\"10\"},{\"1\":\"VC\",\"2\":\"0.5\",\"3\":\"7.98\",\"4\":\"2.746634\",\"5\":\"10\"},{\"1\":\"VC\",\"2\":\"1\",\"3\":\"16.77\",\"4\":\"2.515309\",\"5\":\"10\"},{\"1\":\"VC\",\"2\":\"2\",\"3\":\"26.14\",\"4\":\"4.797731\",\"5\":\"10\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nThere seem to be large differences in the *means* across the 6\n*balanced* groupings / cells. We can quickly see this as a heatmap:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nToothGrowth %>% \n  mutate(dose = as_factor(dose)) %>% # supp is already a factor\n  group_by(supp, dose) %>% \n  summarise(mean = mean(len), sd = sd(len), n = n(),\n            .groups = \"drop\") %>% \n  dplyr::select(supp, dose, mean, sd) %>%\n  #\n  gf_tile(supp ~ dose, fill =  ~ mean, # try changing \"mean\" to \"sd\"\n          color = \"black\",data = .) %>% \n  gf_text(label = ~ mean, color = \"white\", size = 6) %>% \n  #\n  gf_refine(scale_fill_viridis_c()) %>%\n  gf_labs(title = \"Mean Tooth Length across Factor Combinations\") %>% \n  gf_refine(scale_x_discrete(guide = \"prism_bracket\"),\n            scale_y_discrete(guide = \"prism_bracket\")) %>% \n  gf_theme(ggprism::theme_prism())\n```\n\n::: {.cell-output-display}\n![](Two-Way-ANOVA_files/figure-html/unnamed-chunk-4-1.png){width=2100}\n:::\n:::\n\n\n\nLet us build the two-way model:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntg_anova <- aov(len ~ supp * dose, data = ToothGrowth)\ntg_anova %>%\n    broom::tidy()  # Type I Table!!\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"term\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"df\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"sumsq\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"meansq\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"statistic\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p.value\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"supp\",\"2\":\"1\",\"3\":\"205.350\",\"4\":\"205.35000\",\"5\":\"15.571979\",\"6\":\"2.311828e-04\"},{\"1\":\"dose\",\"2\":\"2\",\"3\":\"2426.434\",\"4\":\"1213.21717\",\"5\":\"91.999965\",\"6\":\"4.046291e-18\"},{\"1\":\"supp:dose\",\"2\":\"2\",\"3\":\"108.319\",\"4\":\"54.15950\",\"5\":\"4.106991\",\"6\":\"2.186027e-02\"},{\"1\":\"Residuals\",\"2\":\"54\",\"3\":\"712.106\",\"4\":\"13.18715\",\"5\":\"NA\",\"6\":\"NA\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nsummary(tg_anova)  # Type I Table\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            Df Sum Sq Mean Sq F value   Pr(>F)    \nsupp         1  205.4   205.4  15.572 0.000231 ***\ndose         2 2426.4  1213.2  92.000  < 2e-16 ***\nsupp:dose    2  108.3    54.2   4.107 0.021860 *  \nResiduals   54  712.1    13.2                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntg_anova %>%\n    supernova::supernova()  # Type III Table!!\n# tg_anova %>% supernova::supernova(type = 'I') # Try this\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n Analysis of Variance Table (Type III SS)\n Model: len ~ supp * dose\n\n                                   SS df      MS      F   PRE     p\n --------- --------------- | -------- -- ------- ------ ----- -----\n     Model (error reduced) | 2740.103  5 548.021 41.557 .7937 .0000\n      supp                 |  137.813  1 137.813 10.451 .1621 .0021\n      dose                 |  885.265  2 442.632 33.565 .5542 .0000\n supp:dose                 |  108.319  2  54.160  4.107 .1320 .0219\n     Error (from model)    |  712.106 54  13.187                   \n --------- --------------- | -------- -- ------- ------ ----- -----\n     Total (empty model)   | 3452.209 59  58.512                   \n```\n\n\n:::\n:::\n\n\nThere are significant main effects for both `supp` and `dose`, as also a significant interaction effect for `supp:dose`.\n\n::: callout-note\n### Types of ANOVA Analyses and Tables\n\nNote how `supernova()` renders a Type III ANOVA table by default. Both\n`broom::tidy()` and `summary()` render Type I tables.\n\nFrom *R in Action* by Robert Kabacoff:\n\nConsider an unbalanced two-way factorial design with factors A and B and\ndependent variable y. There are three effects in this design: the A and\nB main effects and the A × B interaction. Assuming that you’re modeling\nthe data using the formula $Y\\sim A + B + A:B$ there are three typical\napproaches for partitioning the variance in Y among the effects on the\nright side of this equation.\n\n-   **Type I (sequential)** Effects are adjusted for those that appear\n    earlier in the formula. A is unadjusted. B is adjusted for the A,\n    i.e. the effect of B is calculated after removing that of A.\n    The A:B interaction is adjusted for A and B.\n\n-   **Type II (hierarchical)** Effects are adjusted for other effects at\n    the same or lower level. A is adjusted for B. B is adjusted for A.\n    The A:B interaction is adjusted for both A and B.\n\n-   **Type III (marginal)** Each effect is adjusted for every other\n    effect in the model. A is adjusted for B and A:B. B is adjusted for\n    A and A:B. The A:B interaction is adjusted for A and B.\n\n[***R employs the Type I approach by default.***]{.black .bg-gold}\n    \n:::\n\n### Effect Sizes\n::: {.panel-tabset .nav-pills style=\"background: whitesmoke;\"}\n\n#### Using base R\n\nAs before, we use `summary.lm()` to get an idea of the effect sizes \nfor each of the predictors and their interactions:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntg_anova_tidy <- tg_anova %>%\n    summary.lm() %>%\n    broom::tidy()\ntg_anova_tidy\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"term\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"estimate\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"std.error\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"statistic\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p.value\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"(Intercept)\",\"2\":\"13.23\",\"3\":\"1.148353\",\"4\":\"11.5208468\",\"5\":\"3.602548e-16\"},{\"1\":\"suppVC\",\"2\":\"-5.25\",\"3\":\"1.624017\",\"4\":\"-3.2327258\",\"5\":\"2.092470e-03\"},{\"1\":\"dose1\",\"2\":\"9.47\",\"3\":\"1.624017\",\"4\":\"5.8312215\",\"5\":\"3.175641e-07\"},{\"1\":\"dose2\",\"2\":\"12.83\",\"3\":\"1.624017\",\"4\":\"7.9001660\",\"5\":\"1.429712e-10\"},{\"1\":\"suppVC:dose1\",\"2\":\"-0.68\",\"3\":\"2.296706\",\"4\":\"-0.2960762\",\"5\":\"7.683076e-01\"},{\"1\":\"suppVC:dose2\",\"2\":\"5.33\",\"3\":\"2.296706\",\"4\":\"2.3207148\",\"5\":\"2.410826e-02\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n## Plotting\ntg_anova_tidy %>%\n    gf_col(estimate ~ term, fill = \"grey\", color = \"black\", title = \"Tooth Growth Two-Way ANOVA\\nEffect Sizes\") %>%\n    gf_errorbar((estimate + std.error) + (estimate - std.error) ~ term, width = 0.25) %>%\n    gf_text(estimate * 1.05 ~ term, hjust = 1.1, label = ~round(estimate, 2), size = 3) %>%\n    gf_hline(yintercept = 0, linewidth = 2, colour = \"grey40\") %>%\n    gf_refine(scale_x_discrete(guide = \"prism_bracket\")) %>%\n    gf_theme(ggprism::theme_prism(base_size = 10))\n```\n\n::: {.cell-output-display}\n![](Two-Way-ANOVA_files/figure-html/unnamed-chunk-6-1.png){width=2100}\n:::\n:::\n\n\nAs before, the `(Intercept)` term is to be interpreted as the effect \nsize for the **two factors** being set to their *first* levels \nalphabetically. So `supp = OJ` and `dose = 0.5 mg`. All the estimates \nare **differences** from this number, and hence the `std.error` is \nhigher. `dose1` and `dose2` are *main effects*. For interaction terms, \nsince *two* factors are involved, the `std.error` is higher still. \n\nWe see that the effect size for `VC:dose1` is not significant since the confidence interval straddles $0$. (p > 0.05)\n\n#### Using ggeffects\n\n::: {.cell}\n\n```{.r .cell-code}\ntg_effects <- tg_anova %>%\n    ggeffects::ggeffect(terms = c(\"dose\", \"supp\"), ci_level = 0.95) %>%\n    as_tibble()\ntg_effects\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"x\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"predicted\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"std.error\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"conf.low\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"conf.high\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"group\"],\"name\":[6],\"type\":[\"fct\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"0.5\",\"2\":\"13.23\",\"3\":\"1.148353\",\"4\":\"10.927691\",\"5\":\"15.53231\",\"6\":\"OJ\"},{\"1\":\"1\",\"2\":\"22.70\",\"3\":\"1.148353\",\"4\":\"20.397691\",\"5\":\"25.00231\",\"6\":\"OJ\"},{\"1\":\"2\",\"2\":\"26.06\",\"3\":\"1.148353\",\"4\":\"23.757691\",\"5\":\"28.36231\",\"6\":\"OJ\"},{\"1\":\"0.5\",\"2\":\"7.98\",\"3\":\"1.148353\",\"4\":\"5.677691\",\"5\":\"10.28231\",\"6\":\"VC\"},{\"1\":\"1\",\"2\":\"16.77\",\"3\":\"1.148353\",\"4\":\"14.467691\",\"5\":\"19.07231\",\"6\":\"VC\"},{\"1\":\"2\",\"2\":\"26.14\",\"3\":\"1.148353\",\"4\":\"23.837691\",\"5\":\"28.44231\",\"6\":\"VC\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n## Plot with ggformula\ntg_effects %>%\n    gf_errorbar(conf.low + conf.high ~ x, colour = ~group, group = ~group, width = 0.25) %>%\n    gf_line(predicted ~ x) %>%\n    gf_point(predicted ~ x, xlab = \"dosage in mm\", ylab = \"Predicted Tooth Length\",\n        title = \"Using ggeffects\") %>%\n    gf_refine(scale_x_discrete(guide = \"prism_bracket\")) %>%\n    gf_theme(ggprism::theme_prism())\n```\n\n::: {.cell-output-display}\n![](Two-Way-ANOVA_files/figure-html/Using-ggeffects-1.png){width=2100}\n:::\n:::\n\n\n#### Using marginaleffects\n\n::: {.cell}\n\n```{.r .cell-code}\ntg_marg_effects <- marginaleffects::avg_comparisons(tg_anova, variables = c(\"dose\",\n    \"supp\"))\ntg_marg_effects\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n Term Contrast Estimate Std. Error     z Pr(>|z|)     S 2.5 % 97.5 %\n dose  1 - 0.5     9.13      1.148  7.95   <0.001  48.9  6.88  11.38\n dose  2 - 0.5    15.50      1.148 13.49   <0.001 135.4 13.24  17.75\n supp  VC - OJ    -3.70      0.938 -3.95   <0.001  13.6 -5.54  -1.86\n\nType: response\n```\n\n\n:::\n\n```{.r .cell-code}\nmarginaleffects::plot_predictions(tg_anova, by = c(\"dose\", \"supp\")) + scale_x_discrete(guide = \"prism_bracket\") +\n    theme_prism()\n```\n\n::: {.cell-output-display}\n![](Two-Way-ANOVA_files/figure-html/Using-marginaleffects-1.png){width=2100}\n:::\n:::\n\n\n:::\n\nWe can finally do a Japanese-lantern-like 3-D interactive plot with the predicted means and confidence intervals (not yet):\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntg_effects\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"x\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"predicted\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"std.error\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"conf.low\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"conf.high\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"group\"],\"name\":[6],\"type\":[\"fct\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"0.5\",\"2\":\"13.23\",\"3\":\"1.148353\",\"4\":\"10.927691\",\"5\":\"15.53231\",\"6\":\"OJ\"},{\"1\":\"1\",\"2\":\"22.70\",\"3\":\"1.148353\",\"4\":\"20.397691\",\"5\":\"25.00231\",\"6\":\"OJ\"},{\"1\":\"2\",\"2\":\"26.06\",\"3\":\"1.148353\",\"4\":\"23.757691\",\"5\":\"28.36231\",\"6\":\"OJ\"},{\"1\":\"0.5\",\"2\":\"7.98\",\"3\":\"1.148353\",\"4\":\"5.677691\",\"5\":\"10.28231\",\"6\":\"VC\"},{\"1\":\"1\",\"2\":\"16.77\",\"3\":\"1.148353\",\"4\":\"14.467691\",\"5\":\"19.07231\",\"6\":\"VC\"},{\"1\":\"2\",\"2\":\"26.14\",\"3\":\"1.148353\",\"4\":\"23.837691\",\"5\":\"28.44231\",\"6\":\"VC\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n##\nplot_ly(ToothGrowth, x = ~supp, y = ~dose, z = ~len, color = ~supp, colors = c(\"#BF382A\",\n    \"#0C4B8E\")) %>%\n    add_markers() %>%\n    add_markers(data = tg_effects, x = ~x, y = ~group, z = ~predicted, color = ~group,\n        colors = c(\"#BF382A\", \"#0C4B8E\"))\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-57820fec136c031e33f9\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-57820fec136c031e33f9\">{\"x\":{\"visdat\":{\"f80e102576a3\":[\"function () \",\"plotlyVisDat\"],\"f80eb8fcf9d\":[\"function () \",\"data\"]},\"cur_data\":\"f80eb8fcf9d\",\"attrs\":{\"f80e102576a3\":{\"x\":{},\"y\":{},\"z\":{},\"color\":{},\"colors\":[\"#BF382A\",\"#0C4B8E\"],\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"scatter3d\",\"mode\":\"markers\",\"inherit\":true},\"f80eb8fcf9d\":{\"x\":{},\"y\":{},\"z\":{},\"color\":{},\"colors\":[\"#BF382A\",\"#0C4B8E\"],\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"scatter3d\",\"mode\":\"markers\",\"inherit\":true}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"scene\":{\"xaxis\":{\"title\":\"supp\"},\"yaxis\":{\"title\":\"dose\"},\"zaxis\":{\"title\":\"len\"}},\"xaxis\":{\"type\":\"category\",\"categoryorder\":\"array\",\"categoryarray\":[\"OJ\",\"VC\",\"0.5\",\"1\",\"2\"]},\"yaxis\":{\"type\":\"category\",\"categoryorder\":\"array\",\"categoryarray\":[\"0.5\",\"1\",\"2\",\"OJ\",\"VC\"]},\"hovermode\":\"closest\",\"showlegend\":true},\"source\":\"A\",\"config\":{\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"data\":[{\"x\":[\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\",\"OJ\"],\"y\":[\"0.5\",\"0.5\",\"0.5\",\"0.5\",\"0.5\",\"0.5\",\"0.5\",\"0.5\",\"0.5\",\"0.5\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\"],\"z\":[15.199999999999999,21.5,17.600000000000001,9.6999999999999993,14.5,10,8.1999999999999993,9.4000000000000004,16.5,9.6999999999999993,19.699999999999999,23.300000000000001,23.600000000000001,26.399999999999999,20,25.199999999999999,25.800000000000001,21.199999999999999,14.5,27.300000000000001,25.5,26.399999999999999,22.399999999999999,24.5,24.800000000000001,30.899999999999999,26.399999999999999,27.300000000000001,29.399999999999999,23],\"type\":\"scatter3d\",\"mode\":\"markers\",\"name\":\"OJ\",\"marker\":{\"color\":\"rgba(191,56,42,1)\",\"line\":{\"color\":\"rgba(191,56,42,1)\"}},\"textfont\":{\"color\":\"rgba(191,56,42,1)\"},\"error_y\":{\"color\":\"rgba(191,56,42,1)\"},\"error_x\":{\"color\":\"rgba(191,56,42,1)\"},\"line\":{\"color\":\"rgba(191,56,42,1)\"},\"frame\":null},{\"x\":[\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\",\"VC\"],\"y\":[\"0.5\",\"0.5\",\"0.5\",\"0.5\",\"0.5\",\"0.5\",\"0.5\",\"0.5\",\"0.5\",\"0.5\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\"],\"z\":[4.2000000000000002,11.5,7.2999999999999998,5.7999999999999998,6.4000000000000004,10,11.199999999999999,11.199999999999999,5.2000000000000002,7,16.5,16.5,15.199999999999999,17.300000000000001,22.5,17.300000000000001,13.6,14.5,18.800000000000001,15.5,23.600000000000001,18.5,33.899999999999999,25.5,26.399999999999999,32.5,26.699999999999999,21.5,23.300000000000001,29.5],\"type\":\"scatter3d\",\"mode\":\"markers\",\"name\":\"VC\",\"marker\":{\"color\":\"rgba(12,75,142,1)\",\"line\":{\"color\":\"rgba(12,75,142,1)\"}},\"textfont\":{\"color\":\"rgba(12,75,142,1)\"},\"error_y\":{\"color\":\"rgba(12,75,142,1)\"},\"error_x\":{\"color\":\"rgba(12,75,142,1)\"},\"line\":{\"color\":\"rgba(12,75,142,1)\"},\"frame\":null},{\"x\":[\"0.5\",\"1\",\"2\"],\"y\":[\"OJ\",\"OJ\",\"OJ\"],\"z\":[13.229999999999999,22.699999999999999,26.059999999999999],\"type\":\"scatter3d\",\"mode\":\"markers\",\"name\":\"OJ\",\"marker\":{\"color\":\"rgba(191,56,42,1)\",\"line\":{\"color\":\"rgba(191,56,42,1)\"}},\"textfont\":{\"color\":\"rgba(191,56,42,1)\"},\"error_y\":{\"color\":\"rgba(191,56,42,1)\"},\"error_x\":{\"color\":\"rgba(191,56,42,1)\"},\"line\":{\"color\":\"rgba(191,56,42,1)\"},\"frame\":null},{\"x\":[\"0.5\",\"1\",\"2\"],\"y\":[\"VC\",\"VC\",\"VC\"],\"z\":[7.9799999999999871,16.77,26.140000000000001],\"type\":\"scatter3d\",\"mode\":\"markers\",\"name\":\"VC\",\"marker\":{\"color\":\"rgba(12,75,142,1)\",\"line\":{\"color\":\"rgba(12,75,142,1)\"}},\"textfont\":{\"color\":\"rgba(12,75,142,1)\"},\"error_y\":{\"color\":\"rgba(12,75,142,1)\"},\"error_x\":{\"color\":\"rgba(12,75,142,1)\"},\"line\":{\"color\":\"rgba(12,75,142,1)\"},\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\nThere is a significant effect on tooth growth (`len`) of the delivery\nmethods: clearly the orange juice method promotes longer tooth growth \nat all values of `dose`. However, at $dose = 2mg$ the effect size for\norange juice and vitamin C are the same.\n\n### {{< iconify pajamas issue-type-test-case >}} Repeated Measures \nANOVA: CO2\n\nIn this situation, we have two factors: one *within-groups* due to\nrepeated measures on the **same population**, and another factor the\ndecides one or more levels of treatment. We will use the `CO2` data set \nfrom base R.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCO2\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Plant\"],\"name\":[1],\"type\":[\"ord\"],\"align\":[\"right\"]},{\"label\":[\"Type\"],\"name\":[2],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"Treatment\"],\"name\":[3],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"conc\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"uptake\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Qn1\",\"2\":\"Quebec\",\"3\":\"nonchilled\",\"4\":\"95\",\"5\":\"16.0\",\"_rn_\":\"1\"},{\"1\":\"Qn1\",\"2\":\"Quebec\",\"3\":\"nonchilled\",\"4\":\"175\",\"5\":\"30.4\",\"_rn_\":\"2\"},{\"1\":\"Qn1\",\"2\":\"Quebec\",\"3\":\"nonchilled\",\"4\":\"250\",\"5\":\"34.8\",\"_rn_\":\"3\"},{\"1\":\"Qn1\",\"2\":\"Quebec\",\"3\":\"nonchilled\",\"4\":\"350\",\"5\":\"37.2\",\"_rn_\":\"4\"},{\"1\":\"Qn1\",\"2\":\"Quebec\",\"3\":\"nonchilled\",\"4\":\"500\",\"5\":\"35.3\",\"_rn_\":\"5\"},{\"1\":\"Qn1\",\"2\":\"Quebec\",\"3\":\"nonchilled\",\"4\":\"675\",\"5\":\"39.2\",\"_rn_\":\"6\"},{\"1\":\"Qn1\",\"2\":\"Quebec\",\"3\":\"nonchilled\",\"4\":\"1000\",\"5\":\"39.7\",\"_rn_\":\"7\"},{\"1\":\"Qn2\",\"2\":\"Quebec\",\"3\":\"nonchilled\",\"4\":\"95\",\"5\":\"13.6\",\"_rn_\":\"8\"},{\"1\":\"Qn2\",\"2\":\"Quebec\",\"3\":\"nonchilled\",\"4\":\"175\",\"5\":\"27.3\",\"_rn_\":\"9\"},{\"1\":\"Qn2\",\"2\":\"Quebec\",\"3\":\"nonchilled\",\"4\":\"250\",\"5\":\"37.1\",\"_rn_\":\"10\"},{\"1\":\"Qn2\",\"2\":\"Quebec\",\"3\":\"nonchilled\",\"4\":\"350\",\"5\":\"41.8\",\"_rn_\":\"11\"},{\"1\":\"Qn2\",\"2\":\"Quebec\",\"3\":\"nonchilled\",\"4\":\"500\",\"5\":\"40.6\",\"_rn_\":\"12\"},{\"1\":\"Qn2\",\"2\":\"Quebec\",\"3\":\"nonchilled\",\"4\":\"675\",\"5\":\"41.4\",\"_rn_\":\"13\"},{\"1\":\"Qn2\",\"2\":\"Quebec\",\"3\":\"nonchilled\",\"4\":\"1000\",\"5\":\"44.3\",\"_rn_\":\"14\"},{\"1\":\"Qn3\",\"2\":\"Quebec\",\"3\":\"nonchilled\",\"4\":\"95\",\"5\":\"16.2\",\"_rn_\":\"15\"},{\"1\":\"Qn3\",\"2\":\"Quebec\",\"3\":\"nonchilled\",\"4\":\"175\",\"5\":\"32.4\",\"_rn_\":\"16\"},{\"1\":\"Qn3\",\"2\":\"Quebec\",\"3\":\"nonchilled\",\"4\":\"250\",\"5\":\"40.3\",\"_rn_\":\"17\"},{\"1\":\"Qn3\",\"2\":\"Quebec\",\"3\":\"nonchilled\",\"4\":\"350\",\"5\":\"42.1\",\"_rn_\":\"18\"},{\"1\":\"Qn3\",\"2\":\"Quebec\",\"3\":\"nonchilled\",\"4\":\"500\",\"5\":\"42.9\",\"_rn_\":\"19\"},{\"1\":\"Qn3\",\"2\":\"Quebec\",\"3\":\"nonchilled\",\"4\":\"675\",\"5\":\"43.9\",\"_rn_\":\"20\"},{\"1\":\"Qn3\",\"2\":\"Quebec\",\"3\":\"nonchilled\",\"4\":\"1000\",\"5\":\"45.5\",\"_rn_\":\"21\"},{\"1\":\"Qc1\",\"2\":\"Quebec\",\"3\":\"chilled\",\"4\":\"95\",\"5\":\"14.2\",\"_rn_\":\"22\"},{\"1\":\"Qc1\",\"2\":\"Quebec\",\"3\":\"chilled\",\"4\":\"175\",\"5\":\"24.1\",\"_rn_\":\"23\"},{\"1\":\"Qc1\",\"2\":\"Quebec\",\"3\":\"chilled\",\"4\":\"250\",\"5\":\"30.3\",\"_rn_\":\"24\"},{\"1\":\"Qc1\",\"2\":\"Quebec\",\"3\":\"chilled\",\"4\":\"350\",\"5\":\"34.6\",\"_rn_\":\"25\"},{\"1\":\"Qc1\",\"2\":\"Quebec\",\"3\":\"chilled\",\"4\":\"500\",\"5\":\"32.5\",\"_rn_\":\"26\"},{\"1\":\"Qc1\",\"2\":\"Quebec\",\"3\":\"chilled\",\"4\":\"675\",\"5\":\"35.4\",\"_rn_\":\"27\"},{\"1\":\"Qc1\",\"2\":\"Quebec\",\"3\":\"chilled\",\"4\":\"1000\",\"5\":\"38.7\",\"_rn_\":\"28\"},{\"1\":\"Qc2\",\"2\":\"Quebec\",\"3\":\"chilled\",\"4\":\"95\",\"5\":\"9.3\",\"_rn_\":\"29\"},{\"1\":\"Qc2\",\"2\":\"Quebec\",\"3\":\"chilled\",\"4\":\"175\",\"5\":\"27.3\",\"_rn_\":\"30\"},{\"1\":\"Qc2\",\"2\":\"Quebec\",\"3\":\"chilled\",\"4\":\"250\",\"5\":\"35.0\",\"_rn_\":\"31\"},{\"1\":\"Qc2\",\"2\":\"Quebec\",\"3\":\"chilled\",\"4\":\"350\",\"5\":\"38.8\",\"_rn_\":\"32\"},{\"1\":\"Qc2\",\"2\":\"Quebec\",\"3\":\"chilled\",\"4\":\"500\",\"5\":\"38.6\",\"_rn_\":\"33\"},{\"1\":\"Qc2\",\"2\":\"Quebec\",\"3\":\"chilled\",\"4\":\"675\",\"5\":\"37.5\",\"_rn_\":\"34\"},{\"1\":\"Qc2\",\"2\":\"Quebec\",\"3\":\"chilled\",\"4\":\"1000\",\"5\":\"42.4\",\"_rn_\":\"35\"},{\"1\":\"Qc3\",\"2\":\"Quebec\",\"3\":\"chilled\",\"4\":\"95\",\"5\":\"15.1\",\"_rn_\":\"36\"},{\"1\":\"Qc3\",\"2\":\"Quebec\",\"3\":\"chilled\",\"4\":\"175\",\"5\":\"21.0\",\"_rn_\":\"37\"},{\"1\":\"Qc3\",\"2\":\"Quebec\",\"3\":\"chilled\",\"4\":\"250\",\"5\":\"38.1\",\"_rn_\":\"38\"},{\"1\":\"Qc3\",\"2\":\"Quebec\",\"3\":\"chilled\",\"4\":\"350\",\"5\":\"34.0\",\"_rn_\":\"39\"},{\"1\":\"Qc3\",\"2\":\"Quebec\",\"3\":\"chilled\",\"4\":\"500\",\"5\":\"38.9\",\"_rn_\":\"40\"},{\"1\":\"Qc3\",\"2\":\"Quebec\",\"3\":\"chilled\",\"4\":\"675\",\"5\":\"39.6\",\"_rn_\":\"41\"},{\"1\":\"Qc3\",\"2\":\"Quebec\",\"3\":\"chilled\",\"4\":\"1000\",\"5\":\"41.4\",\"_rn_\":\"42\"},{\"1\":\"Mn1\",\"2\":\"Mississippi\",\"3\":\"nonchilled\",\"4\":\"95\",\"5\":\"10.6\",\"_rn_\":\"43\"},{\"1\":\"Mn1\",\"2\":\"Mississippi\",\"3\":\"nonchilled\",\"4\":\"175\",\"5\":\"19.2\",\"_rn_\":\"44\"},{\"1\":\"Mn1\",\"2\":\"Mississippi\",\"3\":\"nonchilled\",\"4\":\"250\",\"5\":\"26.2\",\"_rn_\":\"45\"},{\"1\":\"Mn1\",\"2\":\"Mississippi\",\"3\":\"nonchilled\",\"4\":\"350\",\"5\":\"30.0\",\"_rn_\":\"46\"},{\"1\":\"Mn1\",\"2\":\"Mississippi\",\"3\":\"nonchilled\",\"4\":\"500\",\"5\":\"30.9\",\"_rn_\":\"47\"},{\"1\":\"Mn1\",\"2\":\"Mississippi\",\"3\":\"nonchilled\",\"4\":\"675\",\"5\":\"32.4\",\"_rn_\":\"48\"},{\"1\":\"Mn1\",\"2\":\"Mississippi\",\"3\":\"nonchilled\",\"4\":\"1000\",\"5\":\"35.5\",\"_rn_\":\"49\"},{\"1\":\"Mn2\",\"2\":\"Mississippi\",\"3\":\"nonchilled\",\"4\":\"95\",\"5\":\"12.0\",\"_rn_\":\"50\"},{\"1\":\"Mn2\",\"2\":\"Mississippi\",\"3\":\"nonchilled\",\"4\":\"175\",\"5\":\"22.0\",\"_rn_\":\"51\"},{\"1\":\"Mn2\",\"2\":\"Mississippi\",\"3\":\"nonchilled\",\"4\":\"250\",\"5\":\"30.6\",\"_rn_\":\"52\"},{\"1\":\"Mn2\",\"2\":\"Mississippi\",\"3\":\"nonchilled\",\"4\":\"350\",\"5\":\"31.8\",\"_rn_\":\"53\"},{\"1\":\"Mn2\",\"2\":\"Mississippi\",\"3\":\"nonchilled\",\"4\":\"500\",\"5\":\"32.4\",\"_rn_\":\"54\"},{\"1\":\"Mn2\",\"2\":\"Mississippi\",\"3\":\"nonchilled\",\"4\":\"675\",\"5\":\"31.1\",\"_rn_\":\"55\"},{\"1\":\"Mn2\",\"2\":\"Mississippi\",\"3\":\"nonchilled\",\"4\":\"1000\",\"5\":\"31.5\",\"_rn_\":\"56\"},{\"1\":\"Mn3\",\"2\":\"Mississippi\",\"3\":\"nonchilled\",\"4\":\"95\",\"5\":\"11.3\",\"_rn_\":\"57\"},{\"1\":\"Mn3\",\"2\":\"Mississippi\",\"3\":\"nonchilled\",\"4\":\"175\",\"5\":\"19.4\",\"_rn_\":\"58\"},{\"1\":\"Mn3\",\"2\":\"Mississippi\",\"3\":\"nonchilled\",\"4\":\"250\",\"5\":\"25.8\",\"_rn_\":\"59\"},{\"1\":\"Mn3\",\"2\":\"Mississippi\",\"3\":\"nonchilled\",\"4\":\"350\",\"5\":\"27.9\",\"_rn_\":\"60\"},{\"1\":\"Mn3\",\"2\":\"Mississippi\",\"3\":\"nonchilled\",\"4\":\"500\",\"5\":\"28.5\",\"_rn_\":\"61\"},{\"1\":\"Mn3\",\"2\":\"Mississippi\",\"3\":\"nonchilled\",\"4\":\"675\",\"5\":\"28.1\",\"_rn_\":\"62\"},{\"1\":\"Mn3\",\"2\":\"Mississippi\",\"3\":\"nonchilled\",\"4\":\"1000\",\"5\":\"27.8\",\"_rn_\":\"63\"},{\"1\":\"Mc1\",\"2\":\"Mississippi\",\"3\":\"chilled\",\"4\":\"95\",\"5\":\"10.5\",\"_rn_\":\"64\"},{\"1\":\"Mc1\",\"2\":\"Mississippi\",\"3\":\"chilled\",\"4\":\"175\",\"5\":\"14.9\",\"_rn_\":\"65\"},{\"1\":\"Mc1\",\"2\":\"Mississippi\",\"3\":\"chilled\",\"4\":\"250\",\"5\":\"18.1\",\"_rn_\":\"66\"},{\"1\":\"Mc1\",\"2\":\"Mississippi\",\"3\":\"chilled\",\"4\":\"350\",\"5\":\"18.9\",\"_rn_\":\"67\"},{\"1\":\"Mc1\",\"2\":\"Mississippi\",\"3\":\"chilled\",\"4\":\"500\",\"5\":\"19.5\",\"_rn_\":\"68\"},{\"1\":\"Mc1\",\"2\":\"Mississippi\",\"3\":\"chilled\",\"4\":\"675\",\"5\":\"22.2\",\"_rn_\":\"69\"},{\"1\":\"Mc1\",\"2\":\"Mississippi\",\"3\":\"chilled\",\"4\":\"1000\",\"5\":\"21.9\",\"_rn_\":\"70\"},{\"1\":\"Mc2\",\"2\":\"Mississippi\",\"3\":\"chilled\",\"4\":\"95\",\"5\":\"7.7\",\"_rn_\":\"71\"},{\"1\":\"Mc2\",\"2\":\"Mississippi\",\"3\":\"chilled\",\"4\":\"175\",\"5\":\"11.4\",\"_rn_\":\"72\"},{\"1\":\"Mc2\",\"2\":\"Mississippi\",\"3\":\"chilled\",\"4\":\"250\",\"5\":\"12.3\",\"_rn_\":\"73\"},{\"1\":\"Mc2\",\"2\":\"Mississippi\",\"3\":\"chilled\",\"4\":\"350\",\"5\":\"13.0\",\"_rn_\":\"74\"},{\"1\":\"Mc2\",\"2\":\"Mississippi\",\"3\":\"chilled\",\"4\":\"500\",\"5\":\"12.5\",\"_rn_\":\"75\"},{\"1\":\"Mc2\",\"2\":\"Mississippi\",\"3\":\"chilled\",\"4\":\"675\",\"5\":\"13.7\",\"_rn_\":\"76\"},{\"1\":\"Mc2\",\"2\":\"Mississippi\",\"3\":\"chilled\",\"4\":\"1000\",\"5\":\"14.4\",\"_rn_\":\"77\"},{\"1\":\"Mc3\",\"2\":\"Mississippi\",\"3\":\"chilled\",\"4\":\"95\",\"5\":\"10.6\",\"_rn_\":\"78\"},{\"1\":\"Mc3\",\"2\":\"Mississippi\",\"3\":\"chilled\",\"4\":\"175\",\"5\":\"18.0\",\"_rn_\":\"79\"},{\"1\":\"Mc3\",\"2\":\"Mississippi\",\"3\":\"chilled\",\"4\":\"250\",\"5\":\"17.9\",\"_rn_\":\"80\"},{\"1\":\"Mc3\",\"2\":\"Mississippi\",\"3\":\"chilled\",\"4\":\"350\",\"5\":\"17.9\",\"_rn_\":\"81\"},{\"1\":\"Mc3\",\"2\":\"Mississippi\",\"3\":\"chilled\",\"4\":\"500\",\"5\":\"17.9\",\"_rn_\":\"82\"},{\"1\":\"Mc3\",\"2\":\"Mississippi\",\"3\":\"chilled\",\"4\":\"675\",\"5\":\"18.9\",\"_rn_\":\"83\"},{\"1\":\"Mc3\",\"2\":\"Mississippi\",\"3\":\"chilled\",\"4\":\"1000\",\"5\":\"19.9\",\"_rn_\":\"84\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nCO2 <- CO2 %>%\n    mutate(Type = as_factor(Type), Treatment = as_factor(Treatment), conc = as_factor(conc))\n```\n:::\n\n\nThis data is in *long form* with repeated entries for the same `Plant` \nID, where the measurements of dependent variable `uptake` are repeated \nfor 7 levels of `conc`. Hence `Treatment` is the *between groups* factor\nand `conc` is the *within groups* factor.\n\nWe can develop a model for repeated measures as follows:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplant_anova <- aov(uptake ~ Type * conc * Treatment + Error(Plant/conc), data = CO2)\n\nplant_anova %>%\n    broom::tidy()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"stratum\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"term\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"df\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"sumsq\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"meansq\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"statistic\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p.value\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Plant\",\"2\":\"Type\",\"3\":\"1\",\"4\":\"3365.5344\",\"5\":\"3365.534405\",\"6\":\"95.195486\",\"7\":\"1.019782e-05\"},{\"1\":\"Plant\",\"2\":\"Treatment\",\"3\":\"1\",\"4\":\"988.1144\",\"5\":\"988.114405\",\"6\":\"27.949211\",\"7\":\"7.401841e-04\"},{\"1\":\"Plant\",\"2\":\"Type:Treatment\",\"3\":\"1\",\"4\":\"225.7296\",\"5\":\"225.729643\",\"6\":\"6.384853\",\"7\":\"3.543008e-02\"},{\"1\":\"Plant\",\"2\":\"Residuals\",\"3\":\"8\",\"4\":\"282.8314\",\"5\":\"35.353929\",\"6\":\"NA\",\"7\":\"NA\"},{\"1\":\"Plant:conc\",\"2\":\"conc\",\"3\":\"6\",\"4\":\"4068.7714\",\"5\":\"678.128571\",\"6\":\"172.562254\",\"7\":\"9.755378e-31\"},{\"1\":\"Plant:conc\",\"2\":\"Type:conc\",\"3\":\"6\",\"4\":\"374.4248\",\"5\":\"62.404127\",\"6\":\"15.879875\",\"7\":\"5.975711e-10\"},{\"1\":\"Plant:conc\",\"2\":\"conc:Treatment\",\"3\":\"6\",\"4\":\"100.9814\",\"5\":\"16.830238\",\"6\":\"4.282763\",\"7\":\"1.557098e-03\"},{\"1\":\"Plant:conc\",\"2\":\"Type:conc:Treatment\",\"3\":\"6\",\"4\":\"111.9595\",\"5\":\"18.659921\",\"6\":\"4.748359\",\"7\":\"7.170698e-04\"},{\"1\":\"Plant:conc\",\"2\":\"Residuals\",\"3\":\"48\",\"4\":\"188.6286\",\"5\":\"3.929762\",\"6\":\"NA\",\"7\":\"NA\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n### {{< iconify pajamas issue-type-test-case >}} ANCOVA: Mouse Litter \nweights\n\nAnalysis of Co-variance extends one-way ANOVA to include one or more\nQuantitative *covariates*.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(litter, package = \"multcomp\")\nlitter\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"dose\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"weight\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"gesttime\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"number\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"0\",\"2\":\"28.05\",\"3\":\"22.5\",\"4\":\"15\",\"_rn_\":\"1\"},{\"1\":\"0\",\"2\":\"33.33\",\"3\":\"22.5\",\"4\":\"14\",\"_rn_\":\"2\"},{\"1\":\"0\",\"2\":\"36.37\",\"3\":\"22.0\",\"4\":\"14\",\"_rn_\":\"3\"},{\"1\":\"0\",\"2\":\"35.52\",\"3\":\"22.0\",\"4\":\"13\",\"_rn_\":\"4\"},{\"1\":\"0\",\"2\":\"36.77\",\"3\":\"21.5\",\"4\":\"15\",\"_rn_\":\"5\"},{\"1\":\"0\",\"2\":\"29.60\",\"3\":\"23.0\",\"4\":\"5\",\"_rn_\":\"6\"},{\"1\":\"0\",\"2\":\"27.72\",\"3\":\"21.5\",\"4\":\"16\",\"_rn_\":\"7\"},{\"1\":\"0\",\"2\":\"33.67\",\"3\":\"22.5\",\"4\":\"15\",\"_rn_\":\"8\"},{\"1\":\"0\",\"2\":\"32.55\",\"3\":\"22.5\",\"4\":\"14\",\"_rn_\":\"9\"},{\"1\":\"0\",\"2\":\"32.78\",\"3\":\"21.5\",\"4\":\"15\",\"_rn_\":\"10\"},{\"1\":\"0\",\"2\":\"31.05\",\"3\":\"22.0\",\"4\":\"12\",\"_rn_\":\"11\"},{\"1\":\"0\",\"2\":\"33.40\",\"3\":\"22.5\",\"4\":\"15\",\"_rn_\":\"12\"},{\"1\":\"0\",\"2\":\"30.20\",\"3\":\"22.0\",\"4\":\"16\",\"_rn_\":\"13\"},{\"1\":\"0\",\"2\":\"28.63\",\"3\":\"21.5\",\"4\":\"7\",\"_rn_\":\"14\"},{\"1\":\"0\",\"2\":\"33.38\",\"3\":\"22.0\",\"4\":\"15\",\"_rn_\":\"15\"},{\"1\":\"0\",\"2\":\"33.43\",\"3\":\"22.0\",\"4\":\"13\",\"_rn_\":\"16\"},{\"1\":\"0\",\"2\":\"29.63\",\"3\":\"21.5\",\"4\":\"14\",\"_rn_\":\"17\"},{\"1\":\"0\",\"2\":\"33.08\",\"3\":\"22.0\",\"4\":\"15\",\"_rn_\":\"18\"},{\"1\":\"0\",\"2\":\"31.53\",\"3\":\"22.5\",\"4\":\"16\",\"_rn_\":\"19\"},{\"1\":\"0\",\"2\":\"35.48\",\"3\":\"22.0\",\"4\":\"9\",\"_rn_\":\"20\"},{\"1\":\"5\",\"2\":\"34.83\",\"3\":\"22.5\",\"4\":\"15\",\"_rn_\":\"21\"},{\"1\":\"5\",\"2\":\"26.33\",\"3\":\"22.5\",\"4\":\"7\",\"_rn_\":\"22\"},{\"1\":\"5\",\"2\":\"24.28\",\"3\":\"22.5\",\"4\":\"15\",\"_rn_\":\"23\"},{\"1\":\"5\",\"2\":\"38.63\",\"3\":\"23.0\",\"4\":\"9\",\"_rn_\":\"24\"},{\"1\":\"5\",\"2\":\"27.92\",\"3\":\"22.0\",\"4\":\"13\",\"_rn_\":\"25\"},{\"1\":\"5\",\"2\":\"33.85\",\"3\":\"22.5\",\"4\":\"13\",\"_rn_\":\"26\"},{\"1\":\"5\",\"2\":\"24.95\",\"3\":\"22.5\",\"4\":\"17\",\"_rn_\":\"27\"},{\"1\":\"5\",\"2\":\"33.20\",\"3\":\"22.5\",\"4\":\"15\",\"_rn_\":\"28\"},{\"1\":\"5\",\"2\":\"36.03\",\"3\":\"22.5\",\"4\":\"12\",\"_rn_\":\"29\"},{\"1\":\"5\",\"2\":\"26.80\",\"3\":\"22.0\",\"4\":\"13\",\"_rn_\":\"30\"},{\"1\":\"5\",\"2\":\"31.67\",\"3\":\"22.0\",\"4\":\"14\",\"_rn_\":\"31\"},{\"1\":\"5\",\"2\":\"30.33\",\"3\":\"21.5\",\"4\":\"12\",\"_rn_\":\"32\"},{\"1\":\"5\",\"2\":\"26.83\",\"3\":\"22.5\",\"4\":\"14\",\"_rn_\":\"33\"},{\"1\":\"5\",\"2\":\"32.18\",\"3\":\"22.0\",\"4\":\"13\",\"_rn_\":\"34\"},{\"1\":\"5\",\"2\":\"33.77\",\"3\":\"22.5\",\"4\":\"16\",\"_rn_\":\"35\"},{\"1\":\"5\",\"2\":\"21.30\",\"3\":\"21.5\",\"4\":\"9\",\"_rn_\":\"36\"},{\"1\":\"5\",\"2\":\"25.78\",\"3\":\"21.5\",\"4\":\"14\",\"_rn_\":\"37\"},{\"1\":\"5\",\"2\":\"19.90\",\"3\":\"21.5\",\"4\":\"12\",\"_rn_\":\"38\"},{\"1\":\"5\",\"2\":\"28.28\",\"3\":\"22.5\",\"4\":\"16\",\"_rn_\":\"39\"},{\"1\":\"50\",\"2\":\"31.28\",\"3\":\"22.0\",\"4\":\"16\",\"_rn_\":\"40\"},{\"1\":\"50\",\"2\":\"35.80\",\"3\":\"21.5\",\"4\":\"16\",\"_rn_\":\"41\"},{\"1\":\"50\",\"2\":\"27.97\",\"3\":\"21.5\",\"4\":\"14\",\"_rn_\":\"42\"},{\"1\":\"50\",\"2\":\"33.13\",\"3\":\"22.5\",\"4\":\"15\",\"_rn_\":\"43\"},{\"1\":\"50\",\"2\":\"30.60\",\"3\":\"22.5\",\"4\":\"15\",\"_rn_\":\"44\"},{\"1\":\"50\",\"2\":\"30.17\",\"3\":\"21.5\",\"4\":\"15\",\"_rn_\":\"45\"},{\"1\":\"50\",\"2\":\"27.07\",\"3\":\"21.5\",\"4\":\"14\",\"_rn_\":\"46\"},{\"1\":\"50\",\"2\":\"32.02\",\"3\":\"22.0\",\"4\":\"17\",\"_rn_\":\"47\"},{\"1\":\"50\",\"2\":\"36.72\",\"3\":\"22.5\",\"4\":\"13\",\"_rn_\":\"48\"},{\"1\":\"50\",\"2\":\"28.50\",\"3\":\"21.5\",\"4\":\"14\",\"_rn_\":\"49\"},{\"1\":\"50\",\"2\":\"21.58\",\"3\":\"21.5\",\"4\":\"16\",\"_rn_\":\"50\"},{\"1\":\"50\",\"2\":\"30.82\",\"3\":\"22.5\",\"4\":\"17\",\"_rn_\":\"51\"},{\"1\":\"50\",\"2\":\"30.55\",\"3\":\"22.0\",\"4\":\"14\",\"_rn_\":\"52\"},{\"1\":\"50\",\"2\":\"27.63\",\"3\":\"22.0\",\"4\":\"14\",\"_rn_\":\"53\"},{\"1\":\"50\",\"2\":\"22.97\",\"3\":\"22.0\",\"4\":\"12\",\"_rn_\":\"54\"},{\"1\":\"50\",\"2\":\"29.55\",\"3\":\"21.5\",\"4\":\"12\",\"_rn_\":\"55\"},{\"1\":\"50\",\"2\":\"31.93\",\"3\":\"22.0\",\"4\":\"14\",\"_rn_\":\"56\"},{\"1\":\"50\",\"2\":\"29.30\",\"3\":\"21.5\",\"4\":\"16\",\"_rn_\":\"57\"},{\"1\":\"500\",\"2\":\"24.55\",\"3\":\"22.0\",\"4\":\"7\",\"_rn_\":\"58\"},{\"1\":\"500\",\"2\":\"33.78\",\"3\":\"22.5\",\"4\":\"13\",\"_rn_\":\"59\"},{\"1\":\"500\",\"2\":\"32.98\",\"3\":\"22.0\",\"4\":\"10\",\"_rn_\":\"60\"},{\"1\":\"500\",\"2\":\"25.38\",\"3\":\"21.5\",\"4\":\"11\",\"_rn_\":\"61\"},{\"1\":\"500\",\"2\":\"30.32\",\"3\":\"22.0\",\"4\":\"15\",\"_rn_\":\"62\"},{\"1\":\"500\",\"2\":\"19.22\",\"3\":\"22.5\",\"4\":\"11\",\"_rn_\":\"63\"},{\"1\":\"500\",\"2\":\"26.37\",\"3\":\"21.5\",\"4\":\"14\",\"_rn_\":\"64\"},{\"1\":\"500\",\"2\":\"28.60\",\"3\":\"22.5\",\"4\":\"9\",\"_rn_\":\"65\"},{\"1\":\"500\",\"2\":\"19.70\",\"3\":\"22.0\",\"4\":\"11\",\"_rn_\":\"66\"},{\"1\":\"500\",\"2\":\"32.88\",\"3\":\"22.5\",\"4\":\"15\",\"_rn_\":\"67\"},{\"1\":\"500\",\"2\":\"26.12\",\"3\":\"22.5\",\"4\":\"13\",\"_rn_\":\"68\"},{\"1\":\"500\",\"2\":\"33.20\",\"3\":\"22.0\",\"4\":\"12\",\"_rn_\":\"69\"},{\"1\":\"500\",\"2\":\"32.97\",\"3\":\"22.5\",\"4\":\"14\",\"_rn_\":\"70\"},{\"1\":\"500\",\"2\":\"38.75\",\"3\":\"23.0\",\"4\":\"16\",\"_rn_\":\"71\"},{\"1\":\"500\",\"2\":\"33.15\",\"3\":\"22.5\",\"4\":\"12\",\"_rn_\":\"72\"},{\"1\":\"500\",\"2\":\"30.70\",\"3\":\"21.5\",\"4\":\"13\",\"_rn_\":\"73\"},{\"1\":\"500\",\"2\":\"35.32\",\"3\":\"22.0\",\"4\":\"17\",\"_rn_\":\"74\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nlitter %>%\n    group_by(dose) %>%\n    count()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"dose\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"n\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"0\",\"2\":\"20\"},{\"1\":\"5\",\"2\":\"19\"},{\"1\":\"50\",\"2\":\"18\"},{\"1\":\"500\",\"2\":\"17\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nHere, `weight` is the target variable, with `dose` being the Qualitative\npredictor, and `gesttime` the Quantitative covariate. The experiment is\nalso unbalanced, with differences in the number of observations assigned\nto each `dose`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlitter_anova <- aov(weight ~ dose * gesttime, data = litter)\nsummary(litter_anova)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n              Df Sum Sq Mean Sq F value Pr(>F)   \ndose           3  109.9   36.64   2.262 0.0894 . \ngesttime       1  161.5  161.49   9.967 0.0024 **\ndose:gesttime  3   81.9   27.29   1.684 0.1789   \nResiduals     66 1069.4   16.20                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggeffects::ggeffect(litter_anova, ci.lvl = 0.95)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$dose\n# Predicted values of weight\n\ndose | Predicted |       95% CI\n-------------------------------\n0    |     32.31 | 30.51, 34.11\n5    |     28.51 | 26.59, 30.42\n50   |     30.61 | 28.49, 32.73\n500  |     29.29 | 27.30, 31.28\n\n\n$gesttime\n# Predicted values of weight\n\ngesttime | Predicted |       95% CI\n-----------------------------------\n   21.50 |     28.18 | 26.56, 29.80\n   22.00 |     29.92 | 28.93, 30.91\n   22.50 |     31.66 | 30.31, 33.02\n   23.00 |     33.41 | 31.13, 35.68\n\n\nattr(,\"class\")\n[1] \"ggalleffects\" \"list\"        \nattr(,\"model.name\")\n[1] \"litter_anova\"\n```\n\n\n:::\n:::\n\n\nSo the effect of `gesttime` is significant, but not so `dose` and and\ntheir interaction term...\n\nBecause of the covariate `gesttime`, the means of `weight` are\ninfluenced by both and we can calculate the means, after *adjusting* for\nthe covariate `gesttime`. We can use the `effects` package to do this:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# library(effects)\nlitter %>% \n  group_by(dose) %>% \n  summarise(original_mean = mean(weight))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"dose\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"original_mean\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"0\",\"2\":\"32.30850\"},{\"1\":\"5\",\"2\":\"29.30842\"},{\"1\":\"50\",\"2\":\"29.86611\"},{\"1\":\"500\",\"2\":\"29.64647\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n##\nfitted_means <- effects::effect(term = \"dose\", mod = litter_anova) %>% as_tibble()\nfitted_means\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"dose\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"fit\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"se\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"lower\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"upper\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"0\",\"2\":\"32.30722\",\"3\":\"0.9004935\",\"4\":\"30.50933\",\"5\":\"34.10511\"},{\"1\":\"5\",\"2\":\"28.50625\",\"3\":\"0.9588904\",\"4\":\"26.59176\",\"5\":\"30.42074\"},{\"1\":\"50\",\"2\":\"30.61078\",\"3\":\"1.0635084\",\"4\":\"28.48741\",\"5\":\"32.73414\"},{\"1\":\"500\",\"2\":\"29.29005\",\"3\":\"0.9979841\",\"4\":\"27.29751\",\"5\":\"31.28259\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n## Can we plot these for a better view?\n\ngf_summary(weight ~ dose,\n           colour = ~\"Original Means\",\n           fun.y = \"mean\", geom = \"point\", \n           group = ~ dose, size = 4,\n           data = litter) %>% \n  gf_errorbar(data = fitted_means, \n      # a formula with shape ymin + ymax ~ x \n      lower + upper ~ dose, inherit = FALSE, width = 0.25) %>% \n  gf_point(fit ~ dose, \n            size = 4, colour = ~ \"Adjusted Means\",\n           data = fitted_means) %>% \n  gf_refine(scale_x_discrete(guide = \"prism_bracket\")) %>% \n  gf_theme(ggprism::theme_prism())\n```\n\n::: {.cell-output-display}\n![](Two-Way-ANOVA_files/figure-html/unnamed-chunk-13-1.png){width=2100}\n:::\n:::\n\n\nNot too different, so the covariate `gesttime` does not affect the\n`weight` too much...however, we should verify that the `gesttime`\nvariable has the *same regression slope* across levels of `dose`. This\ncan be done with the `HH` package:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(HH)\nHH::ancova(weight ~ gesttime * dose, data = litter)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: weight\n              Df  Sum Sq Mean Sq F value   Pr(>F)   \ngesttime       1  134.30 134.304  8.2888 0.005372 **\ndose           3  137.12  45.708  2.8209 0.045562 * \ngesttime:dose  3   81.87  27.289  1.6842 0.178889   \nResiduals     66 1069.40  16.203                    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Two-Way-ANOVA_files/figure-html/unnamed-chunk-14-1.png){width=2100}\n:::\n\n```{.r .cell-code}\np1 <- litter %>%\n    group_by(dose) %>%\n    gf_point(weight ~ gesttime, color = ~dose) %>%\n    gf_lm() %>%\n    gf_facet_wrap(vars(dose), ncol = 4) %>%\n    gf_theme(theme_bw()) %>%\n    gf_refine(theme(axis.text.x = element_text(size = 5)))\n\np2 <- litter %>%\n    group_by(dose) %>%\n    gf_point(weight ~ gesttime, color = ~dose) %>%\n    gf_lm() %>%\n    gf_theme(theme_bw()) %>%\n    gf_refine(theme(axis.text.x = element_text(size = 5)))\n\np1 + p2 + plot_layout(widths = c(2, 1), guides = \"collect\")\n```\n\n::: {.cell-output-display}\n![](Two-Way-ANOVA_files/figure-html/unnamed-chunk-14-2.png){width=2100}\n:::\n:::\n\n\nThe regression slopes for `weight ~ gesttime` are reasonably close for\nall `dose` values, except, $0$. So one hypothesis that we can check, is\nwhether there is a significant difference in `weight` between *no-drug*\nand *drug* regimes. We can do this with the `multcomp` package, after\nspecifying the hypthesis in the form of a *contrast*:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# library(multcomp)\n```\n:::\n\n\n### {{< iconify pajamas issue-type-test-case >}} MANCOVA: US Cereals\n\nSometimes we have more than on Quantitative variable that we want to\ndeal with. In this case we have multiple-ANOVAs, or MANOVA.\n\nIn our next Case Study, we will try to model if there is a difference in\nthe nutritional content of cereals stored/displayed on different shelves\nin a supermarket.\n\nMANOVA can be used in certain conditions:\n\n-   The dependent variables should be normally distribute within groups.\n    The R function mshapiro.test( )\\[in the `mvnormtest` package\\] can\n    be used to perform the Shapiro-Wilk test for multivariate normality.\n    This is useful in the case of MANOVA, which assumes multivariate\n    normality.\n\n-   Homogeneity of variances across the range of predictors.\n\n-   Linearity between all pairs of dependent variables, all pairs of\n    covariates, and all dependent variable-covariate pairs in each cell.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(\"UScereal\", package = \"MASS\")\nUScereal\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"mfr\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"calories\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"protein\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"fat\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"sodium\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"fibre\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"carbo\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"sugars\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"shelf\"],\"name\":[9],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"potassium\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"vitamins\"],\"name\":[11],\"type\":[\"fct\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"N\",\"2\":\"212.12121\",\"3\":\"12.1212121\",\"4\":\"3.0303030\",\"5\":\"393.93939\",\"6\":\"30.303030\",\"7\":\"15.15152\",\"8\":\"18.181818\",\"9\":\"3\",\"10\":\"848.48485\",\"11\":\"enriched\",\"_rn_\":\"100% Bran\"},{\"1\":\"K\",\"2\":\"212.12121\",\"3\":\"12.1212121\",\"4\":\"3.0303030\",\"5\":\"787.87879\",\"6\":\"27.272727\",\"7\":\"21.21212\",\"8\":\"15.151515\",\"9\":\"3\",\"10\":\"969.69697\",\"11\":\"enriched\",\"_rn_\":\"All-Bran\"},{\"1\":\"K\",\"2\":\"100.00000\",\"3\":\"8.0000000\",\"4\":\"0.0000000\",\"5\":\"280.00000\",\"6\":\"28.000000\",\"7\":\"16.00000\",\"8\":\"0.000000\",\"9\":\"3\",\"10\":\"660.00000\",\"11\":\"enriched\",\"_rn_\":\"All-Bran with Extra Fiber\"},{\"1\":\"G\",\"2\":\"146.66667\",\"3\":\"2.6666667\",\"4\":\"2.6666667\",\"5\":\"240.00000\",\"6\":\"2.000000\",\"7\":\"14.00000\",\"8\":\"13.333333\",\"9\":\"1\",\"10\":\"93.33333\",\"11\":\"enriched\",\"_rn_\":\"Apple Cinnamon Cheerios\"},{\"1\":\"K\",\"2\":\"110.00000\",\"3\":\"2.0000000\",\"4\":\"0.0000000\",\"5\":\"125.00000\",\"6\":\"1.000000\",\"7\":\"11.00000\",\"8\":\"14.000000\",\"9\":\"2\",\"10\":\"30.00000\",\"11\":\"enriched\",\"_rn_\":\"Apple Jacks\"},{\"1\":\"G\",\"2\":\"173.33333\",\"3\":\"4.0000000\",\"4\":\"2.6666667\",\"5\":\"280.00000\",\"6\":\"2.666667\",\"7\":\"24.00000\",\"8\":\"10.666667\",\"9\":\"3\",\"10\":\"133.33333\",\"11\":\"enriched\",\"_rn_\":\"Basic 4\"},{\"1\":\"R\",\"2\":\"134.32836\",\"3\":\"2.9850746\",\"4\":\"1.4925373\",\"5\":\"298.50746\",\"6\":\"5.970149\",\"7\":\"22.38806\",\"8\":\"8.955224\",\"9\":\"1\",\"10\":\"186.56716\",\"11\":\"enriched\",\"_rn_\":\"Bran Chex\"},{\"1\":\"P\",\"2\":\"134.32836\",\"3\":\"4.4776119\",\"4\":\"0.0000000\",\"5\":\"313.43284\",\"6\":\"7.462687\",\"7\":\"19.40299\",\"8\":\"7.462687\",\"9\":\"3\",\"10\":\"283.58209\",\"11\":\"enriched\",\"_rn_\":\"Bran Flakes\"},{\"1\":\"Q\",\"2\":\"160.00000\",\"3\":\"1.3333333\",\"4\":\"2.6666667\",\"5\":\"293.33333\",\"6\":\"0.000000\",\"7\":\"16.00000\",\"8\":\"16.000000\",\"9\":\"2\",\"10\":\"46.66667\",\"11\":\"enriched\",\"_rn_\":\"Cap'n'Crunch\"},{\"1\":\"G\",\"2\":\"88.00000\",\"3\":\"4.8000000\",\"4\":\"1.6000000\",\"5\":\"232.00000\",\"6\":\"1.600000\",\"7\":\"13.60000\",\"8\":\"0.800000\",\"9\":\"1\",\"10\":\"84.00000\",\"11\":\"enriched\",\"_rn_\":\"Cheerios\"},{\"1\":\"G\",\"2\":\"160.00000\",\"3\":\"1.3333333\",\"4\":\"4.0000000\",\"5\":\"280.00000\",\"6\":\"0.000000\",\"7\":\"17.33333\",\"8\":\"12.000000\",\"9\":\"2\",\"10\":\"60.00000\",\"11\":\"enriched\",\"_rn_\":\"Cinnamon Toast Crunch\"},{\"1\":\"G\",\"2\":\"220.00000\",\"3\":\"6.0000000\",\"4\":\"4.0000000\",\"5\":\"280.00000\",\"6\":\"4.000000\",\"7\":\"26.00000\",\"8\":\"14.000000\",\"9\":\"3\",\"10\":\"210.00000\",\"11\":\"enriched\",\"_rn_\":\"Clusters\"},{\"1\":\"G\",\"2\":\"110.00000\",\"3\":\"1.0000000\",\"4\":\"1.0000000\",\"5\":\"180.00000\",\"6\":\"0.000000\",\"7\":\"12.00000\",\"8\":\"13.000000\",\"9\":\"2\",\"10\":\"55.00000\",\"11\":\"enriched\",\"_rn_\":\"Cocoa Puffs\"},{\"1\":\"R\",\"2\":\"110.00000\",\"3\":\"2.0000000\",\"4\":\"0.0000000\",\"5\":\"280.00000\",\"6\":\"0.000000\",\"7\":\"22.00000\",\"8\":\"3.000000\",\"9\":\"1\",\"10\":\"25.00000\",\"11\":\"enriched\",\"_rn_\":\"Corn Chex\"},{\"1\":\"K\",\"2\":\"100.00000\",\"3\":\"2.0000000\",\"4\":\"0.0000000\",\"5\":\"290.00000\",\"6\":\"1.000000\",\"7\":\"21.00000\",\"8\":\"2.000000\",\"9\":\"1\",\"10\":\"35.00000\",\"11\":\"enriched\",\"_rn_\":\"Corn Flakes\"},{\"1\":\"K\",\"2\":\"110.00000\",\"3\":\"1.0000000\",\"4\":\"0.0000000\",\"5\":\"90.00000\",\"6\":\"1.000000\",\"7\":\"13.00000\",\"8\":\"12.000000\",\"9\":\"2\",\"10\":\"20.00000\",\"11\":\"enriched\",\"_rn_\":\"Corn Pops\"},{\"1\":\"G\",\"2\":\"110.00000\",\"3\":\"1.0000000\",\"4\":\"1.0000000\",\"5\":\"180.00000\",\"6\":\"0.000000\",\"7\":\"12.00000\",\"8\":\"13.000000\",\"9\":\"2\",\"10\":\"65.00000\",\"11\":\"enriched\",\"_rn_\":\"Count Chocula\"},{\"1\":\"K\",\"2\":\"220.00000\",\"3\":\"6.0000000\",\"4\":\"6.0000000\",\"5\":\"280.00000\",\"6\":\"8.000000\",\"7\":\"20.00000\",\"8\":\"14.000000\",\"9\":\"3\",\"10\":\"320.00000\",\"11\":\"enriched\",\"_rn_\":\"Cracklin' Oat Bran\"},{\"1\":\"K\",\"2\":\"110.00000\",\"3\":\"2.0000000\",\"4\":\"0.0000000\",\"5\":\"220.00000\",\"6\":\"1.000000\",\"7\":\"21.00000\",\"8\":\"3.000000\",\"9\":\"3\",\"10\":\"30.00000\",\"11\":\"enriched\",\"_rn_\":\"Crispix\"},{\"1\":\"G\",\"2\":\"133.33333\",\"3\":\"2.6666667\",\"4\":\"1.3333333\",\"5\":\"186.66667\",\"6\":\"2.666667\",\"7\":\"14.66667\",\"8\":\"13.333333\",\"9\":\"3\",\"10\":\"160.00000\",\"11\":\"enriched\",\"_rn_\":\"Crispy Wheat & Raisins\"},{\"1\":\"R\",\"2\":\"133.33333\",\"3\":\"2.6666667\",\"4\":\"0.0000000\",\"5\":\"253.33333\",\"6\":\"1.333333\",\"7\":\"24.00000\",\"8\":\"6.666667\",\"9\":\"3\",\"10\":\"106.66667\",\"11\":\"enriched\",\"_rn_\":\"Double Chex\"},{\"1\":\"K\",\"2\":\"110.00000\",\"3\":\"2.0000000\",\"4\":\"1.0000000\",\"5\":\"125.00000\",\"6\":\"1.000000\",\"7\":\"11.00000\",\"8\":\"13.000000\",\"9\":\"2\",\"10\":\"30.00000\",\"11\":\"enriched\",\"_rn_\":\"Froot Loops\"},{\"1\":\"K\",\"2\":\"146.66667\",\"3\":\"1.3333333\",\"4\":\"0.0000000\",\"5\":\"266.66667\",\"6\":\"1.333333\",\"7\":\"18.66667\",\"8\":\"14.666667\",\"9\":\"1\",\"10\":\"33.33333\",\"11\":\"enriched\",\"_rn_\":\"Frosted Flakes\"},{\"1\":\"K\",\"2\":\"125.00000\",\"3\":\"3.7500000\",\"4\":\"0.0000000\",\"5\":\"0.00000\",\"6\":\"3.750000\",\"7\":\"17.50000\",\"8\":\"8.750000\",\"9\":\"2\",\"10\":\"125.00000\",\"11\":\"enriched\",\"_rn_\":\"Frosted Mini-Wheats\"},{\"1\":\"P\",\"2\":\"179.10448\",\"3\":\"4.4776119\",\"4\":\"2.9850746\",\"5\":\"238.80597\",\"6\":\"7.462687\",\"7\":\"17.91045\",\"8\":\"14.925373\",\"9\":\"3\",\"10\":\"298.50746\",\"11\":\"enriched\",\"_rn_\":\"Fruit & Fibre: Dates Walnuts and Oats\"},{\"1\":\"K\",\"2\":\"179.10448\",\"3\":\"4.4776119\",\"4\":\"0.0000000\",\"5\":\"358.20896\",\"6\":\"7.462687\",\"7\":\"20.89552\",\"8\":\"17.910448\",\"9\":\"3\",\"10\":\"283.58209\",\"11\":\"enriched\",\"_rn_\":\"Fruitful Bran\"},{\"1\":\"P\",\"2\":\"146.66667\",\"3\":\"1.3333333\",\"4\":\"1.3333333\",\"5\":\"180.00000\",\"6\":\"0.000000\",\"7\":\"17.33333\",\"8\":\"16.000000\",\"9\":\"2\",\"10\":\"33.33333\",\"11\":\"enriched\",\"_rn_\":\"Fruity Pebbles\"},{\"1\":\"P\",\"2\":\"113.63636\",\"3\":\"2.2727273\",\"4\":\"0.0000000\",\"5\":\"51.13636\",\"6\":\"0.000000\",\"7\":\"12.50000\",\"8\":\"17.045455\",\"9\":\"1\",\"10\":\"45.45455\",\"11\":\"enriched\",\"_rn_\":\"Golden Crisp\"},{\"1\":\"G\",\"2\":\"146.66667\",\"3\":\"1.3333333\",\"4\":\"1.3333333\",\"5\":\"373.33333\",\"6\":\"0.000000\",\"7\":\"20.00000\",\"8\":\"12.000000\",\"9\":\"2\",\"10\":\"60.00000\",\"11\":\"enriched\",\"_rn_\":\"Golden Grahams\"},{\"1\":\"P\",\"2\":\"113.63636\",\"3\":\"3.4090909\",\"4\":\"1.1363636\",\"5\":\"159.09091\",\"6\":\"3.409091\",\"7\":\"17.04545\",\"8\":\"5.681818\",\"9\":\"3\",\"10\":\"96.59091\",\"11\":\"enriched\",\"_rn_\":\"Grape Nuts Flakes\"},{\"1\":\"P\",\"2\":\"440.00000\",\"3\":\"12.0000000\",\"4\":\"0.0000000\",\"5\":\"680.00000\",\"6\":\"12.000000\",\"7\":\"68.00000\",\"8\":\"12.000000\",\"9\":\"3\",\"10\":\"360.00000\",\"11\":\"enriched\",\"_rn_\":\"Grape-Nuts\"},{\"1\":\"P\",\"2\":\"363.63636\",\"3\":\"9.0909091\",\"4\":\"9.0909091\",\"5\":\"227.27273\",\"6\":\"9.090909\",\"7\":\"39.39394\",\"8\":\"12.121212\",\"9\":\"3\",\"10\":\"303.03030\",\"11\":\"enriched\",\"_rn_\":\"Great Grains Pecan\"},{\"1\":\"Q\",\"2\":\"120.00000\",\"3\":\"1.0000000\",\"4\":\"2.0000000\",\"5\":\"220.00000\",\"6\":\"1.000000\",\"7\":\"12.00000\",\"8\":\"11.000000\",\"9\":\"2\",\"10\":\"45.00000\",\"11\":\"enriched\",\"_rn_\":\"Honey Graham Ohs\"},{\"1\":\"G\",\"2\":\"146.66667\",\"3\":\"4.0000000\",\"4\":\"1.3333333\",\"5\":\"333.33333\",\"6\":\"2.000000\",\"7\":\"15.33333\",\"8\":\"13.333333\",\"9\":\"1\",\"10\":\"120.00000\",\"11\":\"enriched\",\"_rn_\":\"Honey Nut Cheerios\"},{\"1\":\"P\",\"2\":\"82.70677\",\"3\":\"0.7518797\",\"4\":\"0.0000000\",\"5\":\"135.33835\",\"6\":\"0.000000\",\"7\":\"10.52632\",\"8\":\"8.270677\",\"9\":\"1\",\"10\":\"26.31579\",\"11\":\"enriched\",\"_rn_\":\"Honey-comb\"},{\"1\":\"K\",\"2\":\"186.66667\",\"3\":\"4.0000000\",\"4\":\"1.3333333\",\"5\":\"226.66667\",\"6\":\"2.666667\",\"7\":\"26.66667\",\"8\":\"12.000000\",\"9\":\"3\",\"10\":\"126.66667\",\"11\":\"100%\",\"_rn_\":\"Just Right Fruit & Nut\"},{\"1\":\"G\",\"2\":\"73.33333\",\"3\":\"1.3333333\",\"4\":\"0.6666667\",\"5\":\"173.33333\",\"6\":\"0.000000\",\"7\":\"14.00000\",\"8\":\"2.000000\",\"9\":\"2\",\"10\":\"26.66667\",\"11\":\"enriched\",\"_rn_\":\"Kix\"},{\"1\":\"Q\",\"2\":\"149.25373\",\"3\":\"5.9701493\",\"4\":\"2.9850746\",\"5\":\"223.88060\",\"6\":\"2.985075\",\"7\":\"17.91045\",\"8\":\"8.955224\",\"9\":\"2\",\"10\":\"141.79104\",\"11\":\"enriched\",\"_rn_\":\"Life\"},{\"1\":\"G\",\"2\":\"110.00000\",\"3\":\"2.0000000\",\"4\":\"1.0000000\",\"5\":\"180.00000\",\"6\":\"0.000000\",\"7\":\"12.00000\",\"8\":\"12.000000\",\"9\":\"2\",\"10\":\"55.00000\",\"11\":\"enriched\",\"_rn_\":\"Lucky Charms\"},{\"1\":\"K\",\"2\":\"238.80597\",\"3\":\"4.4776119\",\"4\":\"2.9850746\",\"5\":\"223.88060\",\"6\":\"4.477612\",\"7\":\"25.37313\",\"8\":\"19.402985\",\"9\":\"3\",\"10\":\"238.80597\",\"11\":\"enriched\",\"_rn_\":\"Mueslix Crispy Blend\"},{\"1\":\"G\",\"2\":\"100.00000\",\"3\":\"2.0000000\",\"4\":\"1.0000000\",\"5\":\"220.00000\",\"6\":\"2.000000\",\"7\":\"15.00000\",\"8\":\"6.000000\",\"9\":\"1\",\"10\":\"90.00000\",\"11\":\"enriched\",\"_rn_\":\"Multi-Grain Cheerios\"},{\"1\":\"K\",\"2\":\"179.10448\",\"3\":\"2.9850746\",\"4\":\"1.4925373\",\"5\":\"283.58209\",\"6\":\"0.000000\",\"7\":\"22.38806\",\"8\":\"13.432836\",\"9\":\"2\",\"10\":\"59.70149\",\"11\":\"enriched\",\"_rn_\":\"Nut&Honey Crunch\"},{\"1\":\"K\",\"2\":\"208.95522\",\"3\":\"4.4776119\",\"4\":\"2.9850746\",\"5\":\"328.35821\",\"6\":\"4.477612\",\"7\":\"31.34328\",\"8\":\"10.447761\",\"9\":\"3\",\"10\":\"194.02985\",\"11\":\"enriched\",\"_rn_\":\"Nutri-Grain Almond-Raisin\"},{\"1\":\"G\",\"2\":\"260.00000\",\"3\":\"6.0000000\",\"4\":\"4.0000000\",\"5\":\"340.00000\",\"6\":\"3.000000\",\"7\":\"27.00000\",\"8\":\"20.000000\",\"9\":\"3\",\"10\":\"240.00000\",\"11\":\"enriched\",\"_rn_\":\"Oatmeal Raisin Crisp\"},{\"1\":\"P\",\"2\":\"179.10448\",\"3\":\"4.4776119\",\"4\":\"1.4925373\",\"5\":\"298.50746\",\"6\":\"8.955224\",\"7\":\"16.41791\",\"8\":\"20.895522\",\"9\":\"3\",\"10\":\"388.05970\",\"11\":\"enriched\",\"_rn_\":\"Post Nat. Raisin Bran\"},{\"1\":\"K\",\"2\":\"100.00000\",\"3\":\"3.0000000\",\"4\":\"0.0000000\",\"5\":\"320.00000\",\"6\":\"1.000000\",\"7\":\"20.00000\",\"8\":\"3.000000\",\"9\":\"3\",\"10\":\"45.00000\",\"11\":\"100%\",\"_rn_\":\"Product 19\"},{\"1\":\"Q\",\"2\":\"50.00000\",\"3\":\"1.0000000\",\"4\":\"0.0000000\",\"5\":\"0.00000\",\"6\":\"0.000000\",\"7\":\"13.00000\",\"8\":\"0.000000\",\"9\":\"3\",\"10\":\"15.00000\",\"11\":\"none\",\"_rn_\":\"Puffed Rice\"},{\"1\":\"Q\",\"2\":\"200.00000\",\"3\":\"8.0000000\",\"4\":\"2.0000000\",\"5\":\"270.00000\",\"6\":\"4.000000\",\"7\":\"28.00000\",\"8\":\"12.000000\",\"9\":\"3\",\"10\":\"220.00000\",\"11\":\"enriched\",\"_rn_\":\"Quaker Oat Squares\"},{\"1\":\"K\",\"2\":\"160.00000\",\"3\":\"4.0000000\",\"4\":\"1.3333333\",\"5\":\"280.00000\",\"6\":\"6.666667\",\"7\":\"18.66667\",\"8\":\"16.000000\",\"9\":\"2\",\"10\":\"320.00000\",\"11\":\"enriched\",\"_rn_\":\"Raisin Bran\"},{\"1\":\"G\",\"2\":\"200.00000\",\"3\":\"6.0000000\",\"4\":\"4.0000000\",\"5\":\"280.00000\",\"6\":\"5.000000\",\"7\":\"21.00000\",\"8\":\"16.000000\",\"9\":\"3\",\"10\":\"280.00000\",\"11\":\"enriched\",\"_rn_\":\"Raisin Nut Bran\"},{\"1\":\"K\",\"2\":\"180.00000\",\"3\":\"4.0000000\",\"4\":\"0.0000000\",\"5\":\"0.00000\",\"6\":\"4.000000\",\"7\":\"30.00000\",\"8\":\"12.000000\",\"9\":\"3\",\"10\":\"220.00000\",\"11\":\"enriched\",\"_rn_\":\"Raisin Squares\"},{\"1\":\"R\",\"2\":\"97.34513\",\"3\":\"0.8849558\",\"4\":\"0.0000000\",\"5\":\"212.38938\",\"6\":\"0.000000\",\"7\":\"20.35398\",\"8\":\"1.769912\",\"9\":\"1\",\"10\":\"26.54867\",\"11\":\"enriched\",\"_rn_\":\"Rice Chex\"},{\"1\":\"K\",\"2\":\"110.00000\",\"3\":\"2.0000000\",\"4\":\"0.0000000\",\"5\":\"290.00000\",\"6\":\"0.000000\",\"7\":\"22.00000\",\"8\":\"3.000000\",\"9\":\"1\",\"10\":\"35.00000\",\"11\":\"enriched\",\"_rn_\":\"Rice Krispies\"},{\"1\":\"N\",\"2\":\"134.32836\",\"3\":\"4.4776119\",\"4\":\"0.0000000\",\"5\":\"0.00000\",\"6\":\"5.970149\",\"7\":\"28.35821\",\"8\":\"0.000000\",\"9\":\"1\",\"10\":\"208.95522\",\"11\":\"none\",\"_rn_\":\"Shredded Wheat 'n'Bran\"},{\"1\":\"N\",\"2\":\"134.32836\",\"3\":\"4.4776119\",\"4\":\"0.0000000\",\"5\":\"0.00000\",\"6\":\"4.477612\",\"7\":\"29.85075\",\"8\":\"0.000000\",\"9\":\"1\",\"10\":\"179.10448\",\"11\":\"none\",\"_rn_\":\"Shredded Wheat spoon size\"},{\"1\":\"K\",\"2\":\"146.66667\",\"3\":\"2.6666667\",\"4\":\"1.3333333\",\"5\":\"93.33333\",\"6\":\"1.333333\",\"7\":\"12.00000\",\"8\":\"20.000000\",\"9\":\"2\",\"10\":\"53.33333\",\"11\":\"enriched\",\"_rn_\":\"Smacks\"},{\"1\":\"K\",\"2\":\"110.00000\",\"3\":\"6.0000000\",\"4\":\"0.0000000\",\"5\":\"230.00000\",\"6\":\"1.000000\",\"7\":\"16.00000\",\"8\":\"3.000000\",\"9\":\"1\",\"10\":\"55.00000\",\"11\":\"enriched\",\"_rn_\":\"Special K\"},{\"1\":\"G\",\"2\":\"110.00000\",\"3\":\"2.0000000\",\"4\":\"1.0000000\",\"5\":\"200.00000\",\"6\":\"0.000000\",\"7\":\"21.00000\",\"8\":\"3.000000\",\"9\":\"3\",\"10\":\"35.00000\",\"11\":\"100%\",\"_rn_\":\"Total Corn Flakes\"},{\"1\":\"G\",\"2\":\"140.00000\",\"3\":\"3.0000000\",\"4\":\"1.0000000\",\"5\":\"190.00000\",\"6\":\"4.000000\",\"7\":\"15.00000\",\"8\":\"14.000000\",\"9\":\"3\",\"10\":\"230.00000\",\"11\":\"100%\",\"_rn_\":\"Total Raisin Bran\"},{\"1\":\"G\",\"2\":\"100.00000\",\"3\":\"3.0000000\",\"4\":\"1.0000000\",\"5\":\"200.00000\",\"6\":\"3.000000\",\"7\":\"16.00000\",\"8\":\"3.000000\",\"9\":\"3\",\"10\":\"110.00000\",\"11\":\"100%\",\"_rn_\":\"Total Whole Grain\"},{\"1\":\"G\",\"2\":\"146.66667\",\"3\":\"2.6666667\",\"4\":\"1.3333333\",\"5\":\"333.33333\",\"6\":\"0.000000\",\"7\":\"28.00000\",\"8\":\"4.000000\",\"9\":\"3\",\"10\":\"80.00000\",\"11\":\"enriched\",\"_rn_\":\"Triples\"},{\"1\":\"G\",\"2\":\"110.00000\",\"3\":\"1.0000000\",\"4\":\"1.0000000\",\"5\":\"140.00000\",\"6\":\"0.000000\",\"7\":\"13.00000\",\"8\":\"12.000000\",\"9\":\"2\",\"10\":\"25.00000\",\"11\":\"enriched\",\"_rn_\":\"Trix\"},{\"1\":\"R\",\"2\":\"149.25373\",\"3\":\"4.4776119\",\"4\":\"1.4925373\",\"5\":\"343.28358\",\"6\":\"4.477612\",\"7\":\"25.37313\",\"8\":\"4.477612\",\"9\":\"1\",\"10\":\"171.64179\",\"11\":\"enriched\",\"_rn_\":\"Wheat Chex\"},{\"1\":\"G\",\"2\":\"100.00000\",\"3\":\"3.0000000\",\"4\":\"1.0000000\",\"5\":\"200.00000\",\"6\":\"3.000000\",\"7\":\"17.00000\",\"8\":\"3.000000\",\"9\":\"1\",\"10\":\"110.00000\",\"11\":\"enriched\",\"_rn_\":\"Wheaties\"},{\"1\":\"G\",\"2\":\"146.66667\",\"3\":\"2.6666667\",\"4\":\"1.3333333\",\"5\":\"266.66667\",\"6\":\"1.333333\",\"7\":\"21.33333\",\"8\":\"10.666667\",\"9\":\"1\",\"10\":\"80.00000\",\"11\":\"enriched\",\"_rn_\":\"Wheaties Honey Gold\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nOur dependent variables are `calories`, `fat`, and `sugars`. Let us look\nat means and standard deviations of the target variables vs the\nindependent variables:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nUScereal %>%\n    dplyr::select(calories, fat, sugars, shelf) %>%\n    dplyr::mutate(shelf = as_factor(shelf)) %>%\n    dplyr::group_by(shelf) %>%\n    summarise(across(everything(), list(mean = mean, sd = sd))) %>%\n    dplyr::select(shelf, contains(\"mean\"), everything())\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"shelf\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"calories_mean\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"fat_mean\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"sugars_mean\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"calories_sd\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"fat_sd\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"sugars_sd\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"119.4774\",\"3\":\"0.6621338\",\"4\":\"6.295493\",\"5\":\"22.72565\",\"6\":\"0.832799\",\"7\":\"5.477309\"},{\"1\":\"2\",\"2\":\"129.8162\",\"3\":\"1.3413488\",\"4\":\"12.507670\",\"5\":\"27.06288\",\"6\":\"1.040902\",\"7\":\"3.735734\"},{\"1\":\"3\",\"2\":\"180.1466\",\"3\":\"1.9449071\",\"4\":\"10.856821\",\"5\":\"79.64873\",\"6\":\"2.112956\",\"7\":\"6.125487\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nUScereal_long <- UScereal %>%\n    dplyr::select(calories, fat, sugars, shelf) %>%\n    dplyr::mutate(shelf = as_factor(shelf)) %>%\n    pivot_longer(-shelf, names_to = \"params\", values_to = \"values\")\nUScereal_long\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"shelf\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"params\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"values\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"3\",\"2\":\"calories\",\"3\":\"212.1212100\"},{\"1\":\"3\",\"2\":\"fat\",\"3\":\"3.0303030\"},{\"1\":\"3\",\"2\":\"sugars\",\"3\":\"18.1818180\"},{\"1\":\"3\",\"2\":\"calories\",\"3\":\"212.1212100\"},{\"1\":\"3\",\"2\":\"fat\",\"3\":\"3.0303030\"},{\"1\":\"3\",\"2\":\"sugars\",\"3\":\"15.1515150\"},{\"1\":\"3\",\"2\":\"calories\",\"3\":\"100.0000000\"},{\"1\":\"3\",\"2\":\"fat\",\"3\":\"0.0000000\"},{\"1\":\"3\",\"2\":\"sugars\",\"3\":\"0.0000000\"},{\"1\":\"1\",\"2\":\"calories\",\"3\":\"146.6666700\"},{\"1\":\"1\",\"2\":\"fat\",\"3\":\"2.6666667\"},{\"1\":\"1\",\"2\":\"sugars\",\"3\":\"13.3333330\"},{\"1\":\"2\",\"2\":\"calories\",\"3\":\"110.0000000\"},{\"1\":\"2\",\"2\":\"fat\",\"3\":\"0.0000000\"},{\"1\":\"2\",\"2\":\"sugars\",\"3\":\"14.0000000\"},{\"1\":\"3\",\"2\":\"calories\",\"3\":\"173.3333300\"},{\"1\":\"3\",\"2\":\"fat\",\"3\":\"2.6666667\"},{\"1\":\"3\",\"2\":\"sugars\",\"3\":\"10.6666670\"},{\"1\":\"1\",\"2\":\"calories\",\"3\":\"134.3283600\"},{\"1\":\"1\",\"2\":\"fat\",\"3\":\"1.4925373\"},{\"1\":\"1\",\"2\":\"sugars\",\"3\":\"8.9552240\"},{\"1\":\"3\",\"2\":\"calories\",\"3\":\"134.3283600\"},{\"1\":\"3\",\"2\":\"fat\",\"3\":\"0.0000000\"},{\"1\":\"3\",\"2\":\"sugars\",\"3\":\"7.4626870\"},{\"1\":\"2\",\"2\":\"calories\",\"3\":\"160.0000000\"},{\"1\":\"2\",\"2\":\"fat\",\"3\":\"2.6666667\"},{\"1\":\"2\",\"2\":\"sugars\",\"3\":\"16.0000000\"},{\"1\":\"1\",\"2\":\"calories\",\"3\":\"88.0000000\"},{\"1\":\"1\",\"2\":\"fat\",\"3\":\"1.6000000\"},{\"1\":\"1\",\"2\":\"sugars\",\"3\":\"0.8000000\"},{\"1\":\"2\",\"2\":\"calories\",\"3\":\"160.0000000\"},{\"1\":\"2\",\"2\":\"fat\",\"3\":\"4.0000000\"},{\"1\":\"2\",\"2\":\"sugars\",\"3\":\"12.0000000\"},{\"1\":\"3\",\"2\":\"calories\",\"3\":\"220.0000000\"},{\"1\":\"3\",\"2\":\"fat\",\"3\":\"4.0000000\"},{\"1\":\"3\",\"2\":\"sugars\",\"3\":\"14.0000000\"},{\"1\":\"2\",\"2\":\"calories\",\"3\":\"110.0000000\"},{\"1\":\"2\",\"2\":\"fat\",\"3\":\"1.0000000\"},{\"1\":\"2\",\"2\":\"sugars\",\"3\":\"13.0000000\"},{\"1\":\"1\",\"2\":\"calories\",\"3\":\"110.0000000\"},{\"1\":\"1\",\"2\":\"fat\",\"3\":\"0.0000000\"},{\"1\":\"1\",\"2\":\"sugars\",\"3\":\"3.0000000\"},{\"1\":\"1\",\"2\":\"calories\",\"3\":\"100.0000000\"},{\"1\":\"1\",\"2\":\"fat\",\"3\":\"0.0000000\"},{\"1\":\"1\",\"2\":\"sugars\",\"3\":\"2.0000000\"},{\"1\":\"2\",\"2\":\"calories\",\"3\":\"110.0000000\"},{\"1\":\"2\",\"2\":\"fat\",\"3\":\"0.0000000\"},{\"1\":\"2\",\"2\":\"sugars\",\"3\":\"12.0000000\"},{\"1\":\"2\",\"2\":\"calories\",\"3\":\"110.0000000\"},{\"1\":\"2\",\"2\":\"fat\",\"3\":\"1.0000000\"},{\"1\":\"2\",\"2\":\"sugars\",\"3\":\"13.0000000\"},{\"1\":\"3\",\"2\":\"calories\",\"3\":\"220.0000000\"},{\"1\":\"3\",\"2\":\"fat\",\"3\":\"6.0000000\"},{\"1\":\"3\",\"2\":\"sugars\",\"3\":\"14.0000000\"},{\"1\":\"3\",\"2\":\"calories\",\"3\":\"110.0000000\"},{\"1\":\"3\",\"2\":\"fat\",\"3\":\"0.0000000\"},{\"1\":\"3\",\"2\":\"sugars\",\"3\":\"3.0000000\"},{\"1\":\"3\",\"2\":\"calories\",\"3\":\"133.3333300\"},{\"1\":\"3\",\"2\":\"fat\",\"3\":\"1.3333333\"},{\"1\":\"3\",\"2\":\"sugars\",\"3\":\"13.3333330\"},{\"1\":\"3\",\"2\":\"calories\",\"3\":\"133.3333300\"},{\"1\":\"3\",\"2\":\"fat\",\"3\":\"0.0000000\"},{\"1\":\"3\",\"2\":\"sugars\",\"3\":\"6.6666670\"},{\"1\":\"2\",\"2\":\"calories\",\"3\":\"110.0000000\"},{\"1\":\"2\",\"2\":\"fat\",\"3\":\"1.0000000\"},{\"1\":\"2\",\"2\":\"sugars\",\"3\":\"13.0000000\"},{\"1\":\"1\",\"2\":\"calories\",\"3\":\"146.6666700\"},{\"1\":\"1\",\"2\":\"fat\",\"3\":\"0.0000000\"},{\"1\":\"1\",\"2\":\"sugars\",\"3\":\"14.6666670\"},{\"1\":\"2\",\"2\":\"calories\",\"3\":\"125.0000000\"},{\"1\":\"2\",\"2\":\"fat\",\"3\":\"0.0000000\"},{\"1\":\"2\",\"2\":\"sugars\",\"3\":\"8.7500000\"},{\"1\":\"3\",\"2\":\"calories\",\"3\":\"179.1044800\"},{\"1\":\"3\",\"2\":\"fat\",\"3\":\"2.9850746\"},{\"1\":\"3\",\"2\":\"sugars\",\"3\":\"14.9253730\"},{\"1\":\"3\",\"2\":\"calories\",\"3\":\"179.1044800\"},{\"1\":\"3\",\"2\":\"fat\",\"3\":\"0.0000000\"},{\"1\":\"3\",\"2\":\"sugars\",\"3\":\"17.9104480\"},{\"1\":\"2\",\"2\":\"calories\",\"3\":\"146.6666700\"},{\"1\":\"2\",\"2\":\"fat\",\"3\":\"1.3333333\"},{\"1\":\"2\",\"2\":\"sugars\",\"3\":\"16.0000000\"},{\"1\":\"1\",\"2\":\"calories\",\"3\":\"113.6363600\"},{\"1\":\"1\",\"2\":\"fat\",\"3\":\"0.0000000\"},{\"1\":\"1\",\"2\":\"sugars\",\"3\":\"17.0454550\"},{\"1\":\"2\",\"2\":\"calories\",\"3\":\"146.6666700\"},{\"1\":\"2\",\"2\":\"fat\",\"3\":\"1.3333333\"},{\"1\":\"2\",\"2\":\"sugars\",\"3\":\"12.0000000\"},{\"1\":\"3\",\"2\":\"calories\",\"3\":\"113.6363600\"},{\"1\":\"3\",\"2\":\"fat\",\"3\":\"1.1363636\"},{\"1\":\"3\",\"2\":\"sugars\",\"3\":\"5.6818180\"},{\"1\":\"3\",\"2\":\"calories\",\"3\":\"440.0000000\"},{\"1\":\"3\",\"2\":\"fat\",\"3\":\"0.0000000\"},{\"1\":\"3\",\"2\":\"sugars\",\"3\":\"12.0000000\"},{\"1\":\"3\",\"2\":\"calories\",\"3\":\"363.6363600\"},{\"1\":\"3\",\"2\":\"fat\",\"3\":\"9.0909091\"},{\"1\":\"3\",\"2\":\"sugars\",\"3\":\"12.1212120\"},{\"1\":\"2\",\"2\":\"calories\",\"3\":\"120.0000000\"},{\"1\":\"2\",\"2\":\"fat\",\"3\":\"2.0000000\"},{\"1\":\"2\",\"2\":\"sugars\",\"3\":\"11.0000000\"},{\"1\":\"1\",\"2\":\"calories\",\"3\":\"146.6666700\"},{\"1\":\"1\",\"2\":\"fat\",\"3\":\"1.3333333\"},{\"1\":\"1\",\"2\":\"sugars\",\"3\":\"13.3333330\"},{\"1\":\"1\",\"2\":\"calories\",\"3\":\"82.7067700\"},{\"1\":\"1\",\"2\":\"fat\",\"3\":\"0.0000000\"},{\"1\":\"1\",\"2\":\"sugars\",\"3\":\"8.2706770\"},{\"1\":\"3\",\"2\":\"calories\",\"3\":\"186.6666700\"},{\"1\":\"3\",\"2\":\"fat\",\"3\":\"1.3333333\"},{\"1\":\"3\",\"2\":\"sugars\",\"3\":\"12.0000000\"},{\"1\":\"2\",\"2\":\"calories\",\"3\":\"73.3333300\"},{\"1\":\"2\",\"2\":\"fat\",\"3\":\"0.6666667\"},{\"1\":\"2\",\"2\":\"sugars\",\"3\":\"2.0000000\"},{\"1\":\"2\",\"2\":\"calories\",\"3\":\"149.2537300\"},{\"1\":\"2\",\"2\":\"fat\",\"3\":\"2.9850746\"},{\"1\":\"2\",\"2\":\"sugars\",\"3\":\"8.9552240\"},{\"1\":\"2\",\"2\":\"calories\",\"3\":\"110.0000000\"},{\"1\":\"2\",\"2\":\"fat\",\"3\":\"1.0000000\"},{\"1\":\"2\",\"2\":\"sugars\",\"3\":\"12.0000000\"},{\"1\":\"3\",\"2\":\"calories\",\"3\":\"238.8059700\"},{\"1\":\"3\",\"2\":\"fat\",\"3\":\"2.9850746\"},{\"1\":\"3\",\"2\":\"sugars\",\"3\":\"19.4029850\"},{\"1\":\"1\",\"2\":\"calories\",\"3\":\"100.0000000\"},{\"1\":\"1\",\"2\":\"fat\",\"3\":\"1.0000000\"},{\"1\":\"1\",\"2\":\"sugars\",\"3\":\"6.0000000\"},{\"1\":\"2\",\"2\":\"calories\",\"3\":\"179.1044800\"},{\"1\":\"2\",\"2\":\"fat\",\"3\":\"1.4925373\"},{\"1\":\"2\",\"2\":\"sugars\",\"3\":\"13.4328360\"},{\"1\":\"3\",\"2\":\"calories\",\"3\":\"208.9552200\"},{\"1\":\"3\",\"2\":\"fat\",\"3\":\"2.9850746\"},{\"1\":\"3\",\"2\":\"sugars\",\"3\":\"10.4477610\"},{\"1\":\"3\",\"2\":\"calories\",\"3\":\"260.0000000\"},{\"1\":\"3\",\"2\":\"fat\",\"3\":\"4.0000000\"},{\"1\":\"3\",\"2\":\"sugars\",\"3\":\"20.0000000\"},{\"1\":\"3\",\"2\":\"calories\",\"3\":\"179.1044800\"},{\"1\":\"3\",\"2\":\"fat\",\"3\":\"1.4925373\"},{\"1\":\"3\",\"2\":\"sugars\",\"3\":\"20.8955220\"},{\"1\":\"3\",\"2\":\"calories\",\"3\":\"100.0000000\"},{\"1\":\"3\",\"2\":\"fat\",\"3\":\"0.0000000\"},{\"1\":\"3\",\"2\":\"sugars\",\"3\":\"3.0000000\"},{\"1\":\"3\",\"2\":\"calories\",\"3\":\"50.0000000\"},{\"1\":\"3\",\"2\":\"fat\",\"3\":\"0.0000000\"},{\"1\":\"3\",\"2\":\"sugars\",\"3\":\"0.0000000\"},{\"1\":\"3\",\"2\":\"calories\",\"3\":\"200.0000000\"},{\"1\":\"3\",\"2\":\"fat\",\"3\":\"2.0000000\"},{\"1\":\"3\",\"2\":\"sugars\",\"3\":\"12.0000000\"},{\"1\":\"2\",\"2\":\"calories\",\"3\":\"160.0000000\"},{\"1\":\"2\",\"2\":\"fat\",\"3\":\"1.3333333\"},{\"1\":\"2\",\"2\":\"sugars\",\"3\":\"16.0000000\"},{\"1\":\"3\",\"2\":\"calories\",\"3\":\"200.0000000\"},{\"1\":\"3\",\"2\":\"fat\",\"3\":\"4.0000000\"},{\"1\":\"3\",\"2\":\"sugars\",\"3\":\"16.0000000\"},{\"1\":\"3\",\"2\":\"calories\",\"3\":\"180.0000000\"},{\"1\":\"3\",\"2\":\"fat\",\"3\":\"0.0000000\"},{\"1\":\"3\",\"2\":\"sugars\",\"3\":\"12.0000000\"},{\"1\":\"1\",\"2\":\"calories\",\"3\":\"97.3451300\"},{\"1\":\"1\",\"2\":\"fat\",\"3\":\"0.0000000\"},{\"1\":\"1\",\"2\":\"sugars\",\"3\":\"1.7699120\"},{\"1\":\"1\",\"2\":\"calories\",\"3\":\"110.0000000\"},{\"1\":\"1\",\"2\":\"fat\",\"3\":\"0.0000000\"},{\"1\":\"1\",\"2\":\"sugars\",\"3\":\"3.0000000\"},{\"1\":\"1\",\"2\":\"calories\",\"3\":\"134.3283600\"},{\"1\":\"1\",\"2\":\"fat\",\"3\":\"0.0000000\"},{\"1\":\"1\",\"2\":\"sugars\",\"3\":\"0.0000000\"},{\"1\":\"1\",\"2\":\"calories\",\"3\":\"134.3283600\"},{\"1\":\"1\",\"2\":\"fat\",\"3\":\"0.0000000\"},{\"1\":\"1\",\"2\":\"sugars\",\"3\":\"0.0000000\"},{\"1\":\"2\",\"2\":\"calories\",\"3\":\"146.6666700\"},{\"1\":\"2\",\"2\":\"fat\",\"3\":\"1.3333333\"},{\"1\":\"2\",\"2\":\"sugars\",\"3\":\"20.0000000\"},{\"1\":\"1\",\"2\":\"calories\",\"3\":\"110.0000000\"},{\"1\":\"1\",\"2\":\"fat\",\"3\":\"0.0000000\"},{\"1\":\"1\",\"2\":\"sugars\",\"3\":\"3.0000000\"},{\"1\":\"3\",\"2\":\"calories\",\"3\":\"110.0000000\"},{\"1\":\"3\",\"2\":\"fat\",\"3\":\"1.0000000\"},{\"1\":\"3\",\"2\":\"sugars\",\"3\":\"3.0000000\"},{\"1\":\"3\",\"2\":\"calories\",\"3\":\"140.0000000\"},{\"1\":\"3\",\"2\":\"fat\",\"3\":\"1.0000000\"},{\"1\":\"3\",\"2\":\"sugars\",\"3\":\"14.0000000\"},{\"1\":\"3\",\"2\":\"calories\",\"3\":\"100.0000000\"},{\"1\":\"3\",\"2\":\"fat\",\"3\":\"1.0000000\"},{\"1\":\"3\",\"2\":\"sugars\",\"3\":\"3.0000000\"},{\"1\":\"3\",\"2\":\"calories\",\"3\":\"146.6666700\"},{\"1\":\"3\",\"2\":\"fat\",\"3\":\"1.3333333\"},{\"1\":\"3\",\"2\":\"sugars\",\"3\":\"4.0000000\"},{\"1\":\"2\",\"2\":\"calories\",\"3\":\"110.0000000\"},{\"1\":\"2\",\"2\":\"fat\",\"3\":\"1.0000000\"},{\"1\":\"2\",\"2\":\"sugars\",\"3\":\"12.0000000\"},{\"1\":\"1\",\"2\":\"calories\",\"3\":\"149.2537300\"},{\"1\":\"1\",\"2\":\"fat\",\"3\":\"1.4925373\"},{\"1\":\"1\",\"2\":\"sugars\",\"3\":\"4.4776120\"},{\"1\":\"1\",\"2\":\"calories\",\"3\":\"100.0000000\"},{\"1\":\"1\",\"2\":\"fat\",\"3\":\"1.0000000\"},{\"1\":\"1\",\"2\":\"sugars\",\"3\":\"3.0000000\"},{\"1\":\"1\",\"2\":\"calories\",\"3\":\"146.6666700\"},{\"1\":\"1\",\"2\":\"fat\",\"3\":\"1.3333333\"},{\"1\":\"1\",\"2\":\"sugars\",\"3\":\"10.6666670\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n##\ngf_summary(values ~ shelf, colour = ~params, fun = \"mean\", geom = \"line\", group = ~params,\n    size = 1, title = \"Means\", caption = \"Y scales are not the same!!\", data = UScereal_long) %>%\n    gf_summary(fun = \"mean\", geom = \"point\", size = 4) %>%\n    gf_facet_wrap(vars(params), scale = \"free_y\") %>%\n    gf_theme(theme_bw)\n```\n\n::: {.cell-output-display}\n![](Two-Way-ANOVA_files/figure-html/unnamed-chunk-17-1.png){width=2100}\n:::\n\n```{.r .cell-code}\n##\ngf_summary(values ~ shelf, colour = ~params, fun = \"sd\", geom = \"point\", group = ~params,\n    size = 2, title = \"Standard Deviations\", caption = \"Y scales are not the same!!\",\n    data = UScereal_long) %>%\n    gf_summary(fun = \"sd\", geom = \"line\", size = 1) %>%\n    gf_facet_wrap(vars(params), scale = \"free_y\") %>%\n    gf_theme(theme_bw)\n```\n\n::: {.cell-output-display}\n![](Two-Way-ANOVA_files/figure-html/unnamed-chunk-17-2.png){width=2100}\n:::\n:::\n\n\nThere seem to be large differences in means and standard deviations,\nacross types of content and across shelves.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Bind the dependent variables together\ndep_vars <- cbind(UScereal$calories, UScereal$sugars, UScereal$fat)\n\n# MANOVA\nfit3 <- manova(dep_vars ~ shelf, data = UScereal)\nsummary.manova(fit3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          Df  Pillai approx F num Df den Df  Pr(>F)   \nshelf      1 0.19594    4.955      3     61 0.00383 **\nResiduals 63                                          \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary.manova(fit3,\n        test = c(\"Wilks\"), # Wilks test is \"popular in literature\"\n        intercept = FALSE, tol = 1e-7)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          Df   Wilks approx F num Df den Df  Pr(>F)   \nshelf      1 0.80406    4.955      3     61 0.00383 **\nResiduals 63                                          \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\nSo it seems that the `shelf` variable does have an effect on the amount\nof `calories`, `sugars` and `fats` in the cereals displayed. But on\nwhich ones?\n\nWe can look at the individual responses using \"univariate ANOVA\"\nsummaries:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary.aov(fit3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n Response 1 :\n            Df Sum Sq Mean Sq F value    Pr(>F)    \nshelf        1  45313   45313  13.995 0.0003983 ***\nResiduals   63 203982    3238                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n Response 2 :\n            Df  Sum Sq Mean Sq F value  Pr(>F)  \nshelf        1  183.34  183.34   5.787 0.01909 *\nResiduals   63 1995.87   31.68                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n Response 3 :\n            Df  Sum Sq Mean Sq F value   Pr(>F)   \nshelf        1  18.421 18.4214   7.476 0.008108 **\nResiduals   63 155.236  2.4641                    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\nSo the three `shelf`-ves differ substantially in each nutritional\nmeasure.\n\n## {{< iconify ooui references-rtl >}} References {#sec-references}\n\n::: {#refs style=\"font-size: 60%;\"}\n\\\nAdd references here 1. Types of ANOVA\\\n2. General Linear Hypothesis Testing\\\n\n###### {{< iconify lucide package-check >}} R Package Citations\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\nPackage     Version   Citation                                               \n----------  --------  -------------------------------------------------------\neffects     4.2.2     @effects2003; @effects2009; @effects2018; @effects2019 \nggeffects   2.3.0     @ggeffects                                             \nmultcomp    1.4.28    @multcomp                                              \n\n\n:::\n:::\n\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../../../../../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../../../../../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../../../../../../../site_libs/plotly-binding-4.11.0/plotly.js\"></script>\n<script src=\"../../../../../../../site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<script src=\"../../../../../../../site_libs/jquery-3.5.1/jquery.min.js\"></script>\n<link href=\"../../../../../../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../../../../../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n<link href=\"../../../../../../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"../../../../../../../site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\n<link href=\"../../../../../../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../../../../../../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}