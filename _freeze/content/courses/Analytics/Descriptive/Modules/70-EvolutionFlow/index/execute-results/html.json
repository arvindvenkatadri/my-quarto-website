{
  "hash": "91d37a655268a60afb7529d8aa78826a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: <iconify-icon icon=\"carbon:sankey-diagram\"></iconify-icon> Evolution and Flow\nauthor: \"Arvind V.\"\ndate: 22/Nov/2022\ndate-modified: \"2025-07-17\"\norder: 70\nabstract: \"Changes in Information over Space and Time\"\nimage: preview.jpg\nimage-alt: image from rawpixel.com\ncategories:\n- Line and Area Plots\n- Dumbbell Plots\n- Parallel Set Plots\n- Alluvial Plots\n- Sankey Diagrams\n- Chord Diagrams\n- Bump Charts\nbibliography: \n  - grateful-refs.bib\ncitation: true\n#suppress-bibliography: true\n---\n\n## {{< fa folder-open >}} Slides and Tutorials\n\n|                                                                                       |     |     |     |\n|-----------------|---------------------|-----------------|-----------------|\n| <a href=\"./files/evolutions.qmd\"><i class=\"fa-brands fa-r-project\"></i>R Tutorial</a> |     |     |     |\n\n:::: {.pa4}\n::: {.athelas .ml0 .mt0 .pl4 .black-90 .bl .bw2 .b--blue}\n[\"My stories run up and bite me in the leg -- I respond by writing them down -- everything that goes on during the bite. When I finish, the idea lets go and runs off.\"]{.f5 .f4-m .f3-l .lh-copy .measure .mt0}\n\n[ --- Ray Bradbury, science-fiction writer (22 Aug 1920-2012)]{.f6 .ttu .tracked .fs-normal}\n:::\n::::\n\n## {{< iconify noto-v1 package >}} Setting up R Packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggstream)\nlibrary(ggformula)\n# remotes::install_github(\"corybrunson/ggalluvial@main\", build_vignettes = TRUE)\nlibrary(ggalluvial)\nlibrary(ggsankeyfier)\n# install.packages(\"devtools\")\n# devtools::install_github(\"davidsjoberg/ggsankey\")\nlibrary(ggsankey)\nlibrary(networkD3)\nlibrary(echarts4r) # Interactive graphs\n\n##\nlibrary(tidyplots) # Easily Produced Publication-Ready Plots\nlibrary(tinyplot) # Plots with Base R\nlibrary(tinytable) # Elegant Tables for our data\n\nlibrary(tidyverse)\n```\n:::\n\n\n\n::: {.cell}\n\n:::\n\n\n#### Plot Fonts and Theme\n\n\n::: {.cell messages='false'}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(systemfonts)\nlibrary(showtext)\n## Clean the slate\nsystemfonts::clear_local_fonts()\nsystemfonts::clear_registry()\n##\nshowtext_opts(dpi = 96) # set DPI for showtext\nsysfonts::font_add(\n  family = \"Alegreya\",\n  regular = \"../../../../../../fonts/Alegreya-Regular.ttf\",\n  bold = \"../../../../../../fonts/Alegreya-Bold.ttf\",\n  italic = \"../../../../../../fonts/Alegreya-Italic.ttf\",\n  bolditalic = \"../../../../../../fonts/Alegreya-BoldItalic.ttf\"\n)\n\nsysfonts::font_add(\n  family = \"Roboto Condensed\",\n  regular = \"../../../../../../fonts/RobotoCondensed-Regular.ttf\",\n  bold = \"../../../../../../fonts/RobotoCondensed-Bold.ttf\",\n  italic = \"../../../../../../fonts/RobotoCondensed-Italic.ttf\",\n  bolditalic = \"../../../../../../fonts/RobotoCondensed-BoldItalic.ttf\"\n)\nshowtext_auto(enable = TRUE) # enable showtext\n##\ntheme_custom <- function() {\n  font <- \"Alegreya\" # assign font family up front\n\n  theme_classic(base_size = 14, base_family = font) %+replace% # replace elements we want to change\n\n    theme(\n      text = element_text(family = font), # set base font family\n\n      # text elements\n      plot.title = element_text( # title\n        family = font, # set font family\n        size = 24, # set font size\n        face = \"bold\", # bold typeface\n        hjust = 0, # left align\n        margin = margin(t = 5, r = 0, b = 5, l = 0)\n      ), # margin\n      plot.title.position = \"plot\",\n      plot.subtitle = element_text( # subtitle\n        family = font, # font family\n        size = 14, # font size\n        hjust = 0, # left align\n        margin = margin(t = 5, r = 0, b = 10, l = 0)\n      ), # margin\n\n      plot.caption = element_text( # caption\n        family = font, # font family\n        size = 9, # font size\n        hjust = 1\n      ), # right align\n\n      plot.caption.position = \"plot\", # right align\n\n      axis.title = element_text( # axis titles\n        family = \"Roboto Condensed\", # font family\n        size = 12\n      ), # font size\n\n      axis.text = element_text( # axis text\n        family = \"Roboto Condensed\", # font family\n        size = 9\n      ), # font size\n\n      axis.text.x = element_text( # margin for axis text\n        margin = margin(5, b = 10)\n      )\n\n      # since the legend often requires manual tweaking\n      # based on plot content, don't define it here\n    )\n}\n```\n:::\n\n\n\n::: {.cell}\n\n````{.cell-code  code-fold=\"true\"}\n```{{r}}\n#| cache: false\n#| code-fold: true\n## Set the theme\ntheme_set(new = theme_custom())\n\n## Use available fonts in ggplot text geoms too!\nupdate_geom_defaults(geom = \"text\", new = list(\n  family = \"Roboto Condensed\",\n  face = \"plain\",\n  size = 3.5,\n  color = \"#2b2b2b\"\n))\n```\n````\n:::\n\n\n\n## {{< iconify entypo line-graph >}} What Time Evolution Charts can we plot?\n\nIn these cases, the x-axis is typically *time*...and we chart the\nvariable of another Quant variable with respect to time, using a *line*\ngeometry.\n\nLet is take a healthcare budget dataset from [Our World in\nData](https://ourworldindata.org/grapher/public-health-expenditure-share-GDP-OWID):\nWe will plot graphs for 5 countries (India, China, Brazil, Russia,\nCanada ).\n\n:::callout-important\n### And Introducting `echarts4r`\nWe will also build interactive versions of these charts using `echarts4r`!\n:::\n\nDownload this data by clicking on the button below:\n\n{{< downloadthis data/public-health-expenditure-share-GDP-OWID.csv dname=\"public-health-expenditure-share-GDP-OWID\" label=\"Download the Health data\" icon=\"database-fill-down\" type=\"info\" >}}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhealth <-\n  read_csv(\"data/public-health-expenditure-share-GDP-OWID.csv\")\n\nhealth_filtered <- health %>%\n  filter(Entity %in% c(\n    \"India\",\n    \"China\",\n    \"United States\",\n    \"United Kingdom\",\n    \"Russia\",\n    \"Sweden\"\n  ))\n```\n:::\n\n\n::: {.panel-tabset .nav-pills style=\"background: whitesmoke;\"}\n### Using ggformula\n\n\n::: {.cell layout-ncol=\"2\"}\n\n```{.r .cell-code}\ngf_point(\n  data = health_filtered,\n  public_health_expenditure_pc_gdp ~ Year,\n  colour = ~Entity,\n  ylab = \"Healthcare Budget\\n as % of GDP\",\n  title = \"Line Charts to show Evolution (over Time )\"\n) %>%\n  gf_line()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=2100}\n:::\n\n```{.r .cell-code}\n###\ngf_area(\n  data = health_filtered,\n  public_health_expenditure_pc_gdp ~ Year,\n  fill = ~Entity, alpha = 0.3,\n  ylab = \"Healthcare Budget\\n as % of GDP\",\n  title = \"Area Charts to show Evolution (over Time )\"\n) %>%\n  gf_line(colour = ~Entity)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-2.png){width=2100}\n:::\n:::\n\n\n### Using echarts4r\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhealth_filtered %>%\n  group_by(Entity) %>%\n  e_charts(Year) %>%\n  e_scatter(public_health_expenditure_pc_gdp) %>%\n  e_line(public_health_expenditure_pc_gdp) %>%\n  e_x_axis(name = \"Year\", min = 1850, max = 2050) %>%\n  e_y_axis(\n    name = \"Public Health Expenditure\",\n    nameLocation = \"middle\", nameGap = 25\n  ) %>%\n  e_tooltip()\n###\nhealth_filtered %>%\n  group_by(Entity) %>%\n  e_charts(Year) %>%\n  e_scatter(public_health_expenditure_pc_gdp) %>%\n  e_area(public_health_expenditure_pc_gdp) %>%\n  e_x_axis(name = \"Year\", min = 1850, max = 2050) %>%\n  e_y_axis(\n    name = \"Public Health Expenditure\",\n    nameLocation = \"middle\", nameGap = 25\n  ) %>%\n  e_tooltip()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"echarts4r html-widget html-fill-item\" id=\"htmlwidget-d8248b7eae67e340cfe8\" style=\"width:100%;height:500px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-d8248b7eae67e340cfe8\">{\"x\":{\"theme\":\"\",\"tl\":false,\"draw\":true,\"renderer\":\"canvas\",\"events\":[],\"buttons\":[],\"opts\":{\"yAxis\":[{\"show\":true,\"name\":\"Public Health Expenditure\",\"nameLocation\":\"middle\",\"nameGap\":25}],\"xAxis\":[{\"type\":\"value\",\"name\":\"Year\",\"min\":1850,\"max\":2050}],\"legend\":{\"data\":[\"China\",\"India\",\"Sweden\",\"United Kingdom\",\"United States\",\"China\",\"India\",\"Sweden\",\"United Kingdom\",\"United States\"]},\"series\":[{\"data\":[{\"value\":[2000,0.986]},{\"value\":[2001,0.971]},{\"value\":[2002,1.109]},{\"value\":[2003,1.251]},{\"value\":[2004,1.295]},{\"value\":[2005,1.37]},{\"value\":[2006,1.391]},{\"value\":[2007,1.436]},{\"value\":[2008,1.73]},{\"value\":[2009,2.143]},{\"value\":[2010,2.177]},{\"value\":[2011,2.315]},{\"value\":[2012,2.547]},{\"value\":[2013,2.705]},{\"value\":[2014,2.804]},{\"value\":[2015,2.986]},{\"value\":[2016,2.892]},{\"value\":[2017,2.86]},{\"value\":[2018,2.914]},{\"value\":[2019,3.002]}],\"name\":\"China\",\"type\":\"scatter\",\"symbol\":null,\"coordinateSystem\":\"cartesian2d\",\"yAxisIndex\":0,\"xAxisIndex\":0,\"symbolSize\":3},{\"data\":[{\"value\":[2000,0.9389999999999999]},{\"value\":[2001,0.909]},{\"value\":[2002,0.877]},{\"value\":[2003,0.819]},{\"value\":[2004,0.801]},{\"value\":[2005,0.828]},{\"value\":[2006,0.805]},{\"value\":[2007,0.795]},{\"value\":[2008,0.836]},{\"value\":[2009,0.907]},{\"value\":[2010,0.862]},{\"value\":[2011,0.91]},{\"value\":[2012,0.903]},{\"value\":[2013,0.829]},{\"value\":[2014,0.829]},{\"value\":[2015,0.928]},{\"value\":[2016,0.947]},{\"value\":[2017,0.974]},{\"value\":[2018,0.972]},{\"value\":[2019,0.998]}],\"name\":\"India\",\"type\":\"scatter\",\"symbol\":null,\"coordinateSystem\":\"cartesian2d\",\"yAxisIndex\":0,\"xAxisIndex\":0,\"symbolSize\":3},{\"data\":[{\"value\":[1880,0.12]},{\"value\":[1890,0.16]},{\"value\":[1900,0.19]},{\"value\":[1910,0.31]},{\"value\":[1920,0.25]},{\"value\":[1930,0.89]},{\"value\":[1960,2.50564019448947]},{\"value\":[1961,2.56459643435981]},{\"value\":[1962,2.62355267423015]},{\"value\":[1963,2.9699205834684]},{\"value\":[1964,3.07309400324149]},{\"value\":[1965,3.2647017828201]},{\"value\":[1966,3.60370016207455]},{\"value\":[1967,3.8542641815235]},{\"value\":[1968,4.24484927066451]},{\"value\":[1969,4.29643598055105]},{\"value\":[1970,4.547]},{\"value\":[1971,4.984]},{\"value\":[1972,5.073]},{\"value\":[1973,5.031]},{\"value\":[1974,5.498]},{\"value\":[1975,5.769]},{\"value\":[1976,6.021]},{\"value\":[1977,6.784]},{\"value\":[1978,6.841]},{\"value\":[1979,6.757]},{\"value\":[1980,7.107]},{\"value\":[1981,7.142]},{\"value\":[1982,7.197]},{\"value\":[1983,7.109]},{\"value\":[1984,6.942]},{\"value\":[1985,6.484]},{\"value\":[1986,6.286]},{\"value\":[1987,6.359]},{\"value\":[1988,6.256]},{\"value\":[1989,6.32]},{\"value\":[1990,5.692]},{\"value\":[1991,5.558]},{\"value\":[1992,6.471]},{\"value\":[1993,6.693]},{\"value\":[1994,6.348]},{\"value\":[1995,6.24]},{\"value\":[1996,6.456]},{\"value\":[1997,6.202]},{\"value\":[1998,6.255]},{\"value\":[1999,6.291]},{\"value\":[2000,6.267]},{\"value\":[2001,6.49]},{\"value\":[2002,6.779]},{\"value\":[2003,6.914]},{\"value\":[2004,6.722]},{\"value\":[2005,6.708]},{\"value\":[2006,6.632]},{\"value\":[2007,6.598]},{\"value\":[2008,6.772]},{\"value\":[2009,7.237]},{\"value\":[2010,6.863]},{\"value\":[2011,8.800000000000001]},{\"value\":[2012,9.041]},{\"value\":[2013,9.162000000000001]},{\"value\":[2014,9.199]},{\"value\":[2015,9.071]},{\"value\":[2016,9.144]},{\"value\":[2017,9.135999999999999]},{\"value\":[2018,9.276]},{\"value\":[2019,9.221]},{\"value\":[2020,9.877000000000001]},{\"value\":[2021,9.787000000000001]}],\"name\":\"Sweden\",\"type\":\"scatter\",\"symbol\":null,\"coordinateSystem\":\"cartesian2d\",\"yAxisIndex\":0,\"xAxisIndex\":0,\"symbolSize\":3},{\"data\":[{\"value\":[1880,0.13]},{\"value\":[1890,0.16]},{\"value\":[1900,0.29]},{\"value\":[1910,0.32]},{\"value\":[1920,0.5600000000000001]},{\"value\":[1930,0.64]},{\"value\":[1960,2.92035038363171]},{\"value\":[1961,2.97296930946292]},{\"value\":[1962,2.95542966751918]},{\"value\":[1963,2.97296930946292]},{\"value\":[1964,2.96419948849105]},{\"value\":[1965,3.10451662404092]},{\"value\":[1966,3.22729411764706]},{\"value\":[1967,3.39392071611253]},{\"value\":[1968,3.4026905370844]},{\"value\":[1969,3.30622250639386]},{\"value\":[1970,3.429]},{\"value\":[1971,3.469]},{\"value\":[1972,3.557]},{\"value\":[1973,3.476]},{\"value\":[1974,4.143]},{\"value\":[1975,4.486]},{\"value\":[1976,4.487]},{\"value\":[1977,4.378]},{\"value\":[1978,4.351]},{\"value\":[1979,4.252]},{\"value\":[1980,4.532]},{\"value\":[1981,4.71]},{\"value\":[1982,4.498]},{\"value\":[1983,4.666]},{\"value\":[1984,4.563]},{\"value\":[1985,4.428]},{\"value\":[1986,4.407]},{\"value\":[1987,4.421]},{\"value\":[1988,4.331]},{\"value\":[1989,4.249]},{\"value\":[1990,4.291]},{\"value\":[1991,4.586]},{\"value\":[1992,4.975]},{\"value\":[1993,5.066]},{\"value\":[1994,5.091]},{\"value\":[1995,4.668]},{\"value\":[1996,4.659]},{\"value\":[1997,5.135]},{\"value\":[1998,5.263]},{\"value\":[1999,5.463]},{\"value\":[2000,5.476]},{\"value\":[2001,5.737]},{\"value\":[2002,6.103]},{\"value\":[2003,6.316]},{\"value\":[2004,6.664]},{\"value\":[2005,6.792]},{\"value\":[2006,6.996]},{\"value\":[2007,6.996]},{\"value\":[2008,7.304]},{\"value\":[2009,8.090999999999999]},{\"value\":[2010,8.006]},{\"value\":[2011,7.973]},{\"value\":[2012,7.957]},{\"value\":[2013,7.857]},{\"value\":[2014,7.85]},{\"value\":[2015,7.779]},{\"value\":[2016,7.772]},{\"value\":[2017,7.631]},{\"value\":[2018,7.658]},{\"value\":[2019,7.836]},{\"value\":[2020,9.923]},{\"value\":[2021,9.898]}],\"name\":\"United Kingdom\",\"type\":\"scatter\",\"symbol\":null,\"coordinateSystem\":\"cartesian2d\",\"yAxisIndex\":0,\"xAxisIndex\":0,\"symbolSize\":3},{\"data\":[{\"value\":[1880,0.09]},{\"value\":[1890,0.14]},{\"value\":[1900,0.17]},{\"value\":[1910,0.26]},{\"value\":[1920,0.4]},{\"value\":[1930,0.34]},{\"value\":[1960,1.09367518248175]},{\"value\":[1961,1.1615]},{\"value\":[1962,1.17845620437956]},{\"value\":[1963,1.22084671532847]},{\"value\":[1964,1.22084671532847]},{\"value\":[1965,1.23780291970803]},{\"value\":[1966,1.49214598540146]},{\"value\":[1967,1.99235401459854]},{\"value\":[1968,2.11952554744526]},{\"value\":[1969,2.17039416058394]},{\"value\":[1970,2.323]},{\"value\":[1971,2.433]},{\"value\":[1972,2.491]},{\"value\":[1973,2.538]},{\"value\":[1974,2.769]},{\"value\":[1975,2.988]},{\"value\":[1976,3.049]},{\"value\":[1977,3.114]},{\"value\":[1978,3.14]},{\"value\":[1979,3.217]},{\"value\":[1980,3.458]},{\"value\":[1981,3.579]},{\"value\":[1982,3.822]},{\"value\":[1983,3.871]},{\"value\":[1984,3.786]},{\"value\":[1985,3.832]},{\"value\":[1986,3.973]},{\"value\":[1987,4.101]},{\"value\":[1988,4.125]},{\"value\":[1989,4.27]},{\"value\":[1990,4.543]},{\"value\":[1991,5.001]},{\"value\":[1992,5.283]},{\"value\":[1993,5.531]},{\"value\":[1994,5.689]},{\"value\":[1995,5.798]},{\"value\":[1996,6.242]},{\"value\":[1997,5.717]},{\"value\":[1998,5.56]},{\"value\":[1999,5.502]},{\"value\":[2000,5.543]},{\"value\":[2001,5.968]},{\"value\":[2002,6.326]},{\"value\":[2003,6.523]},{\"value\":[2004,6.608]},{\"value\":[2005,6.628]},{\"value\":[2006,6.781]},{\"value\":[2007,6.886]},{\"value\":[2008,7.198]},{\"value\":[2009,7.833]},{\"value\":[2010,7.889]},{\"value\":[2011,7.876]},{\"value\":[2012,7.853]},{\"value\":[2013,7.907]},{\"value\":[2014,13.372]},{\"value\":[2015,13.664]},{\"value\":[2016,13.912]},{\"value\":[2017,13.89]},{\"value\":[2018,13.796]},{\"value\":[2019,13.813]},{\"value\":[2020,15.949]}],\"name\":\"United States\",\"type\":\"scatter\",\"symbol\":null,\"coordinateSystem\":\"cartesian2d\",\"yAxisIndex\":0,\"xAxisIndex\":0,\"symbolSize\":3},{\"data\":[{\"value\":[2000,0.986]},{\"value\":[2001,0.971]},{\"value\":[2002,1.109]},{\"value\":[2003,1.251]},{\"value\":[2004,1.295]},{\"value\":[2005,1.37]},{\"value\":[2006,1.391]},{\"value\":[2007,1.436]},{\"value\":[2008,1.73]},{\"value\":[2009,2.143]},{\"value\":[2010,2.177]},{\"value\":[2011,2.315]},{\"value\":[2012,2.547]},{\"value\":[2013,2.705]},{\"value\":[2014,2.804]},{\"value\":[2015,2.986]},{\"value\":[2016,2.892]},{\"value\":[2017,2.86]},{\"value\":[2018,2.914]},{\"value\":[2019,3.002]}],\"yAxisIndex\":0,\"xAxisIndex\":0,\"name\":\"China\",\"type\":\"line\",\"coordinateSystem\":\"cartesian2d\"},{\"data\":[{\"value\":[2000,0.9389999999999999]},{\"value\":[2001,0.909]},{\"value\":[2002,0.877]},{\"value\":[2003,0.819]},{\"value\":[2004,0.801]},{\"value\":[2005,0.828]},{\"value\":[2006,0.805]},{\"value\":[2007,0.795]},{\"value\":[2008,0.836]},{\"value\":[2009,0.907]},{\"value\":[2010,0.862]},{\"value\":[2011,0.91]},{\"value\":[2012,0.903]},{\"value\":[2013,0.829]},{\"value\":[2014,0.829]},{\"value\":[2015,0.928]},{\"value\":[2016,0.947]},{\"value\":[2017,0.974]},{\"value\":[2018,0.972]},{\"value\":[2019,0.998]}],\"yAxisIndex\":0,\"xAxisIndex\":0,\"name\":\"India\",\"type\":\"line\",\"coordinateSystem\":\"cartesian2d\"},{\"data\":[{\"value\":[1880,0.12]},{\"value\":[1890,0.16]},{\"value\":[1900,0.19]},{\"value\":[1910,0.31]},{\"value\":[1920,0.25]},{\"value\":[1930,0.89]},{\"value\":[1960,2.50564019448947]},{\"value\":[1961,2.56459643435981]},{\"value\":[1962,2.62355267423015]},{\"value\":[1963,2.9699205834684]},{\"value\":[1964,3.07309400324149]},{\"value\":[1965,3.2647017828201]},{\"value\":[1966,3.60370016207455]},{\"value\":[1967,3.8542641815235]},{\"value\":[1968,4.24484927066451]},{\"value\":[1969,4.29643598055105]},{\"value\":[1970,4.547]},{\"value\":[1971,4.984]},{\"value\":[1972,5.073]},{\"value\":[1973,5.031]},{\"value\":[1974,5.498]},{\"value\":[1975,5.769]},{\"value\":[1976,6.021]},{\"value\":[1977,6.784]},{\"value\":[1978,6.841]},{\"value\":[1979,6.757]},{\"value\":[1980,7.107]},{\"value\":[1981,7.142]},{\"value\":[1982,7.197]},{\"value\":[1983,7.109]},{\"value\":[1984,6.942]},{\"value\":[1985,6.484]},{\"value\":[1986,6.286]},{\"value\":[1987,6.359]},{\"value\":[1988,6.256]},{\"value\":[1989,6.32]},{\"value\":[1990,5.692]},{\"value\":[1991,5.558]},{\"value\":[1992,6.471]},{\"value\":[1993,6.693]},{\"value\":[1994,6.348]},{\"value\":[1995,6.24]},{\"value\":[1996,6.456]},{\"value\":[1997,6.202]},{\"value\":[1998,6.255]},{\"value\":[1999,6.291]},{\"value\":[2000,6.267]},{\"value\":[2001,6.49]},{\"value\":[2002,6.779]},{\"value\":[2003,6.914]},{\"value\":[2004,6.722]},{\"value\":[2005,6.708]},{\"value\":[2006,6.632]},{\"value\":[2007,6.598]},{\"value\":[2008,6.772]},{\"value\":[2009,7.237]},{\"value\":[2010,6.863]},{\"value\":[2011,8.800000000000001]},{\"value\":[2012,9.041]},{\"value\":[2013,9.162000000000001]},{\"value\":[2014,9.199]},{\"value\":[2015,9.071]},{\"value\":[2016,9.144]},{\"value\":[2017,9.135999999999999]},{\"value\":[2018,9.276]},{\"value\":[2019,9.221]},{\"value\":[2020,9.877000000000001]},{\"value\":[2021,9.787000000000001]}],\"yAxisIndex\":0,\"xAxisIndex\":0,\"name\":\"Sweden\",\"type\":\"line\",\"coordinateSystem\":\"cartesian2d\"},{\"data\":[{\"value\":[1880,0.13]},{\"value\":[1890,0.16]},{\"value\":[1900,0.29]},{\"value\":[1910,0.32]},{\"value\":[1920,0.5600000000000001]},{\"value\":[1930,0.64]},{\"value\":[1960,2.92035038363171]},{\"value\":[1961,2.97296930946292]},{\"value\":[1962,2.95542966751918]},{\"value\":[1963,2.97296930946292]},{\"value\":[1964,2.96419948849105]},{\"value\":[1965,3.10451662404092]},{\"value\":[1966,3.22729411764706]},{\"value\":[1967,3.39392071611253]},{\"value\":[1968,3.4026905370844]},{\"value\":[1969,3.30622250639386]},{\"value\":[1970,3.429]},{\"value\":[1971,3.469]},{\"value\":[1972,3.557]},{\"value\":[1973,3.476]},{\"value\":[1974,4.143]},{\"value\":[1975,4.486]},{\"value\":[1976,4.487]},{\"value\":[1977,4.378]},{\"value\":[1978,4.351]},{\"value\":[1979,4.252]},{\"value\":[1980,4.532]},{\"value\":[1981,4.71]},{\"value\":[1982,4.498]},{\"value\":[1983,4.666]},{\"value\":[1984,4.563]},{\"value\":[1985,4.428]},{\"value\":[1986,4.407]},{\"value\":[1987,4.421]},{\"value\":[1988,4.331]},{\"value\":[1989,4.249]},{\"value\":[1990,4.291]},{\"value\":[1991,4.586]},{\"value\":[1992,4.975]},{\"value\":[1993,5.066]},{\"value\":[1994,5.091]},{\"value\":[1995,4.668]},{\"value\":[1996,4.659]},{\"value\":[1997,5.135]},{\"value\":[1998,5.263]},{\"value\":[1999,5.463]},{\"value\":[2000,5.476]},{\"value\":[2001,5.737]},{\"value\":[2002,6.103]},{\"value\":[2003,6.316]},{\"value\":[2004,6.664]},{\"value\":[2005,6.792]},{\"value\":[2006,6.996]},{\"value\":[2007,6.996]},{\"value\":[2008,7.304]},{\"value\":[2009,8.090999999999999]},{\"value\":[2010,8.006]},{\"value\":[2011,7.973]},{\"value\":[2012,7.957]},{\"value\":[2013,7.857]},{\"value\":[2014,7.85]},{\"value\":[2015,7.779]},{\"value\":[2016,7.772]},{\"value\":[2017,7.631]},{\"value\":[2018,7.658]},{\"value\":[2019,7.836]},{\"value\":[2020,9.923]},{\"value\":[2021,9.898]}],\"yAxisIndex\":0,\"xAxisIndex\":0,\"name\":\"United Kingdom\",\"type\":\"line\",\"coordinateSystem\":\"cartesian2d\"},{\"data\":[{\"value\":[1880,0.09]},{\"value\":[1890,0.14]},{\"value\":[1900,0.17]},{\"value\":[1910,0.26]},{\"value\":[1920,0.4]},{\"value\":[1930,0.34]},{\"value\":[1960,1.09367518248175]},{\"value\":[1961,1.1615]},{\"value\":[1962,1.17845620437956]},{\"value\":[1963,1.22084671532847]},{\"value\":[1964,1.22084671532847]},{\"value\":[1965,1.23780291970803]},{\"value\":[1966,1.49214598540146]},{\"value\":[1967,1.99235401459854]},{\"value\":[1968,2.11952554744526]},{\"value\":[1969,2.17039416058394]},{\"value\":[1970,2.323]},{\"value\":[1971,2.433]},{\"value\":[1972,2.491]},{\"value\":[1973,2.538]},{\"value\":[1974,2.769]},{\"value\":[1975,2.988]},{\"value\":[1976,3.049]},{\"value\":[1977,3.114]},{\"value\":[1978,3.14]},{\"value\":[1979,3.217]},{\"value\":[1980,3.458]},{\"value\":[1981,3.579]},{\"value\":[1982,3.822]},{\"value\":[1983,3.871]},{\"value\":[1984,3.786]},{\"value\":[1985,3.832]},{\"value\":[1986,3.973]},{\"value\":[1987,4.101]},{\"value\":[1988,4.125]},{\"value\":[1989,4.27]},{\"value\":[1990,4.543]},{\"value\":[1991,5.001]},{\"value\":[1992,5.283]},{\"value\":[1993,5.531]},{\"value\":[1994,5.689]},{\"value\":[1995,5.798]},{\"value\":[1996,6.242]},{\"value\":[1997,5.717]},{\"value\":[1998,5.56]},{\"value\":[1999,5.502]},{\"value\":[2000,5.543]},{\"value\":[2001,5.968]},{\"value\":[2002,6.326]},{\"value\":[2003,6.523]},{\"value\":[2004,6.608]},{\"value\":[2005,6.628]},{\"value\":[2006,6.781]},{\"value\":[2007,6.886]},{\"value\":[2008,7.198]},{\"value\":[2009,7.833]},{\"value\":[2010,7.889]},{\"value\":[2011,7.876]},{\"value\":[2012,7.853]},{\"value\":[2013,7.907]},{\"value\":[2014,13.372]},{\"value\":[2015,13.664]},{\"value\":[2016,13.912]},{\"value\":[2017,13.89]},{\"value\":[2018,13.796]},{\"value\":[2019,13.813]},{\"value\":[2020,15.949]}],\"yAxisIndex\":0,\"xAxisIndex\":0,\"name\":\"United States\",\"type\":\"line\",\"coordinateSystem\":\"cartesian2d\"}],\"tooltip\":{\"trigger\":\"item\"}},\"dispose\":true},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n```{=html}\n<div class=\"echarts4r html-widget html-fill-item\" id=\"htmlwidget-b3c7337f5d0787657879\" style=\"width:100%;height:500px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-b3c7337f5d0787657879\">{\"x\":{\"theme\":\"\",\"tl\":false,\"draw\":true,\"renderer\":\"canvas\",\"events\":[],\"buttons\":[],\"opts\":{\"yAxis\":[{\"show\":true,\"name\":\"Public Health Expenditure\",\"nameLocation\":\"middle\",\"nameGap\":25}],\"xAxis\":[{\"type\":\"value\",\"name\":\"Year\",\"min\":1850,\"max\":2050}],\"legend\":{\"data\":[\"China\",\"India\",\"Sweden\",\"United Kingdom\",\"United States\",\"China\",\"India\",\"Sweden\",\"United Kingdom\",\"United States\"]},\"series\":[{\"data\":[{\"value\":[2000,0.986]},{\"value\":[2001,0.971]},{\"value\":[2002,1.109]},{\"value\":[2003,1.251]},{\"value\":[2004,1.295]},{\"value\":[2005,1.37]},{\"value\":[2006,1.391]},{\"value\":[2007,1.436]},{\"value\":[2008,1.73]},{\"value\":[2009,2.143]},{\"value\":[2010,2.177]},{\"value\":[2011,2.315]},{\"value\":[2012,2.547]},{\"value\":[2013,2.705]},{\"value\":[2014,2.804]},{\"value\":[2015,2.986]},{\"value\":[2016,2.892]},{\"value\":[2017,2.86]},{\"value\":[2018,2.914]},{\"value\":[2019,3.002]}],\"name\":\"China\",\"type\":\"scatter\",\"symbol\":null,\"coordinateSystem\":\"cartesian2d\",\"yAxisIndex\":0,\"xAxisIndex\":0,\"symbolSize\":3},{\"data\":[{\"value\":[2000,0.9389999999999999]},{\"value\":[2001,0.909]},{\"value\":[2002,0.877]},{\"value\":[2003,0.819]},{\"value\":[2004,0.801]},{\"value\":[2005,0.828]},{\"value\":[2006,0.805]},{\"value\":[2007,0.795]},{\"value\":[2008,0.836]},{\"value\":[2009,0.907]},{\"value\":[2010,0.862]},{\"value\":[2011,0.91]},{\"value\":[2012,0.903]},{\"value\":[2013,0.829]},{\"value\":[2014,0.829]},{\"value\":[2015,0.928]},{\"value\":[2016,0.947]},{\"value\":[2017,0.974]},{\"value\":[2018,0.972]},{\"value\":[2019,0.998]}],\"name\":\"India\",\"type\":\"scatter\",\"symbol\":null,\"coordinateSystem\":\"cartesian2d\",\"yAxisIndex\":0,\"xAxisIndex\":0,\"symbolSize\":3},{\"data\":[{\"value\":[1880,0.12]},{\"value\":[1890,0.16]},{\"value\":[1900,0.19]},{\"value\":[1910,0.31]},{\"value\":[1920,0.25]},{\"value\":[1930,0.89]},{\"value\":[1960,2.50564019448947]},{\"value\":[1961,2.56459643435981]},{\"value\":[1962,2.62355267423015]},{\"value\":[1963,2.9699205834684]},{\"value\":[1964,3.07309400324149]},{\"value\":[1965,3.2647017828201]},{\"value\":[1966,3.60370016207455]},{\"value\":[1967,3.8542641815235]},{\"value\":[1968,4.24484927066451]},{\"value\":[1969,4.29643598055105]},{\"value\":[1970,4.547]},{\"value\":[1971,4.984]},{\"value\":[1972,5.073]},{\"value\":[1973,5.031]},{\"value\":[1974,5.498]},{\"value\":[1975,5.769]},{\"value\":[1976,6.021]},{\"value\":[1977,6.784]},{\"value\":[1978,6.841]},{\"value\":[1979,6.757]},{\"value\":[1980,7.107]},{\"value\":[1981,7.142]},{\"value\":[1982,7.197]},{\"value\":[1983,7.109]},{\"value\":[1984,6.942]},{\"value\":[1985,6.484]},{\"value\":[1986,6.286]},{\"value\":[1987,6.359]},{\"value\":[1988,6.256]},{\"value\":[1989,6.32]},{\"value\":[1990,5.692]},{\"value\":[1991,5.558]},{\"value\":[1992,6.471]},{\"value\":[1993,6.693]},{\"value\":[1994,6.348]},{\"value\":[1995,6.24]},{\"value\":[1996,6.456]},{\"value\":[1997,6.202]},{\"value\":[1998,6.255]},{\"value\":[1999,6.291]},{\"value\":[2000,6.267]},{\"value\":[2001,6.49]},{\"value\":[2002,6.779]},{\"value\":[2003,6.914]},{\"value\":[2004,6.722]},{\"value\":[2005,6.708]},{\"value\":[2006,6.632]},{\"value\":[2007,6.598]},{\"value\":[2008,6.772]},{\"value\":[2009,7.237]},{\"value\":[2010,6.863]},{\"value\":[2011,8.800000000000001]},{\"value\":[2012,9.041]},{\"value\":[2013,9.162000000000001]},{\"value\":[2014,9.199]},{\"value\":[2015,9.071]},{\"value\":[2016,9.144]},{\"value\":[2017,9.135999999999999]},{\"value\":[2018,9.276]},{\"value\":[2019,9.221]},{\"value\":[2020,9.877000000000001]},{\"value\":[2021,9.787000000000001]}],\"name\":\"Sweden\",\"type\":\"scatter\",\"symbol\":null,\"coordinateSystem\":\"cartesian2d\",\"yAxisIndex\":0,\"xAxisIndex\":0,\"symbolSize\":3},{\"data\":[{\"value\":[1880,0.13]},{\"value\":[1890,0.16]},{\"value\":[1900,0.29]},{\"value\":[1910,0.32]},{\"value\":[1920,0.5600000000000001]},{\"value\":[1930,0.64]},{\"value\":[1960,2.92035038363171]},{\"value\":[1961,2.97296930946292]},{\"value\":[1962,2.95542966751918]},{\"value\":[1963,2.97296930946292]},{\"value\":[1964,2.96419948849105]},{\"value\":[1965,3.10451662404092]},{\"value\":[1966,3.22729411764706]},{\"value\":[1967,3.39392071611253]},{\"value\":[1968,3.4026905370844]},{\"value\":[1969,3.30622250639386]},{\"value\":[1970,3.429]},{\"value\":[1971,3.469]},{\"value\":[1972,3.557]},{\"value\":[1973,3.476]},{\"value\":[1974,4.143]},{\"value\":[1975,4.486]},{\"value\":[1976,4.487]},{\"value\":[1977,4.378]},{\"value\":[1978,4.351]},{\"value\":[1979,4.252]},{\"value\":[1980,4.532]},{\"value\":[1981,4.71]},{\"value\":[1982,4.498]},{\"value\":[1983,4.666]},{\"value\":[1984,4.563]},{\"value\":[1985,4.428]},{\"value\":[1986,4.407]},{\"value\":[1987,4.421]},{\"value\":[1988,4.331]},{\"value\":[1989,4.249]},{\"value\":[1990,4.291]},{\"value\":[1991,4.586]},{\"value\":[1992,4.975]},{\"value\":[1993,5.066]},{\"value\":[1994,5.091]},{\"value\":[1995,4.668]},{\"value\":[1996,4.659]},{\"value\":[1997,5.135]},{\"value\":[1998,5.263]},{\"value\":[1999,5.463]},{\"value\":[2000,5.476]},{\"value\":[2001,5.737]},{\"value\":[2002,6.103]},{\"value\":[2003,6.316]},{\"value\":[2004,6.664]},{\"value\":[2005,6.792]},{\"value\":[2006,6.996]},{\"value\":[2007,6.996]},{\"value\":[2008,7.304]},{\"value\":[2009,8.090999999999999]},{\"value\":[2010,8.006]},{\"value\":[2011,7.973]},{\"value\":[2012,7.957]},{\"value\":[2013,7.857]},{\"value\":[2014,7.85]},{\"value\":[2015,7.779]},{\"value\":[2016,7.772]},{\"value\":[2017,7.631]},{\"value\":[2018,7.658]},{\"value\":[2019,7.836]},{\"value\":[2020,9.923]},{\"value\":[2021,9.898]}],\"name\":\"United Kingdom\",\"type\":\"scatter\",\"symbol\":null,\"coordinateSystem\":\"cartesian2d\",\"yAxisIndex\":0,\"xAxisIndex\":0,\"symbolSize\":3},{\"data\":[{\"value\":[1880,0.09]},{\"value\":[1890,0.14]},{\"value\":[1900,0.17]},{\"value\":[1910,0.26]},{\"value\":[1920,0.4]},{\"value\":[1930,0.34]},{\"value\":[1960,1.09367518248175]},{\"value\":[1961,1.1615]},{\"value\":[1962,1.17845620437956]},{\"value\":[1963,1.22084671532847]},{\"value\":[1964,1.22084671532847]},{\"value\":[1965,1.23780291970803]},{\"value\":[1966,1.49214598540146]},{\"value\":[1967,1.99235401459854]},{\"value\":[1968,2.11952554744526]},{\"value\":[1969,2.17039416058394]},{\"value\":[1970,2.323]},{\"value\":[1971,2.433]},{\"value\":[1972,2.491]},{\"value\":[1973,2.538]},{\"value\":[1974,2.769]},{\"value\":[1975,2.988]},{\"value\":[1976,3.049]},{\"value\":[1977,3.114]},{\"value\":[1978,3.14]},{\"value\":[1979,3.217]},{\"value\":[1980,3.458]},{\"value\":[1981,3.579]},{\"value\":[1982,3.822]},{\"value\":[1983,3.871]},{\"value\":[1984,3.786]},{\"value\":[1985,3.832]},{\"value\":[1986,3.973]},{\"value\":[1987,4.101]},{\"value\":[1988,4.125]},{\"value\":[1989,4.27]},{\"value\":[1990,4.543]},{\"value\":[1991,5.001]},{\"value\":[1992,5.283]},{\"value\":[1993,5.531]},{\"value\":[1994,5.689]},{\"value\":[1995,5.798]},{\"value\":[1996,6.242]},{\"value\":[1997,5.717]},{\"value\":[1998,5.56]},{\"value\":[1999,5.502]},{\"value\":[2000,5.543]},{\"value\":[2001,5.968]},{\"value\":[2002,6.326]},{\"value\":[2003,6.523]},{\"value\":[2004,6.608]},{\"value\":[2005,6.628]},{\"value\":[2006,6.781]},{\"value\":[2007,6.886]},{\"value\":[2008,7.198]},{\"value\":[2009,7.833]},{\"value\":[2010,7.889]},{\"value\":[2011,7.876]},{\"value\":[2012,7.853]},{\"value\":[2013,7.907]},{\"value\":[2014,13.372]},{\"value\":[2015,13.664]},{\"value\":[2016,13.912]},{\"value\":[2017,13.89]},{\"value\":[2018,13.796]},{\"value\":[2019,13.813]},{\"value\":[2020,15.949]}],\"name\":\"United States\",\"type\":\"scatter\",\"symbol\":null,\"coordinateSystem\":\"cartesian2d\",\"yAxisIndex\":0,\"xAxisIndex\":0,\"symbolSize\":3},{\"data\":[{\"value\":[2000,0.986]},{\"value\":[2001,0.971]},{\"value\":[2002,1.109]},{\"value\":[2003,1.251]},{\"value\":[2004,1.295]},{\"value\":[2005,1.37]},{\"value\":[2006,1.391]},{\"value\":[2007,1.436]},{\"value\":[2008,1.73]},{\"value\":[2009,2.143]},{\"value\":[2010,2.177]},{\"value\":[2011,2.315]},{\"value\":[2012,2.547]},{\"value\":[2013,2.705]},{\"value\":[2014,2.804]},{\"value\":[2015,2.986]},{\"value\":[2016,2.892]},{\"value\":[2017,2.86]},{\"value\":[2018,2.914]},{\"value\":[2019,3.002]}],\"yAxisIndex\":0,\"xAxisIndex\":0,\"name\":\"China\",\"type\":\"line\",\"coordinateSystem\":\"cartesian2d\",\"areaStyle\":[]},{\"data\":[{\"value\":[2000,0.9389999999999999]},{\"value\":[2001,0.909]},{\"value\":[2002,0.877]},{\"value\":[2003,0.819]},{\"value\":[2004,0.801]},{\"value\":[2005,0.828]},{\"value\":[2006,0.805]},{\"value\":[2007,0.795]},{\"value\":[2008,0.836]},{\"value\":[2009,0.907]},{\"value\":[2010,0.862]},{\"value\":[2011,0.91]},{\"value\":[2012,0.903]},{\"value\":[2013,0.829]},{\"value\":[2014,0.829]},{\"value\":[2015,0.928]},{\"value\":[2016,0.947]},{\"value\":[2017,0.974]},{\"value\":[2018,0.972]},{\"value\":[2019,0.998]}],\"yAxisIndex\":0,\"xAxisIndex\":0,\"name\":\"India\",\"type\":\"line\",\"coordinateSystem\":\"cartesian2d\",\"areaStyle\":[]},{\"data\":[{\"value\":[1880,0.12]},{\"value\":[1890,0.16]},{\"value\":[1900,0.19]},{\"value\":[1910,0.31]},{\"value\":[1920,0.25]},{\"value\":[1930,0.89]},{\"value\":[1960,2.50564019448947]},{\"value\":[1961,2.56459643435981]},{\"value\":[1962,2.62355267423015]},{\"value\":[1963,2.9699205834684]},{\"value\":[1964,3.07309400324149]},{\"value\":[1965,3.2647017828201]},{\"value\":[1966,3.60370016207455]},{\"value\":[1967,3.8542641815235]},{\"value\":[1968,4.24484927066451]},{\"value\":[1969,4.29643598055105]},{\"value\":[1970,4.547]},{\"value\":[1971,4.984]},{\"value\":[1972,5.073]},{\"value\":[1973,5.031]},{\"value\":[1974,5.498]},{\"value\":[1975,5.769]},{\"value\":[1976,6.021]},{\"value\":[1977,6.784]},{\"value\":[1978,6.841]},{\"value\":[1979,6.757]},{\"value\":[1980,7.107]},{\"value\":[1981,7.142]},{\"value\":[1982,7.197]},{\"value\":[1983,7.109]},{\"value\":[1984,6.942]},{\"value\":[1985,6.484]},{\"value\":[1986,6.286]},{\"value\":[1987,6.359]},{\"value\":[1988,6.256]},{\"value\":[1989,6.32]},{\"value\":[1990,5.692]},{\"value\":[1991,5.558]},{\"value\":[1992,6.471]},{\"value\":[1993,6.693]},{\"value\":[1994,6.348]},{\"value\":[1995,6.24]},{\"value\":[1996,6.456]},{\"value\":[1997,6.202]},{\"value\":[1998,6.255]},{\"value\":[1999,6.291]},{\"value\":[2000,6.267]},{\"value\":[2001,6.49]},{\"value\":[2002,6.779]},{\"value\":[2003,6.914]},{\"value\":[2004,6.722]},{\"value\":[2005,6.708]},{\"value\":[2006,6.632]},{\"value\":[2007,6.598]},{\"value\":[2008,6.772]},{\"value\":[2009,7.237]},{\"value\":[2010,6.863]},{\"value\":[2011,8.800000000000001]},{\"value\":[2012,9.041]},{\"value\":[2013,9.162000000000001]},{\"value\":[2014,9.199]},{\"value\":[2015,9.071]},{\"value\":[2016,9.144]},{\"value\":[2017,9.135999999999999]},{\"value\":[2018,9.276]},{\"value\":[2019,9.221]},{\"value\":[2020,9.877000000000001]},{\"value\":[2021,9.787000000000001]}],\"yAxisIndex\":0,\"xAxisIndex\":0,\"name\":\"Sweden\",\"type\":\"line\",\"coordinateSystem\":\"cartesian2d\",\"areaStyle\":[]},{\"data\":[{\"value\":[1880,0.13]},{\"value\":[1890,0.16]},{\"value\":[1900,0.29]},{\"value\":[1910,0.32]},{\"value\":[1920,0.5600000000000001]},{\"value\":[1930,0.64]},{\"value\":[1960,2.92035038363171]},{\"value\":[1961,2.97296930946292]},{\"value\":[1962,2.95542966751918]},{\"value\":[1963,2.97296930946292]},{\"value\":[1964,2.96419948849105]},{\"value\":[1965,3.10451662404092]},{\"value\":[1966,3.22729411764706]},{\"value\":[1967,3.39392071611253]},{\"value\":[1968,3.4026905370844]},{\"value\":[1969,3.30622250639386]},{\"value\":[1970,3.429]},{\"value\":[1971,3.469]},{\"value\":[1972,3.557]},{\"value\":[1973,3.476]},{\"value\":[1974,4.143]},{\"value\":[1975,4.486]},{\"value\":[1976,4.487]},{\"value\":[1977,4.378]},{\"value\":[1978,4.351]},{\"value\":[1979,4.252]},{\"value\":[1980,4.532]},{\"value\":[1981,4.71]},{\"value\":[1982,4.498]},{\"value\":[1983,4.666]},{\"value\":[1984,4.563]},{\"value\":[1985,4.428]},{\"value\":[1986,4.407]},{\"value\":[1987,4.421]},{\"value\":[1988,4.331]},{\"value\":[1989,4.249]},{\"value\":[1990,4.291]},{\"value\":[1991,4.586]},{\"value\":[1992,4.975]},{\"value\":[1993,5.066]},{\"value\":[1994,5.091]},{\"value\":[1995,4.668]},{\"value\":[1996,4.659]},{\"value\":[1997,5.135]},{\"value\":[1998,5.263]},{\"value\":[1999,5.463]},{\"value\":[2000,5.476]},{\"value\":[2001,5.737]},{\"value\":[2002,6.103]},{\"value\":[2003,6.316]},{\"value\":[2004,6.664]},{\"value\":[2005,6.792]},{\"value\":[2006,6.996]},{\"value\":[2007,6.996]},{\"value\":[2008,7.304]},{\"value\":[2009,8.090999999999999]},{\"value\":[2010,8.006]},{\"value\":[2011,7.973]},{\"value\":[2012,7.957]},{\"value\":[2013,7.857]},{\"value\":[2014,7.85]},{\"value\":[2015,7.779]},{\"value\":[2016,7.772]},{\"value\":[2017,7.631]},{\"value\":[2018,7.658]},{\"value\":[2019,7.836]},{\"value\":[2020,9.923]},{\"value\":[2021,9.898]}],\"yAxisIndex\":0,\"xAxisIndex\":0,\"name\":\"United Kingdom\",\"type\":\"line\",\"coordinateSystem\":\"cartesian2d\",\"areaStyle\":[]},{\"data\":[{\"value\":[1880,0.09]},{\"value\":[1890,0.14]},{\"value\":[1900,0.17]},{\"value\":[1910,0.26]},{\"value\":[1920,0.4]},{\"value\":[1930,0.34]},{\"value\":[1960,1.09367518248175]},{\"value\":[1961,1.1615]},{\"value\":[1962,1.17845620437956]},{\"value\":[1963,1.22084671532847]},{\"value\":[1964,1.22084671532847]},{\"value\":[1965,1.23780291970803]},{\"value\":[1966,1.49214598540146]},{\"value\":[1967,1.99235401459854]},{\"value\":[1968,2.11952554744526]},{\"value\":[1969,2.17039416058394]},{\"value\":[1970,2.323]},{\"value\":[1971,2.433]},{\"value\":[1972,2.491]},{\"value\":[1973,2.538]},{\"value\":[1974,2.769]},{\"value\":[1975,2.988]},{\"value\":[1976,3.049]},{\"value\":[1977,3.114]},{\"value\":[1978,3.14]},{\"value\":[1979,3.217]},{\"value\":[1980,3.458]},{\"value\":[1981,3.579]},{\"value\":[1982,3.822]},{\"value\":[1983,3.871]},{\"value\":[1984,3.786]},{\"value\":[1985,3.832]},{\"value\":[1986,3.973]},{\"value\":[1987,4.101]},{\"value\":[1988,4.125]},{\"value\":[1989,4.27]},{\"value\":[1990,4.543]},{\"value\":[1991,5.001]},{\"value\":[1992,5.283]},{\"value\":[1993,5.531]},{\"value\":[1994,5.689]},{\"value\":[1995,5.798]},{\"value\":[1996,6.242]},{\"value\":[1997,5.717]},{\"value\":[1998,5.56]},{\"value\":[1999,5.502]},{\"value\":[2000,5.543]},{\"value\":[2001,5.968]},{\"value\":[2002,6.326]},{\"value\":[2003,6.523]},{\"value\":[2004,6.608]},{\"value\":[2005,6.628]},{\"value\":[2006,6.781]},{\"value\":[2007,6.886]},{\"value\":[2008,7.198]},{\"value\":[2009,7.833]},{\"value\":[2010,7.889]},{\"value\":[2011,7.876]},{\"value\":[2012,7.853]},{\"value\":[2013,7.907]},{\"value\":[2014,13.372]},{\"value\":[2015,13.664]},{\"value\":[2016,13.912]},{\"value\":[2017,13.89]},{\"value\":[2018,13.796]},{\"value\":[2019,13.813]},{\"value\":[2020,15.949]}],\"yAxisIndex\":0,\"xAxisIndex\":0,\"name\":\"United States\",\"type\":\"line\",\"coordinateSystem\":\"cartesian2d\",\"areaStyle\":[]}],\"tooltip\":{\"trigger\":\"item\"}},\"dispose\":true},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n:::\n\n## {{< iconify carbon sankey-diagram-alt >}} What Space Evolution Charts can we plot?\n\nHere, the *space* can be any Qual variable, and we can chart another\nQuant or Qual variable move across levels of the first chosen Qual\nvariable.\n\nFor instance we can contemplate enrollment at a University, and show how\nstudents move from course to course in a University. Or how customers\ndrift from one category of products or brands to another....or the\nmovement of cricket players from one IPL Team to another !!\n\nHere is what [Thomas Lin\nPedersen](https://ggforce.data-imaginist.com/reference/geom_parallel_sets.html)\nsays:\n\n> A **parallel sets diagram** is a type of visualisation showing the\n> interaction between multiple categorical variables. If the variables\n> have an **intrinsic order** the representation can be thought of as a\n> **Sankey Diagram**. If each variable is a point in time it will\n> resemble an **Alluvial diagram**.\n\n\n::: {#fig-elephants layout-ncol=2}\n![ggsankey aesthetics](images/sankey.png){#fig-ggsankey}\n\n![ggsankeyfier aesthetics](images/important_aspects.svg){#fig-sankeyfier}\n\nGeometric Aesthetics from two Sankey Plot Packages\n:::\n\n\n-   The Qualitative variables being connected are mapped to\n    `stages/axes`\n-   Each *level* within a Qual variable is mapped to\n    `nodes / strata / lodes`;\n-   And the connections between the `strata` of the `axes` are called\n    `flows / edges / links / alluvia`.\\\n\nSuch diagrams are best used when you want to show a many-to-many mapping\nbetween two domains or multiple paths through a set of stages E.g\n`Students` pursruing different `degrees` going through multiple `courses` with multiple `departments` during a semester of study. Here `students`, `degrees`, `courses`, `departments` would be some variables we would plot and we would visualize the number of students moving across `courses` and `deparments` based on their `degree` etc. \n\nHere is an example of a Sankey Diagram: This diagram show how energy is\nconverted or transmitted before being consumed or lost: supplies are on\nthe left, and demands are on the right. (Data: Department of Energy &\nClimate Change via Tom Counsell)[^1]:\n\n<iframe width=\"100%\" height=\"684\" frameborder=\"0\" src=\"https://observablehq.com/embed/@d3/sankey?cells=chart\">\n\n</iframe>\n\n::: callout-note\n## Switching to ggplot here\n\nFor the next few charts, there are (as yet) no equivalents in\n`ggformula`. Hence we will use `ggplot`.\n:::\n\n## {{< iconify pajamas issue-type-test-case >}} Case Study-1: Titanic Dataset\n\n::::{.columns}\n:::{.column}\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(Titanic, package = \"datasets\")\nTitanic <- Titanic %>% as_tibble()\nTitanic\n```\n:::\n\n:::\n:::{.column}\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Class\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Sex\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Age\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Survived\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"n\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1st\",\"2\":\"Male\",\"3\":\"Child\",\"4\":\"No\",\"5\":\"0\"},{\"1\":\"2nd\",\"2\":\"Male\",\"3\":\"Child\",\"4\":\"No\",\"5\":\"0\"},{\"1\":\"3rd\",\"2\":\"Male\",\"3\":\"Child\",\"4\":\"No\",\"5\":\"35\"},{\"1\":\"Crew\",\"2\":\"Male\",\"3\":\"Child\",\"4\":\"No\",\"5\":\"0\"},{\"1\":\"1st\",\"2\":\"Female\",\"3\":\"Child\",\"4\":\"No\",\"5\":\"0\"},{\"1\":\"2nd\",\"2\":\"Female\",\"3\":\"Child\",\"4\":\"No\",\"5\":\"0\"},{\"1\":\"3rd\",\"2\":\"Female\",\"3\":\"Child\",\"4\":\"No\",\"5\":\"17\"},{\"1\":\"Crew\",\"2\":\"Female\",\"3\":\"Child\",\"4\":\"No\",\"5\":\"0\"},{\"1\":\"1st\",\"2\":\"Male\",\"3\":\"Adult\",\"4\":\"No\",\"5\":\"118\"},{\"1\":\"2nd\",\"2\":\"Male\",\"3\":\"Adult\",\"4\":\"No\",\"5\":\"154\"},{\"1\":\"3rd\",\"2\":\"Male\",\"3\":\"Adult\",\"4\":\"No\",\"5\":\"387\"},{\"1\":\"Crew\",\"2\":\"Male\",\"3\":\"Adult\",\"4\":\"No\",\"5\":\"670\"},{\"1\":\"1st\",\"2\":\"Female\",\"3\":\"Adult\",\"4\":\"No\",\"5\":\"4\"},{\"1\":\"2nd\",\"2\":\"Female\",\"3\":\"Adult\",\"4\":\"No\",\"5\":\"13\"},{\"1\":\"3rd\",\"2\":\"Female\",\"3\":\"Adult\",\"4\":\"No\",\"5\":\"89\"},{\"1\":\"Crew\",\"2\":\"Female\",\"3\":\"Adult\",\"4\":\"No\",\"5\":\"3\"},{\"1\":\"1st\",\"2\":\"Male\",\"3\":\"Child\",\"4\":\"Yes\",\"5\":\"5\"},{\"1\":\"2nd\",\"2\":\"Male\",\"3\":\"Child\",\"4\":\"Yes\",\"5\":\"11\"},{\"1\":\"3rd\",\"2\":\"Male\",\"3\":\"Child\",\"4\":\"Yes\",\"5\":\"13\"},{\"1\":\"Crew\",\"2\":\"Male\",\"3\":\"Child\",\"4\":\"Yes\",\"5\":\"0\"},{\"1\":\"1st\",\"2\":\"Female\",\"3\":\"Child\",\"4\":\"Yes\",\"5\":\"1\"},{\"1\":\"2nd\",\"2\":\"Female\",\"3\":\"Child\",\"4\":\"Yes\",\"5\":\"13\"},{\"1\":\"3rd\",\"2\":\"Female\",\"3\":\"Child\",\"4\":\"Yes\",\"5\":\"14\"},{\"1\":\"Crew\",\"2\":\"Female\",\"3\":\"Child\",\"4\":\"Yes\",\"5\":\"0\"},{\"1\":\"1st\",\"2\":\"Male\",\"3\":\"Adult\",\"4\":\"Yes\",\"5\":\"57\"},{\"1\":\"2nd\",\"2\":\"Male\",\"3\":\"Adult\",\"4\":\"Yes\",\"5\":\"14\"},{\"1\":\"3rd\",\"2\":\"Male\",\"3\":\"Adult\",\"4\":\"Yes\",\"5\":\"75\"},{\"1\":\"Crew\",\"2\":\"Male\",\"3\":\"Adult\",\"4\":\"Yes\",\"5\":\"192\"},{\"1\":\"1st\",\"2\":\"Female\",\"3\":\"Adult\",\"4\":\"Yes\",\"5\":\"140\"},{\"1\":\"2nd\",\"2\":\"Female\",\"3\":\"Adult\",\"4\":\"Yes\",\"5\":\"80\"},{\"1\":\"3rd\",\"2\":\"Female\",\"3\":\"Adult\",\"4\":\"Yes\",\"5\":\"76\"},{\"1\":\"Crew\",\"2\":\"Female\",\"3\":\"Adult\",\"4\":\"Yes\",\"5\":\"20\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n:::\n::::\n\n\n::: callout-note\n## Table Form Data\n\nNote that this data is in **tidy wide** / **table** form, with separate\ncolumns for each Qualitative variable and a separate `count` column,\nwhich we saw when we examined Categorical Data. This is, in my opinion,\nintuitively the best form of data to plot a Sankey plot with. Each variable gives us \"**one part in the flow**\". But there\nare other forms such as the **tidy long** form which we have been using\npractically all this while. You will find examples of on the\n`ggalluvial` website using **tidy long** form data.\n<https://corybrunson.github.io/ggalluvial/>\n:::\n\n::: column-page-right\n\n::: {.panel-tabset .nav-pills style=\"background: whitesmoke;\"}\n### Using ggplot\n\n::::{.columns}\n:::{.column}\n\n::: {.cell}\n\n```{.r .cell-code}\n##\nTitanic %>% ggplot(\n  data = .,\n\n  # Select the Categorical Variables for the vertical Axes / Stages\n  aes(\n    axis1 = Class,\n    axis2 = Sex,\n    axis3 = Age,\n    axis4 = Survived,\n    y = n\n  ), fill = \"white\"\n) +\n\n  # Alluvials between Categorical Axes\n  geom_alluvium(aes(fill = Survived),\n    colour = \"black\",\n    linewidth = 0.25\n  ) +\n\n  # Vertical segments for each Categorical Variable2\n  geom_stratum(\n    colour = \"black\",\n    linewidth = 1,\n    fill = \"white\"\n  ) +\n\n  # Labels for each \"level\" of the Categorical Axes\n  geom_text(\n    stat = \"stratum\", size = 3,\n    aes(label = after_stat(stratum))\n  ) +\n\n\n\n  # Scales and Colours\n  scale_x_discrete(\n    limits = c(\"Class\", \"Sex\", \"Age\", \"Survived\"),\n    expand = c(0.1, 0.1)\n  ) +\n  scale_fill_brewer(palette = \"Set1\") +\n  xlab(\"Demographic\") +\n  ggtitle(\n    \"Passengers on the maiden voyage of the Titanic\",\n    \"Stratified by demographics and survival\"\n  )\n```\n:::\n\n:::\n:::{.column}\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=2100}\n:::\n:::\n\n\n:::\n::::\n\n\n\n> Here is how the package `ggalluvial` defines the elements of a typical\n> alluvial plot:\n>\n> -   An **axis** is a dimension (variable) along which the data are\n>     vertically arranged at a fixed horizontal position. The plot above\n>     uses three categorical axes: Class, Sex, and Age.\n> -   The groups at each axis are depicted as opaque blocks called\n>     **strata**. For example, the Class axis contains four strata: 1st,\n>     2nd, 3rd, and Crew.\n> -   Horizontal (x-) splines called **alluvia** span the **entire**\n>     width of the plot. In this plot, each alluvium corresponds to a\n>     fixed **strata** value of each axis variable, indicated by its\n>     vertical position at the axis, as well as of the Survived\n>     variable, indicated by its fill color.\n> -   The segments of the **alluvia** between pairs of adjacent axes are\n>     **flows**.\n> -   The **alluvia** intersect the **strata** at **lodes**. The\n>     **lodes** are not visualized in the above plot, but they can be\n>     inferred as *filled rectangles* extending the flows through the\n>     strata at each end of the plot or connecting the flows on either\n>     side of the center stratum.\n\n\n\n### Using ggsankeyfier\n\nThe `ggsankeyfier` also plots alluvial and sankey diagrams. This package takes data in **long-form**. See [this article.](https://pepijn-devries.github.io/ggsankeyfier/articles/data_management.html#wide-or-long-format). `ggsankeyfier` has builtin commands to convert data from wide to long: \n\n::::{.columns}\n:::{.column}\n\n::: {.cell}\n\n```{.r .cell-code}\nTitanic %>%\n  as_tibble() %>%\n  ggsankeyfier::pivot_stages_longer(\n    data = .,\n    stages_from = c(\"Class\", \"Sex\", \"Age\", \"Survived\"),\n    values_from = \"n\",\n    additional_aes_from = \"Survived\"\n  ) -> Titanic_long\nTitanic_long\n```\n:::\n\n:::\n:::{.column}\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Survived\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"n\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"edge_id\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"connector\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"node\"],\"name\":[5],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"stage\"],\"name\":[6],\"type\":[\"fct\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"No\",\"2\":\"118\",\"3\":\"1\",\"4\":\"from\",\"5\":\"1st\",\"6\":\"Class\"},{\"1\":\"No\",\"2\":\"118\",\"3\":\"1\",\"4\":\"to\",\"5\":\"Male\",\"6\":\"Sex\"},{\"1\":\"Yes\",\"2\":\"62\",\"3\":\"2\",\"4\":\"from\",\"5\":\"1st\",\"6\":\"Class\"},{\"1\":\"Yes\",\"2\":\"62\",\"3\":\"2\",\"4\":\"to\",\"5\":\"Male\",\"6\":\"Sex\"},{\"1\":\"No\",\"2\":\"4\",\"3\":\"3\",\"4\":\"from\",\"5\":\"1st\",\"6\":\"Class\"},{\"1\":\"No\",\"2\":\"4\",\"3\":\"3\",\"4\":\"to\",\"5\":\"Female\",\"6\":\"Sex\"},{\"1\":\"Yes\",\"2\":\"141\",\"3\":\"4\",\"4\":\"from\",\"5\":\"1st\",\"6\":\"Class\"},{\"1\":\"Yes\",\"2\":\"141\",\"3\":\"4\",\"4\":\"to\",\"5\":\"Female\",\"6\":\"Sex\"},{\"1\":\"No\",\"2\":\"154\",\"3\":\"5\",\"4\":\"from\",\"5\":\"2nd\",\"6\":\"Class\"},{\"1\":\"No\",\"2\":\"154\",\"3\":\"5\",\"4\":\"to\",\"5\":\"Male\",\"6\":\"Sex\"},{\"1\":\"Yes\",\"2\":\"25\",\"3\":\"6\",\"4\":\"from\",\"5\":\"2nd\",\"6\":\"Class\"},{\"1\":\"Yes\",\"2\":\"25\",\"3\":\"6\",\"4\":\"to\",\"5\":\"Male\",\"6\":\"Sex\"},{\"1\":\"No\",\"2\":\"13\",\"3\":\"7\",\"4\":\"from\",\"5\":\"2nd\",\"6\":\"Class\"},{\"1\":\"No\",\"2\":\"13\",\"3\":\"7\",\"4\":\"to\",\"5\":\"Female\",\"6\":\"Sex\"},{\"1\":\"Yes\",\"2\":\"93\",\"3\":\"8\",\"4\":\"from\",\"5\":\"2nd\",\"6\":\"Class\"},{\"1\":\"Yes\",\"2\":\"93\",\"3\":\"8\",\"4\":\"to\",\"5\":\"Female\",\"6\":\"Sex\"},{\"1\":\"No\",\"2\":\"422\",\"3\":\"9\",\"4\":\"from\",\"5\":\"3rd\",\"6\":\"Class\"},{\"1\":\"No\",\"2\":\"422\",\"3\":\"9\",\"4\":\"to\",\"5\":\"Male\",\"6\":\"Sex\"},{\"1\":\"Yes\",\"2\":\"88\",\"3\":\"10\",\"4\":\"from\",\"5\":\"3rd\",\"6\":\"Class\"},{\"1\":\"Yes\",\"2\":\"88\",\"3\":\"10\",\"4\":\"to\",\"5\":\"Male\",\"6\":\"Sex\"},{\"1\":\"No\",\"2\":\"106\",\"3\":\"11\",\"4\":\"from\",\"5\":\"3rd\",\"6\":\"Class\"},{\"1\":\"No\",\"2\":\"106\",\"3\":\"11\",\"4\":\"to\",\"5\":\"Female\",\"6\":\"Sex\"},{\"1\":\"Yes\",\"2\":\"90\",\"3\":\"12\",\"4\":\"from\",\"5\":\"3rd\",\"6\":\"Class\"},{\"1\":\"Yes\",\"2\":\"90\",\"3\":\"12\",\"4\":\"to\",\"5\":\"Female\",\"6\":\"Sex\"},{\"1\":\"No\",\"2\":\"670\",\"3\":\"13\",\"4\":\"from\",\"5\":\"Crew\",\"6\":\"Class\"},{\"1\":\"No\",\"2\":\"670\",\"3\":\"13\",\"4\":\"to\",\"5\":\"Male\",\"6\":\"Sex\"},{\"1\":\"Yes\",\"2\":\"192\",\"3\":\"14\",\"4\":\"from\",\"5\":\"Crew\",\"6\":\"Class\"},{\"1\":\"Yes\",\"2\":\"192\",\"3\":\"14\",\"4\":\"to\",\"5\":\"Male\",\"6\":\"Sex\"},{\"1\":\"No\",\"2\":\"3\",\"3\":\"15\",\"4\":\"from\",\"5\":\"Crew\",\"6\":\"Class\"},{\"1\":\"No\",\"2\":\"3\",\"3\":\"15\",\"4\":\"to\",\"5\":\"Female\",\"6\":\"Sex\"},{\"1\":\"Yes\",\"2\":\"20\",\"3\":\"16\",\"4\":\"from\",\"5\":\"Crew\",\"6\":\"Class\"},{\"1\":\"Yes\",\"2\":\"20\",\"3\":\"16\",\"4\":\"to\",\"5\":\"Female\",\"6\":\"Sex\"},{\"1\":\"No\",\"2\":\"35\",\"3\":\"17\",\"4\":\"from\",\"5\":\"Male\",\"6\":\"Sex\"},{\"1\":\"No\",\"2\":\"35\",\"3\":\"17\",\"4\":\"to\",\"5\":\"Child\",\"6\":\"Age\"},{\"1\":\"Yes\",\"2\":\"29\",\"3\":\"18\",\"4\":\"from\",\"5\":\"Male\",\"6\":\"Sex\"},{\"1\":\"Yes\",\"2\":\"29\",\"3\":\"18\",\"4\":\"to\",\"5\":\"Child\",\"6\":\"Age\"},{\"1\":\"No\",\"2\":\"1329\",\"3\":\"19\",\"4\":\"from\",\"5\":\"Male\",\"6\":\"Sex\"},{\"1\":\"No\",\"2\":\"1329\",\"3\":\"19\",\"4\":\"to\",\"5\":\"Adult\",\"6\":\"Age\"},{\"1\":\"Yes\",\"2\":\"338\",\"3\":\"20\",\"4\":\"from\",\"5\":\"Male\",\"6\":\"Sex\"},{\"1\":\"Yes\",\"2\":\"338\",\"3\":\"20\",\"4\":\"to\",\"5\":\"Adult\",\"6\":\"Age\"},{\"1\":\"No\",\"2\":\"17\",\"3\":\"21\",\"4\":\"from\",\"5\":\"Female\",\"6\":\"Sex\"},{\"1\":\"No\",\"2\":\"17\",\"3\":\"21\",\"4\":\"to\",\"5\":\"Child\",\"6\":\"Age\"},{\"1\":\"Yes\",\"2\":\"28\",\"3\":\"22\",\"4\":\"from\",\"5\":\"Female\",\"6\":\"Sex\"},{\"1\":\"Yes\",\"2\":\"28\",\"3\":\"22\",\"4\":\"to\",\"5\":\"Child\",\"6\":\"Age\"},{\"1\":\"No\",\"2\":\"109\",\"3\":\"23\",\"4\":\"from\",\"5\":\"Female\",\"6\":\"Sex\"},{\"1\":\"No\",\"2\":\"109\",\"3\":\"23\",\"4\":\"to\",\"5\":\"Adult\",\"6\":\"Age\"},{\"1\":\"Yes\",\"2\":\"316\",\"3\":\"24\",\"4\":\"from\",\"5\":\"Female\",\"6\":\"Sex\"},{\"1\":\"Yes\",\"2\":\"316\",\"3\":\"24\",\"4\":\"to\",\"5\":\"Adult\",\"6\":\"Age\"},{\"1\":\"No\",\"2\":\"52\",\"3\":\"25\",\"4\":\"from\",\"5\":\"Child\",\"6\":\"Age\"},{\"1\":\"No\",\"2\":\"52\",\"3\":\"25\",\"4\":\"to\",\"5\":\"No\",\"6\":\"Survived\"},{\"1\":\"Yes\",\"2\":\"57\",\"3\":\"26\",\"4\":\"from\",\"5\":\"Child\",\"6\":\"Age\"},{\"1\":\"Yes\",\"2\":\"57\",\"3\":\"26\",\"4\":\"to\",\"5\":\"Yes\",\"6\":\"Survived\"},{\"1\":\"No\",\"2\":\"1438\",\"3\":\"27\",\"4\":\"from\",\"5\":\"Adult\",\"6\":\"Age\"},{\"1\":\"No\",\"2\":\"1438\",\"3\":\"27\",\"4\":\"to\",\"5\":\"No\",\"6\":\"Survived\"},{\"1\":\"Yes\",\"2\":\"654\",\"3\":\"28\",\"4\":\"from\",\"5\":\"Adult\",\"6\":\"Age\"},{\"1\":\"Yes\",\"2\":\"654\",\"3\":\"28\",\"4\":\"to\",\"5\":\"Yes\",\"6\":\"Survived\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n:::\n::::\n\n\nThis data is in long form, with `stages` defining the *axes* in the graph, and the `node` variable giving us *levels* within each (Qualitative) axis. The `edge_id` labels **both ends** (from and to) of each `connector` or edge/flow/alluvium. \n\nLet us plot this now:\n\n::::{.columns}\n:::{.column}\n\n::: {.cell}\n\n```{.r .cell-code}\nTitanic_long %>%\n  ggplot(aes(\n    x = stage, y = n,\n    group = node, connector = connector,\n    edge_id = edge_id\n  )) +\n  geom_sankeynode(v_space = \"auto\") +\n  geom_sankeyedge(aes(fill = Survived), v_space = \"auto\") +\n  scale_fill_brewer(palette = \"Set1\") +\n  labs(x = \"\", title = \"Titanic Survival\")\n```\n:::\n\n:::\n:::{.column}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=2100}\n:::\n:::\n\n\n:::\n::::\n\n### Using echarts4r\n\nLet us make an interactive graph for this dataset using `echarts4`.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nClassSex <-\n  Titanic %>%\n  group_by(Class, Sex) %>%\n  summarise(cs = sum(n)) %>%\n  ungroup() %>%\n  rename(\"source\" = Class, \"target\" = Sex, \"value\" = cs)\n\nSexAge <-\n  Titanic %>%\n  group_by(Sex, Age) %>%\n  summarise(sa = sum(n)) %>%\n  ungroup() %>%\n  rename(\"source\" = Sex, \"target\" = Age, \"value\" = sa)\n\nAgeSurvived <-\n  Titanic %>%\n  group_by(Age, Survived) %>%\n  summarise(as = sum(n)) %>%\n  ungroup() %>%\n  rename(\"source\" = Age, \"target\" = Survived, \"value\" = as)\n\nCombo <- rbind(ClassSex, SexAge, AgeSurvived)\nCombo\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"source\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"target\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"value\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1st\",\"2\":\"Female\",\"3\":\"145\"},{\"1\":\"1st\",\"2\":\"Male\",\"3\":\"180\"},{\"1\":\"2nd\",\"2\":\"Female\",\"3\":\"106\"},{\"1\":\"2nd\",\"2\":\"Male\",\"3\":\"179\"},{\"1\":\"3rd\",\"2\":\"Female\",\"3\":\"196\"},{\"1\":\"3rd\",\"2\":\"Male\",\"3\":\"510\"},{\"1\":\"Crew\",\"2\":\"Female\",\"3\":\"23\"},{\"1\":\"Crew\",\"2\":\"Male\",\"3\":\"862\"},{\"1\":\"Female\",\"2\":\"Adult\",\"3\":\"425\"},{\"1\":\"Female\",\"2\":\"Child\",\"3\":\"45\"},{\"1\":\"Male\",\"2\":\"Adult\",\"3\":\"1667\"},{\"1\":\"Male\",\"2\":\"Child\",\"3\":\"64\"},{\"1\":\"Adult\",\"2\":\"No\",\"3\":\"1438\"},{\"1\":\"Adult\",\"2\":\"Yes\",\"3\":\"654\"},{\"1\":\"Child\",\"2\":\"No\",\"3\":\"52\"},{\"1\":\"Child\",\"2\":\"Yes\",\"3\":\"57\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nCombo %>%\n  e_charts() %>%\n  e_sankey(source, target, value) %>%\n  e_title(\"Titanic: Who lived, and who didn't?\") %>%\n  e_tooltip()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"echarts4r html-widget html-fill-item\" id=\"htmlwidget-058df549352ef84e752c\" style=\"width:100%;height:500px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-058df549352ef84e752c\">{\"x\":{\"theme\":\"\",\"tl\":false,\"draw\":true,\"renderer\":\"canvas\",\"events\":[],\"buttons\":[],\"opts\":{\"series\":[{\"type\":\"sankey\",\"orient\":\"none\",\"data\":[{\"name\":\"1st\"},{\"name\":\"2nd\"},{\"name\":\"3rd\"},{\"name\":\"Crew\"},{\"name\":\"Female\"},{\"name\":\"Male\"},{\"name\":\"Adult\"},{\"name\":\"Child\"},{\"name\":\"No\"},{\"name\":\"Yes\"}],\"links\":[{\"source\":\"1st\",\"target\":\"Female\",\"value\":\" 145\"},{\"source\":\"1st\",\"target\":\"Male\",\"value\":\" 180\"},{\"source\":\"2nd\",\"target\":\"Female\",\"value\":\" 106\"},{\"source\":\"2nd\",\"target\":\"Male\",\"value\":\" 179\"},{\"source\":\"3rd\",\"target\":\"Female\",\"value\":\" 196\"},{\"source\":\"3rd\",\"target\":\"Male\",\"value\":\" 510\"},{\"source\":\"Crew\",\"target\":\"Female\",\"value\":\"  23\"},{\"source\":\"Crew\",\"target\":\"Male\",\"value\":\" 862\"},{\"source\":\"Female\",\"target\":\"Adult\",\"value\":\" 425\"},{\"source\":\"Female\",\"target\":\"Child\",\"value\":\"  45\"},{\"source\":\"Male\",\"target\":\"Adult\",\"value\":\"1667\"},{\"source\":\"Male\",\"target\":\"Child\",\"value\":\"  64\"},{\"source\":\"Adult\",\"target\":\"No\",\"value\":\"1438\"},{\"source\":\"Adult\",\"target\":\"Yes\",\"value\":\" 654\"},{\"source\":\"Child\",\"target\":\"No\",\"value\":\"  52\"},{\"source\":\"Child\",\"target\":\"Yes\",\"value\":\"  57\"}]}],\"title\":[{\"text\":\"Titanic: Who lived, and who didn't?\"}],\"tooltip\":{\"trigger\":\"item\"}},\"dispose\":true},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\nThe process with `echarts4r` is quite different, since the data\nstructure used by this package is different:\n\n-   The `echarts4r` package needs to have `source` and `target` columns\n    for *axes*, along with a `value` to determine the *width* of the\n    alluvium. \n-   The names in the source and target **can repeat, and can appear in\n    both source and target columns** in order to create a multi-axis\n    diagram. Hence the data needs to be inherently in **long** form.\n-   However, for the **values**, we need to manually calculate the\n    aggregate totals for alluvia between each consecutive pairs of axes\n    (i.e Qual variables). This is not done automatically in `echarts4r`,\n    but it is with `ggalluvial`.\n-   So we create *grouped* aggregate *summaries* for each pair of\n    Qualitative variables that we wish to plot *consecutively* ( i.e as\n    axis1, axis2...)\n-   Stack these pair-wise alluvia totals into one combo data frame using\n    `rbind()`, after renaming the variables to \"source\", \"target\" and\n    \"value\".\n\nPhew! seems like too much work to do...I wonder if good, old-fashioned\n`pivot-longer` will get us here...\n\n\n:::\n\n:::\n\n\n## {{< iconify icon-park-outline chart-histogram >}} Chord Diagram\n\n![](images/chord.png){fig-align=\"center\"}\n\nWe will explore this diagram when we explore network graphs with the\n`tidygraph` and `ggraph` packages.\n\n\n## {{< iconify icon-park-outline chart-histogram >}} Dumbbell Plots\n\nA simple plot that can quickly indicate changes in multiple variables/aspects over either a time or a space variable is a dumbbell plot. This is a combination of scatter plot + a segment plot. \nLet us take our previously loaded `health` dataset and plot just the change in expenditure for multiple countries, across a time span of 8 years (2010 - 2018)\n\n::: column-page-right\n\n::: {.panel-tabset .nav-pills style=\"background: whitesmoke;\"}\n\n### Using ggformula\n\n::::{.columns}\n:::{.column}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhealth_2010_2018 <- health %>%\n  # select Years 2010 and 2018\n  filter(Year %in% c(2010, 2018)) %>%\n  # Make separate columns for each year, easier that way\n  # Though not essential\n  pivot_wider(\n    id_cols = c(Entity, Code),\n    names_from = Year,\n    names_prefix = \"Year\",\n    values_from = public_health_expenditure_pc_gdp\n  )\nhealth_2010_2018\n```\n:::\n\n\n:::\n:::{.column}\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Entity\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Code\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Year2010\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Year2018\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Albania\",\"2\":\"ALB\",\"3\":\"2.442\",\"4\":\"2.878\"},{\"1\":\"Argentina\",\"2\":\"ARG\",\"3\":\"5.572\",\"4\":\"5.965\"},{\"1\":\"Australia\",\"2\":\"AUS\",\"3\":\"5.781\",\"4\":\"7.009\"},{\"1\":\"Austria\",\"2\":\"AUT\",\"3\":\"7.630\",\"4\":\"7.724\"},{\"1\":\"Belgium\",\"2\":\"BEL\",\"3\":\"7.783\",\"4\":\"8.337\"},{\"1\":\"Brazil\",\"2\":\"BRA\",\"3\":\"3.577\",\"4\":\"3.897\"},{\"1\":\"Bulgaria\",\"2\":\"BGR\",\"3\":\"3.932\",\"4\":\"4.330\"},{\"1\":\"Canada\",\"2\":\"CAN\",\"3\":\"7.483\",\"4\":\"7.577\"},{\"1\":\"Chile\",\"2\":\"CHL\",\"3\":\"3.999\",\"4\":\"5.524\"},{\"1\":\"China\",\"2\":\"CHN\",\"3\":\"2.177\",\"4\":\"2.914\"},{\"1\":\"Colombia\",\"2\":\"COL\",\"3\":\"5.290\",\"4\":\"5.892\"},{\"1\":\"Costa Rica\",\"2\":\"CRI\",\"3\":\"5.871\",\"4\":\"5.379\"},{\"1\":\"Croatia\",\"2\":\"HRV\",\"3\":\"6.853\",\"4\":\"5.542\"},{\"1\":\"Cyprus\",\"2\":\"CYP\",\"3\":\"3.007\",\"4\":\"2.877\"},{\"1\":\"Czechia\",\"2\":\"CZE\",\"3\":\"5.729\",\"4\":\"6.342\"},{\"1\":\"Denmark\",\"2\":\"DNK\",\"3\":\"8.939\",\"4\":\"8.457\"},{\"1\":\"Estonia\",\"2\":\"EST\",\"3\":\"4.826\",\"4\":\"4.952\"},{\"1\":\"Finland\",\"2\":\"FIN\",\"3\":\"7.047\",\"4\":\"6.959\"},{\"1\":\"France\",\"2\":\"FRA\",\"3\":\"8.561\",\"4\":\"9.345\"},{\"1\":\"Germany\",\"2\":\"DEU\",\"3\":\"9.236\",\"4\":\"9.638\"},{\"1\":\"Greece\",\"2\":\"GRC\",\"3\":\"6.613\",\"4\":\"4.808\"},{\"1\":\"Hungary\",\"2\":\"HUN\",\"3\":\"4.994\",\"4\":\"4.572\"},{\"1\":\"Iceland\",\"2\":\"ISL\",\"3\":\"6.678\",\"4\":\"6.901\"},{\"1\":\"India\",\"2\":\"IND\",\"3\":\"0.862\",\"4\":\"0.972\"},{\"1\":\"Ireland\",\"2\":\"IRL\",\"3\":\"8.018\",\"4\":\"5.100\"},{\"1\":\"Israel\",\"2\":\"ISR\",\"3\":\"4.394\",\"4\":\"4.712\"},{\"1\":\"Italy\",\"2\":\"ITA\",\"3\":\"6.995\",\"4\":\"6.413\"},{\"1\":\"Japan\",\"2\":\"JPN\",\"3\":\"7.425\",\"4\":\"9.002\"},{\"1\":\"Latvia\",\"2\":\"LVA\",\"3\":\"3.670\",\"4\":\"3.706\"},{\"1\":\"Lithuania\",\"2\":\"LTU\",\"3\":\"4.887\",\"4\":\"4.387\"},{\"1\":\"Luxembourg\",\"2\":\"LUX\",\"3\":\"5.657\",\"4\":\"4.421\"},{\"1\":\"Malta\",\"2\":\"MLT\",\"3\":\"5.129\",\"4\":\"5.437\"},{\"1\":\"Mexico\",\"2\":\"MEX\",\"3\":\"2.881\",\"4\":\"2.672\"},{\"1\":\"Montenegro\",\"2\":\"MNE\",\"3\":\"NA\",\"4\":\"5.007\"},{\"1\":\"Netherlands\",\"2\":\"NLD\",\"3\":\"8.467\",\"4\":\"8.238\"},{\"1\":\"New Zealand\",\"2\":\"NZL\",\"3\":\"7.787\",\"4\":\"7.158\"},{\"1\":\"North Macedonia\",\"2\":\"MKD\",\"3\":\"4.161\",\"4\":\"3.768\"},{\"1\":\"Norway\",\"2\":\"NOR\",\"3\":\"7.541\",\"4\":\"8.591\"},{\"1\":\"Peru\",\"2\":\"PER\",\"3\":\"2.459\",\"4\":\"3.197\"},{\"1\":\"Poland\",\"2\":\"POL\",\"3\":\"4.596\",\"4\":\"4.524\"},{\"1\":\"Portugal\",\"2\":\"PRT\",\"3\":\"6.678\",\"4\":\"5.763\"},{\"1\":\"Romania\",\"2\":\"ROU\",\"3\":\"4.608\",\"4\":\"4.433\"},{\"1\":\"Serbia\",\"2\":\"SRB\",\"3\":\"5.890\",\"4\":\"5.120\"},{\"1\":\"Slovakia\",\"2\":\"SVK\",\"3\":\"5.535\",\"4\":\"5.369\"},{\"1\":\"Slovenia\",\"2\":\"SVN\",\"3\":\"6.288\",\"4\":\"6.029\"},{\"1\":\"South Africa\",\"2\":\"ZAF\",\"3\":\"3.972\",\"4\":\"4.163\"},{\"1\":\"South Korea\",\"2\":\"KOR\",\"3\":\"3.605\",\"4\":\"4.517\"},{\"1\":\"Spain\",\"2\":\"ESP\",\"3\":\"6.789\",\"4\":\"6.321\"},{\"1\":\"Sweden\",\"2\":\"SWE\",\"3\":\"6.863\",\"4\":\"9.276\"},{\"1\":\"Switzerland\",\"2\":\"CHE\",\"3\":\"6.391\",\"4\":\"7.331\"},{\"1\":\"Turkey\",\"2\":\"TUR\",\"3\":\"3.916\",\"4\":\"3.191\"},{\"1\":\"United Kingdom\",\"2\":\"GBR\",\"3\":\"8.006\",\"4\":\"7.658\"},{\"1\":\"United States\",\"2\":\"USA\",\"3\":\"7.889\",\"4\":\"13.796\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n:::\n::::\n\n\n::::{.columns}\n:::{.column}\n\n::: {.cell}\n\n```{.r .cell-code}\nhealth_2010_2018 %>%\n  # remove NA data across the data set\n  drop_na() %>%\n  # take the top 20 countries based on 2018 allocation\n  slice_max(n = 20, order_by = Year2018) %>%\n  gf_segment(Entity + Entity ~ Year2010 + Year2018,\n    colour = \"grey\",\n    linewidth = 2\n  ) %>%\n  gf_point(Entity ~ Year2018,\n    colour = ~\"2018\"\n  ) %>%\n  gf_point(Entity ~ Year2010,\n    colour = ~\"2010\"\n  )\n```\n:::\n\n\n\n\n\n\n:::\n:::{.column}\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=2100}\n:::\n:::\n\n\n:::\n::::\n\n\n::::{.columns}\n:::{.column}\n\n::: {.cell}\n\n```{.r .cell-code}\n## Can we do better? Sort the bars, improve axis ticks, title..\n\nhealth_2010_2018 %>%\n  # remove NA data across the data set\n  drop_na() %>%\n  # take the top 20 countries based on 2018 allocation\n  slice_max(n = 20, order_by = Year2018) %>%\n  # plot segments first\n  gf_segment(\n    reorder(Entity, Year2018) + reorder(Entity, Year2018) ~\n      Year2010 + Year2018,\n    colour = \"grey\",\n    linewidth = 2\n  ) %>%\n  # Then plot points\n  gf_point(reorder(Entity, Year2018) ~ Year2018,\n    colour = ~\"2018\",\n    size = 3\n  ) %>%\n  gf_point(\n    reorder(Entity, Year2018) ~ Year2010,\n    colour = ~\"2010\", size = 3,\n    xlab = \"Health Expenditure as Percentage of GDP\",\n    ylab = \"Country\",\n    title = \"Healthcare Budgets Changes between 2010 to 2018\",\n    subtitle = \"Bars are Sorted\",\n    caption = \"And the X-Axis is in percentage\"\n  ) %>%\n  gf_refine(\n    scale_x_continuous(\n      breaks = scales::breaks_width(2),\n      labels = scales::label_percent(suffix = \"%\", scale = 1)\n    ),\n    scale_colour_manual(name = \"Year\", values = c(\"red\", \"green\"))\n  )\n```\n:::\n\n\n\n\n\n:::\n:::{.column}\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-1.png){width=2100}\n:::\n:::\n\n\n:::\n::::\n\n\n### Using ggplot\n\n\n::: {.cell layout-ncol=\"2\"}\n\n```{.r .cell-code}\nhealth_2010_2018 <- health %>%\n  # select Years 2010 and 2018\n  filter(Year %in% c(2010, 2018)) %>%\n  # Make separate columns for each year, easier that way\n  # Though not essential\n  pivot_wider(\n    id_cols = c(Entity, Code),\n    names_from = Year,\n    names_prefix = \"Year\",\n    values_from = public_health_expenditure_pc_gdp\n  )\n\nhealth_2010_2018 %>%\n  # remove NA data across the data set\n  drop_na() %>%\n  # take the top 20 countries based on 2018 allocation\n  slice_max(n = 20, order_by = Year2018) %>%\n  ggplot() +\n  geom_segment(\n    aes(\n      y = Entity, yend = Entity,\n      x = Year2010, xend = Year2018\n    ),\n    colour = \"grey\",\n    linewidth = 2\n  ) +\n  geom_point(aes(y = Entity, x = Year2018, colour = \"2018\")) +\n  geom_point(aes(y = Entity, x = Year2010, colour = \"2010\"))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-1.png){width=2100}\n:::\n\n```{.r .cell-code}\n## Can we do better?\n\nhealth_2010_2018 %>%\n  # remove NA data across the data set\n  drop_na() %>%\n  # take the top 20 countries based on 2018 allocation\n  slice_max(n = 20, order_by = Year2018) %>%\n  ggplot() +\n  # plot segments first\n  geom_segment(\n    aes(\n      y = reorder(Entity, Year2018), yend = reorder(Entity, Year2018),\n      x = Year2010, xend = Year2018\n    ),\n    colour = \"grey\",\n    linewidth = 2\n  ) +\n\n  # Then plot points\n  geom_point(aes(\n    y = reorder(Entity, Year2018), x = Year2018,\n    colour = \"2018\"\n  ), size = 3) +\n  geom_point(aes(\n    y = reorder(Entity, Year2018), x = Year2010,\n    colour = \"2010\"\n  ), size = 3) +\n  labs(\n    x = \"Health Expenditure as Percentage of GDP\",\n    y = \"Country\", title = \"Healthcare Budgets\",\n    subtitle = \"Changes between 2010 to 2018\"\n  ) +\n  scale_x_continuous(\n    breaks = scales::breaks_width(2),\n    labels = scales::label_percent(suffix = \"%\", scale = 1)\n  ) +\n  scale_colour_manual(name = \"Year\", values = c(\"red\", \"green\"))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-2.png){width=2100}\n:::\n:::\n\n\n:::\n\n:::\n\n## {{< iconify mingcute thought-line >}} Wait, But Why?\n\n- Changes can be over `time`, or over \"space\"\n- In the latter case, we can think of some Quantity changing over (multiple levels of) multiple Qualitative variables. E.g. `Sales` over `Product Type` over `Showroom Location` over `Festival Season`...\n- When a *single Quant* varies over *a single multi-level Qual*, the Chord Diagram may be simpler than the Sankey/Alluvial. E.g `Bird` migration across `Multiple Locations`. This can even show bidirectional changes. ( Sankeys with loops are also possible, however)\n- When you have a Quant that changes over only *one two-level Qual variable*, the Dumbbell plot becomes an option.\n\n\n## {{< iconify fluent-mdl2 decision-solid >}} Conclusion\n\nWe see that we can visualize \"evolutions\" over time and space. The\nevolutions can represent changes in the **quantities** of things, or\ntheir **categorical** affiliations or groups.\n\nWhat business/design data would you depict in this way? Revenue streams? Employment? Expenditures over time and market? Migration? App usage patterns? There are many possibilities!\n\nNote also that the [Bump Charts](/content/courses/Analytics/Descriptive/Modules/80-Ranking/index.qmd#bump-charts) are a special case of Alluvial/Sankey charts where each node connects/flows to **only** one other node.\n\n:::{.hidden}\n```{.d2}\nlogs: {\n  shape: page\n  style.multiple: true\n}\nuser: User {shape: person}\nnetwork: Network {\n  tower: Cell Tower {\n    satellites: {\n      shape: stored_data\n      style.multiple: true\n    }\n\n    satellites -> transmitter\n    satellites -> transmitter\n    satellites -> transmitter\n    transmitter\n  }\n  processor: Data Processor {\n    storage: Storage {\n      shape: cylinder\n      style.multiple: true\n    }\n  }\n  portal: Online Portal {\n    UI\n  }\n\n  tower.transmitter -> processor: phone logs\n}\nserver: API Server\n\nuser -> network.tower: Make call\nnetwork.processor -> server\nnetwork.processor -> server\nnetwork.processor -> server\n\nserver -> logs\nserver -> logs\nserver -> logs: persist\n\nserver -> network.portal.UI: display\nuser -> network.portal.UI: access {\n  style.stroke-dash: 3\n}\n\n```\n:::\n\n\n## {{< iconify openmoji person >}} Your Turn\n\n1.  Within the `ggalluvial` package are two datasets, `majors` and\n    `vaccinations`. Plot alluvial charts for both of these.\n2.  Go to the [American Life Panel\n    Website](https://alpdata.rand.org/index.php?page=data) where you\n    will find many public datasets. Try to take one and make charts from\n    it that we have learned in this Module.\n\n## {{< iconify ooui references-ltr >}} References\n\n1. Global Migration, <https://download.gsb.bund.de/BIB/global_flow/> A good\nexample of the use of a Chord Diagram.\\\n1. `ggalluvial`\ncheatsheet,<https://cheatography.com/seleven/cheat-sheets/ggalluvial/>\\\n1. John Coene, Sankey plots with `echarts4r`,\n<https://echarts4r.john-coene.com/articles/chart_types.html#sankey>\\\n1. Other packages: [Sankey plot \\| the R Graph Gallery\n(r-graph-gallery.com)](https://r-graph-gallery.com/sankey-diagram.html)\\\n1. Another package: [Sankey diagrams in ggplot2 with ggsankey \\| RCHARTS\n(r-charts.com)](https://r-charts.com/flow/sankey-diagram-ggplot2/)\\\n1. Sankey Charts using `networkD3`:\n<http://christophergandrud.github.io/networkD3>\\\n\n::: {#refs style=\"font-size: 60%;\"}\n###### {{< iconify lucide package-check >}} R Package Citations\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\nPackage        Version     Citation                         \n-------------  ----------  ---------------------------------\necharts4r      0.4.5       @echarts4r                       \nggalluvial     0.12.5      @ggalluvial2020; @ggalluvial2023 \nggsankey       0.0.99999   @ggsankey                        \nggsankeyfier   0.1.8       @ggsankeyfier                    \nggstream       0.1.0       @ggstream                        \nnetworkD3      0.4.1       @networkD3                       \nscales         1.4.0       @scales                          \n\n\n:::\n:::\n\n:::\n\n[^1]: D3 JavaScript Network Graphs from R:\n    [christophergandrud.github.io/networkD3/](http://christophergandrud.github.io/networkD3/)\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../../../../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../../../../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../../../../../../site_libs/echarts4r-4.8.0/echarts-en.min.js\"></script>\n<script src=\"../../../../../../site_libs/echarts4r-4.8.0/ecStat.min.js\"></script>\n<script src=\"../../../../../../site_libs/echarts4r-4.8.0/dataTool.min.js\"></script>\n<script src=\"../../../../../../site_libs/echarts4r-binding-0.4.5/echarts4r.js\"></script>\n<link href=\"../../../../../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../../../../../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}