{
  "hash": "9f33966e73e0e8326cf432cc74474e46",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Maps\"\n---\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(sf)\nlibrary(tmap)\nlibrary(osmdata)\nlibrary(ggformula)\n```\n:::\n\n\n## Defining a bounding box\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbbox_2 <- osmdata::getbb(\"Jayanagar, Bangalore, India\")\nbbox_2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       min      max\nx 77.56242 77.60242\ny 12.90927 12.94927\n```\n\n\n:::\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlocations <-\n  osmdata::opq(bbox = bbox_2) %>%\n  osmdata::add_osm_feature(\n    key = \"amenity\",\n    value = c(\"restaurant\", \"atm\", \"college\")\n  ) %>%\n  osmdata_sf() %>% # Convert to Simple Features format\n  purrr::pluck(\"osm_points\") # Pull out the data frame of interest\n###\ndat_buildings <-\n  osmdata::opq(bbox = bbox_2) %>%\n  osmdata::add_osm_feature(key = \"building\") %>%\n  osmdata_sf() %>%\n  purrr::pluck(\"osm_polygons\")\n```\n:::\n\n\n\n## Inspecting OSM data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstr(locations)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nClasses 'sf' and 'data.frame':\t580 obs. of  113 variables:\n $ osm_id                        : chr  \"302493798\" \"308729154\" \"362446925\" \"362446927\" ...\n $ name                          : chr  \"Citibank\" \"Citibank ATM Jayanagar 7th Block\" NA NA ...\n $ access                        : chr  NA NA NA NA ...\n $ addr:city                     : chr  NA NA NA NA ...\n $ addr:country                  : chr  NA NA NA NA ...\n $ addr:district                 : chr  NA NA NA NA ...\n $ addr:floor                    : chr  NA NA NA NA ...\n $ addr:full                     : chr  NA NA NA NA ...\n $ addr:hamlet                   : chr  NA NA NA NA ...\n $ addr:housename                : chr  NA NA NA NA ...\n $ addr:housenumber              : chr  NA NA NA NA ...\n $ addr:postcode                 : chr  NA NA NA NA ...\n $ addr:street                   : chr  NA \"Kanakapura Road\" NA NA ...\n $ addr:suburb                   : chr  NA NA NA NA ...\n $ air_conditioning              : chr  NA NA NA NA ...\n $ alt_name                      : chr  NA NA NA NA ...\n $ amenity                       : chr  \"atm\" \"atm\" NA NA ...\n $ bar                           : chr  NA NA NA NA ...\n $ barrier                       : chr  NA NA NA NA ...\n $ branch                        : chr  NA NA NA NA ...\n $ brand                         : chr  \"Citibank\" \"Citibank\" NA NA ...\n $ brand:en                      : chr  NA NA NA NA ...\n $ brand:hi                      : chr  NA NA NA NA ...\n $ brand:kn                      : chr  NA NA NA NA ...\n $ brand:pa                      : chr  NA NA NA NA ...\n $ brand:pnb                     : chr  NA NA NA NA ...\n $ brand:ur                      : chr  NA NA NA NA ...\n $ brand:wikidata                : chr  \"Q857063\" \"Q857063\" NA NA ...\n $ brand:wikipedia               : chr  NA NA NA NA ...\n $ brand:wikipedia:pa            : chr  NA NA NA NA ...\n $ brewery                       : chr  NA NA NA NA ...\n $ building                      : chr  NA NA NA NA ...\n $ capacity                      : chr  NA NA NA NA ...\n $ cash_in                       : chr  NA NA NA NA ...\n $ changing_table                : chr  NA NA NA NA ...\n $ check_date                    : chr  NA NA NA NA ...\n $ contact:facebook              : chr  NA NA NA NA ...\n $ contact:instagram             : chr  NA NA NA NA ...\n $ covered                       : chr  NA NA NA NA ...\n $ cuisine                       : chr  NA NA NA NA ...\n $ currency:INR                  : chr  NA NA NA NA ...\n $ delivery                      : chr  NA NA NA NA ...\n $ description                   : chr  NA NA NA NA ...\n $ diet:gluten_free              : chr  NA NA NA NA ...\n $ diet:halal                    : chr  NA NA NA NA ...\n $ diet:jain                     : chr  NA NA NA NA ...\n $ diet:non-vegetarian           : chr  NA NA NA NA ...\n $ diet:vegan                    : chr  NA NA NA NA ...\n $ diet:vegetarian               : chr  NA NA NA NA ...\n $ dog                           : chr  NA NA NA NA ...\n $ door                          : chr  NA NA NA NA ...\n $ drive_through                 : chr  NA NA NA NA ...\n $ email                         : chr  NA NA NA NA ...\n $ fee                           : chr  NA NA NA NA ...\n $ highchair                     : chr  NA NA NA NA ...\n $ image:menu                    : chr  NA NA NA NA ...\n $ image:menu:0                  : chr  NA NA NA NA ...\n $ indoor                        : chr  NA NA NA NA ...\n $ indoor_seating                : chr  NA NA NA NA ...\n $ internet_access               : chr  NA NA NA NA ...\n $ internet_access:fee           : chr  NA NA NA NA ...\n $ internet_access:ssid          : chr  NA NA NA NA ...\n $ level                         : chr  NA NA NA NA ...\n $ microbrewery                  : chr  NA NA NA NA ...\n $ mobile                        : chr  NA NA NA NA ...\n $ name:en                       : chr  NA NA NA NA ...\n $ name:hi                       : chr  NA NA NA NA ...\n $ name:kn                       : chr  \"ಸಿಟಿಬ್ಯಾಂಕ್\" NA NA NA ...\n $ name:pa                       : chr  NA NA NA NA ...\n $ name:pnb                      : chr  NA NA NA NA ...\n $ name:ur                       : chr  NA NA NA NA ...\n $ note                          : chr  NA NA NA NA ...\n $ official_name                 : chr  NA NA NA NA ...\n $ opening_hours                 : chr  NA NA NA NA ...\n $ operator                      : chr  \"Citibank\" \"Citibank\" NA NA ...\n $ operator:wikidata             : chr  \"Q857063\" \"Q857063\" NA NA ...\n $ organic                       : chr  NA NA NA NA ...\n $ outdoor_seating               : chr  NA NA NA NA ...\n $ payment:american_express      : chr  NA NA NA NA ...\n $ payment:app                   : chr  NA NA NA NA ...\n $ payment:cards                 : chr  NA NA NA NA ...\n $ payment:cash                  : chr  NA NA NA NA ...\n $ payment:contactless           : chr  NA NA NA NA ...\n $ payment:credit_cards          : chr  NA NA NA NA ...\n $ payment:debit_cards           : chr  NA NA NA NA ...\n $ payment:diners_club           : chr  NA NA NA NA ...\n $ payment:discover_card         : chr  NA NA NA NA ...\n $ payment:google_pay            : chr  NA NA NA NA ...\n $ payment:maestro               : chr  NA NA NA NA ...\n $ payment:mastercard            : chr  NA NA NA NA ...\n $ payment:mastercard_contactless: chr  NA NA NA NA ...\n $ payment:visa                  : chr  NA NA NA NA ...\n $ payment:visa_debit            : chr  NA NA NA NA ...\n $ phone                         : chr  NA NA NA NA ...\n $ ref:vatin                     : chr  NA NA NA NA ...\n $ reservation                   : chr  NA NA NA NA ...\n $ service:electricity           : chr  NA NA NA NA ...\n $ shop                          : chr  NA NA NA NA ...\n $ short_name                    : chr  \"Citi\" \"Citi\" NA NA ...\n  [list output truncated]\n - attr(*, \"sf_column\")= chr \"geometry\"\n - attr(*, \"agr\")= Factor w/ 3 levels \"constant\",\"aggregate\",..: NA NA NA NA NA NA NA NA NA NA ...\n  ..- attr(*, \"names\")= chr [1:112] \"osm_id\" \"name\" \"access\" \"addr:city\" ...\n```\n\n\n:::\n\n```{.r .cell-code}\nstr(dat_buildings)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nClasses 'sf' and 'data.frame':\t35808 obs. of  137 variables:\n $ osm_id                     : chr  \"27554059\" \"32425083\" \"43196401\" \"43196402\" ...\n $ name                       : chr  \"Jayanagar 4th Block Shopping Complex\" \"Paakashala\" NA NA ...\n $ access                     : chr  NA NA NA NA ...\n $ addr:block                 : chr  NA NA NA NA ...\n $ addr:city                  : chr  NA \"Bengaluru\" NA NA ...\n $ addr:district              : chr  NA \"Bengaluru Urban\" NA NA ...\n $ addr:full                  : chr  NA NA NA NA ...\n $ addr:housename             : chr  NA NA NA NA ...\n $ addr:housenumber           : chr  NA \"502/37\" NA NA ...\n $ addr:parentstreet          : chr  NA NA NA NA ...\n $ addr:place                 : chr  NA NA NA NA ...\n $ addr:postcode              : chr  NA \"560070\" NA NA ...\n $ addr:state                 : chr  NA NA NA NA ...\n $ addr:street                : chr  NA \"40th cross, 1st Main Rd, 8th Block, Jayanagar\" NA NA ...\n $ addr:suburb                : chr  NA NA NA NA ...\n $ air_conditioning           : chr  NA NA NA NA ...\n $ alt_name                   : chr  NA NA NA NA ...\n $ amenity                    : chr  NA \"restaurant\" NA NA ...\n $ amenity_1                  : chr  NA NA NA NA ...\n $ atm                        : chr  NA NA NA NA ...\n $ bench                      : chr  NA NA NA NA ...\n $ brand                      : chr  NA NA NA NA ...\n $ brand:en                   : chr  NA NA NA NA ...\n $ brand:hi                   : chr  NA NA NA NA ...\n $ brand:kn                   : chr  NA NA NA NA ...\n $ brand:pa                   : chr  NA NA NA NA ...\n $ brand:pnb                  : chr  NA NA NA NA ...\n $ brand:ur                   : chr  NA NA NA NA ...\n $ brand:wikidata             : chr  NA NA NA NA ...\n $ brand:wikipedia            : chr  NA NA NA NA ...\n $ brand:wikipedia:pa         : chr  NA NA NA NA ...\n $ building                   : chr  \"yes\" \"commercial\" NA NA ...\n $ building:colour            : chr  NA NA NA NA ...\n $ building:flats             : chr  NA NA NA NA ...\n $ building:levels            : chr  NA NA NA NA ...\n $ building:levels:underground: chr  NA NA NA NA ...\n $ building:material          : chr  NA NA NA NA ...\n $ building:prefabricated     : chr  NA NA NA NA ...\n $ building:use               : chr  NA NA NA NA ...\n $ bus                        : chr  NA NA NA NA ...\n $ capacity                   : chr  NA NA NA NA ...\n $ check_date                 : chr  NA NA NA NA ...\n $ club                       : chr  NA NA NA NA ...\n $ community_centre           : chr  NA NA NA NA ...\n $ construction               : chr  NA NA NA NA ...\n $ contact:email              : chr  NA NA NA NA ...\n $ contact:mobile             : chr  NA NA NA NA ...\n $ content                    : chr  NA NA NA NA ...\n $ cuisine                    : chr  NA NA NA NA ...\n $ currency:others            : chr  NA NA NA NA ...\n $ delivery                   : chr  NA NA NA NA ...\n $ denomination               : chr  NA NA NA NA ...\n $ description                : chr  NA NA NA NA ...\n $ designation                : chr  NA NA NA NA ...\n $ diet:lacto_vegetarian      : chr  NA NA NA NA ...\n $ diet:vegan                 : chr  NA NA NA NA ...\n $ drive_through              : chr  NA NA NA NA ...\n $ ele                        : chr  NA NA NA NA ...\n $ email                      : chr  NA NA NA NA ...\n $ emergency                  : chr  NA NA NA NA ...\n $ fee                        : chr  NA NA NA NA ...\n $ female                     : chr  NA NA NA NA ...\n $ fixme                      : chr  NA NA NA NA ...\n $ government                 : chr  NA NA NA NA ...\n $ healthcare                 : chr  NA NA NA NA ...\n $ healthcare:speciality      : chr  NA NA NA NA ...\n $ height                     : chr  NA NA NA NA ...\n $ heritage                   : chr  NA NA NA NA ...\n $ heritage:operator          : chr  NA NA NA NA ...\n $ heritage:website           : chr  NA NA NA NA ...\n $ house                      : chr  NA NA NA NA ...\n $ internet_access            : chr  NA NA NA NA ...\n $ isced:level                : chr  NA NA NA NA ...\n $ landuse                    : chr  NA NA NA NA ...\n $ layer                      : chr  NA NA NA NA ...\n $ leisure                    : chr  NA NA NA NA ...\n $ level                      : chr  NA NA NA NA ...\n $ lit                        : chr  NA NA NA NA ...\n $ loc_name                   : chr  NA NA NA NA ...\n $ male                       : chr  NA NA NA NA ...\n $ man_made                   : chr  NA NA NA NA ...\n $ max_age                    : chr  NA NA NA NA ...\n $ max_level                  : chr  NA NA NA NA ...\n $ min_age                    : chr  NA NA NA NA ...\n $ min_level                  : chr  NA NA NA NA ...\n $ name:en                    : chr  NA NA NA NA ...\n $ name:etymology:wikidata    : chr  NA NA NA NA ...\n $ name:hi                    : chr  NA NA NA NA ...\n $ name:kn                    : chr  NA NA NA NA ...\n $ name:ml                    : chr  NA NA NA NA ...\n $ name:pa                    : chr  NA NA NA NA ...\n $ name:pnb                   : chr  NA NA NA NA ...\n $ name:ta                    : chr  NA NA NA NA ...\n $ name:ur                    : chr  NA NA NA NA ...\n $ note                       : chr  NA NA NA NA ...\n $ office                     : chr  NA NA NA NA ...\n $ official_name              : chr  NA NA NA NA ...\n $ old_name                   : chr  NA NA NA NA ...\n $ opening_hours              : chr  NA NA NA NA ...\n  [list output truncated]\n - attr(*, \"sf_column\")= chr \"geometry\"\n - attr(*, \"agr\")= Factor w/ 3 levels \"constant\",\"aggregate\",..: NA NA NA NA NA NA NA NA NA NA ...\n  ..- attr(*, \"names\")= chr [1:136] \"osm_id\" \"name\" \"access\" \"addr:block\" ...\n```\n\n\n:::\n:::\n\n\n## Plotting Base Maps with ggplot/ggformula\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() +\n  geom_sf(data = locations, fill = \"gold\", color = \"grey\", linewidth = 0.025) +\n  geom_sf(data = dat_buildings, fill = \"purple\") +\n  coord_sf()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=2100}\n:::\n\n```{.r .cell-code}\ngf_sf(geometry = ~geometry, data = locations) %>%\n  gf_sf(geometry = ~geometry, dat = dat_buildings)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-2.png){width=2100}\n:::\n:::\n\n\n## Plotting with tmap\n\n::: {.cell}\n\n```{.r .cell-code}\ntm_shape(locations) +\n  tm_dots(size = 0.5) +\n  tm_shape(dat_buildings) +\n  tm_polygons() +\n  tm_compass(position = c(\"right\", \"top\"))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=2100}\n:::\n:::\n\n\n\n\n## Adding User Data to a Base Map\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}